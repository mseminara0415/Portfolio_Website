

============================== 2022-07-10 02:39:43.868117 | 32474b68-4596-472e-8862-c593fbc4a14e ==============================
02:39:43.868117 [info ] [MainThread]: Running with dbt=1.1.1
02:39:43.868117 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:39:43.868117 [debug] [MainThread]: Tracking: tracking
02:39:43.876118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908DE7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908DE6FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908DE7520>]}
02:39:43.886119 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:39:43.887118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32474b68-4596-472e-8862-c593fbc4a14e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908DF43D0>]}
02:39:43.910117 [debug] [MainThread]: Parsing macros\altitude_to_orbital_velocity_mph.sql
02:39:43.911118 [debug] [MainThread]: Parsing macros\generate_schema_name.sql
02:39:43.911118 [debug] [MainThread]: Parsing macros\adapters.sql
02:39:43.925117 [debug] [MainThread]: Parsing macros\catalog.sql
02:39:43.927118 [debug] [MainThread]: Parsing macros\relations.sql
02:39:43.927118 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
02:39:43.929118 [debug] [MainThread]: Parsing macros\adapters\columns.sql
02:39:43.935117 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
02:39:43.937117 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
02:39:43.939117 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
02:39:43.944117 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
02:39:43.947118 [debug] [MainThread]: Parsing macros\adapters\relation.sql
02:39:43.952117 [debug] [MainThread]: Parsing macros\adapters\schema.sql
02:39:43.954118 [debug] [MainThread]: Parsing macros\etc\datetime.sql
02:39:43.959118 [debug] [MainThread]: Parsing macros\etc\statement.sql
02:39:43.962117 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
02:39:43.963118 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
02:39:43.963118 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
02:39:43.964118 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
02:39:43.965118 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
02:39:43.966118 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
02:39:43.967118 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
02:39:43.968118 [debug] [MainThread]: Parsing macros\materializations\configs.sql
02:39:43.970118 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
02:39:43.973117 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
02:39:43.975117 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
02:39:43.981117 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
02:39:43.982118 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
02:39:43.992117 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
02:39:44.001117 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
02:39:44.002118 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
02:39:44.007117 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
02:39:44.009118 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
02:39:44.011117 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
02:39:44.012117 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
02:39:44.016117 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
02:39:44.025117 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
02:39:44.029117 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
02:39:44.036117 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
02:39:44.042117 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
02:39:44.043118 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
02:39:44.053117 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
02:39:44.054117 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
02:39:44.056117 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
02:39:44.058118 [debug] [MainThread]: Parsing tests\generic\builtin.sql
02:39:44.161119 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
02:39:44.168129 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_satellite_detail_dm.sql
02:39:44.170118 [debug] [MainThread]: 1603: static parser failed on staging\stg_satellite_position_ft.sql
02:39:44.174118 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_satellite_position_ft.sql
02:39:44.174118 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_satellite_tle_ft.sql
02:39:44.218118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908F29360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908F280D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022908F292D0>]}


============================== 2022-07-10 02:40:43.801744 | a281f145-50ac-4031-a336-810028e07945 ==============================
02:40:43.801744 [info ] [MainThread]: Running with dbt=1.1.1
02:40:43.802745 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:40:43.802745 [debug] [MainThread]: Tracking: tracking
02:40:43.809744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A097610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A096FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A097220>]}
02:40:43.819745 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
02:40:43.820745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A0A43A0>]}
02:40:43.843745 [debug] [MainThread]: Parsing macros\altitude_to_orbital_velocity_mph.sql
02:40:43.844746 [debug] [MainThread]: Parsing macros\generate_schema_name.sql
02:40:43.844746 [debug] [MainThread]: Parsing macros\adapters.sql
02:40:43.860744 [debug] [MainThread]: Parsing macros\catalog.sql
02:40:43.861746 [debug] [MainThread]: Parsing macros\relations.sql
02:40:43.862745 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
02:40:43.864745 [debug] [MainThread]: Parsing macros\adapters\columns.sql
02:40:43.871744 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
02:40:43.873744 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
02:40:43.875744 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
02:40:43.879744 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
02:40:43.882744 [debug] [MainThread]: Parsing macros\adapters\relation.sql
02:40:43.887744 [debug] [MainThread]: Parsing macros\adapters\schema.sql
02:40:43.888745 [debug] [MainThread]: Parsing macros\etc\datetime.sql
02:40:43.894745 [debug] [MainThread]: Parsing macros\etc\statement.sql
02:40:43.897745 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
02:40:43.898745 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
02:40:43.899746 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
02:40:43.899746 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
02:40:43.900745 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
02:40:43.901746 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
02:40:43.902745 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
02:40:43.904745 [debug] [MainThread]: Parsing macros\materializations\configs.sql
02:40:43.905745 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
02:40:43.908745 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
02:40:43.911745 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
02:40:43.917744 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
02:40:43.918745 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
02:40:43.927744 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
02:40:43.935744 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
02:40:43.937745 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
02:40:43.941744 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
02:40:43.943745 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
02:40:43.945744 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
02:40:43.946746 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
02:40:43.951744 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
02:40:43.961744 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
02:40:43.964744 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
02:40:43.972744 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
02:40:43.978745 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
02:40:43.979745 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
02:40:43.990744 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
02:40:43.991745 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
02:40:43.994744 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
02:40:43.995745 [debug] [MainThread]: Parsing tests\generic\builtin.sql
02:40:44.096745 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
02:40:44.103744 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_satellite_detail_dm.sql
02:40:44.104746 [debug] [MainThread]: 1603: static parser failed on staging\stg_satellite_position_ft.sql
02:40:44.107744 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_satellite_position_ft.sql
02:40:44.108744 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_satellite_tle_ft.sql
02:40:44.160747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A1D1870>]}
02:40:44.164746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A096E60>]}
02:40:44.164746 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
02:40:44.164746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A1EF2E0>]}
02:40:44.165745 [info ] [MainThread]: 
02:40:44.166745 [debug] [MainThread]: Acquiring new postgres connection "master"
02:40:44.167745 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
02:40:44.167745 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
02:40:44.173745 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
02:40:44.174746 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
02:40:44.175745 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
02:40:44.175745 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
02:40:44.175745 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:40:44.175745 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:40:44.787739 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
02:40:44.788742 [debug] [ThreadPool]: On list_portfolio_website: Close
02:40:44.842379 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.67 seconds
02:40:44.842379 [debug] [ThreadPool]: On list_portfolio_website: Close
02:40:44.843403 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
02:40:44.844402 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
02:40:44.848403 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
02:40:44.849390 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
02:40:44.849390 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
02:40:44.849390 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
02:40:44.849390 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:40:44.850390 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:40:45.428761 [debug] [ThreadPool]: SQL status: BEGIN in 0.58 seconds
02:40:45.428761 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
02:40:45.428761 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
02:40:45.433503 [debug] [ThreadPool]: SQL status: BEGIN in 0.58 seconds
02:40:45.433503 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
02:40:45.433503 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
02:40:45.503416 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
02:40:45.504416 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
02:40:45.508416 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.07 seconds
02:40:45.509415 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
02:40:45.574059 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
02:40:45.580637 [debug] [ThreadPool]: On list_portfolio_website_production: Close
02:40:45.582648 [debug] [MainThread]: Using postgres connection "master"
02:40:45.583648 [debug] [MainThread]: On master: BEGIN
02:40:45.583648 [debug] [MainThread]: Opening a new connection, currently in state init
02:40:46.198317 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
02:40:46.198317 [debug] [MainThread]: Using postgres connection "master"
02:40:46.199517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:40:46.279973 [debug] [MainThread]: SQL status: SELECT 3 in 0.08 seconds
02:40:46.281157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A1D02B0>]}
02:40:46.281157 [debug] [MainThread]: On master: ROLLBACK
02:40:46.356551 [debug] [MainThread]: Using postgres connection "master"
02:40:46.357551 [debug] [MainThread]: On master: BEGIN
02:40:46.501752 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
02:40:46.501752 [debug] [MainThread]: On master: COMMIT
02:40:46.501752 [debug] [MainThread]: Using postgres connection "master"
02:40:46.501752 [debug] [MainThread]: On master: COMMIT
02:40:46.575449 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
02:40:46.575449 [debug] [MainThread]: On master: Close
02:40:46.575449 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
02:40:46.576448 [info ] [MainThread]: 
02:40:46.582446 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
02:40:46.582446 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
02:40:46.583446 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
02:40:46.583446 [info ] [Thread-1 (]: 1 of 4 START view model staging.stg_satellite_detail_dm ........................ [RUN]
02:40:46.584445 [info ] [Thread-2 (]: 2 of 4 START view model staging.stg_satellite_position_ft ...................... [RUN]
02:40:46.584445 [info ] [Thread-3 (]: 3 of 4 START view model staging.stg_satellite_tle_ft ........................... [RUN]
02:40:46.585448 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:40:46.585448 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:40:46.586446 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:40:46.586446 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
02:40:46.586446 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
02:40:46.587446 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
02:40:46.587446 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
02:40:46.587446 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
02:40:46.588446 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
02:40:46.590446 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
02:40:46.592447 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
02:40:46.594447 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
02:40:46.595446 [debug] [Thread-1 (]: finished collecting timing info
02:40:46.595446 [debug] [Thread-2 (]: finished collecting timing info
02:40:46.595446 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
02:40:46.595446 [debug] [Thread-3 (]: finished collecting timing info
02:40:46.596446 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
02:40:46.609446 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
02:40:46.610447 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
02:40:46.611447 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
02:40:46.613446 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
02:40:46.613446 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:40:46.613446 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
02:40:46.614448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
02:40:46.614448 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:40:46.614448 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:40:46.614448 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
02:40:46.615447 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
02:40:46.615447 [debug] [Thread-2 (]: Opening a new connection, currently in state init
02:40:46.615447 [debug] [Thread-3 (]: Opening a new connection, currently in state init
02:40:47.199053 [debug] [Thread-2 (]: SQL status: BEGIN in 0.58 seconds
02:40:47.200053 [debug] [Thread-1 (]: SQL status: BEGIN in 0.59 seconds
02:40:47.200053 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:40:47.200053 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:40:47.200053 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
02:40:47.201053 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
02:40:47.202042 [debug] [Thread-3 (]: SQL status: BEGIN in 0.59 seconds
02:40:47.202042 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:40:47.203041 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
02:40:47.288448 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.09 seconds
02:40:47.289448 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.09 seconds
02:40:47.289448 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.09 seconds
02:40:47.293450 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:40:47.294447 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:40:47.295447 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:40:47.296449 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
02:40:47.296449 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
02:40:47.296449 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
02:40:47.368307 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
02:40:47.368307 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
02:40:47.368307 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
02:40:47.369331 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:40:47.370331 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:40:47.371331 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:40:47.372331 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
02:40:47.372331 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
02:40:47.372331 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
02:40:47.443305 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
02:40:47.443305 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
02:40:47.448305 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
02:40:47.448305 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
02:40:47.449305 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
02:40:47.449305 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:40:47.450309 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
02:40:47.450309 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:40:47.450309 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
02:40:47.450309 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:40:47.451305 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
02:40:47.451305 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
02:40:47.520906 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
02:40:47.520906 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
02:40:47.524906 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:40:47.524906 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
02:40:47.525906 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:40:47.525906 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
02:40:47.526906 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:40:47.526906 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
02:40:47.527906 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
02:40:47.599902 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
02:40:47.599902 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
02:40:47.599902 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
02:40:47.600902 [debug] [Thread-2 (]: finished collecting timing info
02:40:47.601902 [debug] [Thread-1 (]: finished collecting timing info
02:40:47.602902 [debug] [Thread-3 (]: finished collecting timing info
02:40:47.602902 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
02:40:47.602902 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
02:40:47.603654 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
02:40:47.603654 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A166A40>]}
02:40:47.603654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A13FD90>]}
02:40:47.604666 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A3347F0>]}
02:40:47.604666 [info ] [Thread-2 (]: 2 of 4 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 1.02s]
02:40:47.604666 [info ] [Thread-1 (]: 1 of 4 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.02s]
02:40:47.604666 [info ] [Thread-3 (]: 3 of 4 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.02s]
02:40:47.605675 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
02:40:47.606667 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
02:40:47.606667 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
02:40:47.607665 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_tracking
02:40:47.607665 [info ] [Thread-5 (]: 4 of 4 START view model production.satellite_tracking .......................... [RUN]
02:40:47.607665 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
02:40:47.608666 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_tracking
02:40:47.608666 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_tracking
02:40:47.610666 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
02:40:47.612665 [debug] [Thread-5 (]: finished collecting timing info
02:40:47.612665 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_tracking
02:40:47.614668 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
02:40:47.614668 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:40:47.614668 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: BEGIN
02:40:47.615666 [debug] [Thread-5 (]: Opening a new connection, currently in state init
02:40:48.177265 [debug] [Thread-5 (]: SQL status: BEGIN in 0.56 seconds
02:40:48.178266 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:40:48.178266 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft"

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft"
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id, satellite_position.timestamp)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id, satellite_tle.timestamp)
        satellites_to_track.id,
        satellite_tle.timestamp
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
02:40:48.247266 [debug] [Thread-5 (]: Postgres adapter: Postgres error: syntax error at or near "."
LINE 40:         satellite_tle.timestamp AS tle_timestamp,
                              ^

02:40:48.248266 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: ROLLBACK
02:40:48.318241 [debug] [Thread-5 (]: finished collecting timing info
02:40:48.318241 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: Close
02:40:48.319254 [debug] [Thread-5 (]: Database Error in model satellite_tracking (models\production\satellite_tracking.sql)
  syntax error at or near "."
  LINE 40:         satellite_tle.timestamp AS tle_timestamp,
                                ^
  compiled SQL at target\run\satellite_tracker\models\production\satellite_tracking.sql
02:40:48.319254 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a281f145-50ac-4031-a336-810028e07945', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A2E3D30>]}
02:40:48.319254 [error] [Thread-5 (]: 4 of 4 ERROR creating view model production.satellite_tracking ................. [[31mERROR[0m in 0.71s]
02:40:48.320253 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_tracking
02:40:48.321254 [debug] [MainThread]: Acquiring new postgres connection "master"
02:40:48.321254 [debug] [MainThread]: Using postgres connection "master"
02:40:48.321254 [debug] [MainThread]: On master: BEGIN
02:40:48.321254 [debug] [MainThread]: Opening a new connection, currently in state closed
02:40:48.936095 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
02:40:48.936095 [debug] [MainThread]: On master: COMMIT
02:40:48.936095 [debug] [MainThread]: Using postgres connection "master"
02:40:48.936095 [debug] [MainThread]: On master: COMMIT
02:40:49.005622 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
02:40:49.005622 [debug] [MainThread]: On master: Close
02:40:49.005622 [info ] [MainThread]: 
02:40:49.006622 [info ] [MainThread]: Finished running 4 view models in 4.84s.
02:40:49.006622 [debug] [MainThread]: Connection 'master' was properly closed.
02:40:49.007622 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
02:40:49.007622 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
02:40:49.007622 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
02:40:49.007622 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
02:40:49.007622 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
02:40:49.008625 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
02:40:49.008625 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
02:40:49.008625 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
02:40:49.012622 [info ] [MainThread]: 
02:40:49.012622 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:40:49.013626 [info ] [MainThread]: 
02:40:49.013626 [error] [MainThread]: [33mDatabase Error in model satellite_tracking (models\production\satellite_tracking.sql)[0m
02:40:49.014622 [error] [MainThread]:   syntax error at or near "."
02:40:49.014622 [error] [MainThread]:   LINE 40:         satellite_tle.timestamp AS tle_timestamp,
02:40:49.015623 [error] [MainThread]:                                 ^
02:40:49.015623 [error] [MainThread]:   compiled SQL at target\run\satellite_tracker\models\production\satellite_tracking.sql
02:40:49.015623 [info ] [MainThread]: 
02:40:49.016625 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
02:40:49.016625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A1D0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A1D0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D2A1CAC20>]}


============================== 2022-07-10 02:41:16.222040 | d04f0c04-9b24-46fc-8daf-c9ff7a8787ca ==============================
02:41:16.222040 [info ] [MainThread]: Running with dbt=1.1.1
02:41:16.222040 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:41:16.222040 [debug] [MainThread]: Tracking: tracking
02:41:16.230039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDBB1840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDBA6FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDBA7520>]}
02:41:16.268038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:41:16.268038 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\satellite_tracking.sql
02:41:16.275038 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
02:41:16.288040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd04f0c04-9b24-46fc-8daf-c9ff7a8787ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDD11420>]}
02:41:16.293039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd04f0c04-9b24-46fc-8daf-c9ff7a8787ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDCCBA60>]}
02:41:16.294039 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
02:41:16.294039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04f0c04-9b24-46fc-8daf-c9ff7a8787ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDBB1840>]}
02:41:16.295040 [info ] [MainThread]: 
02:41:16.296038 [debug] [MainThread]: Acquiring new postgres connection "master"
02:41:16.297039 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
02:41:16.297039 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
02:41:16.303040 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
02:41:16.304039 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
02:41:16.304039 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
02:41:16.304039 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
02:41:16.305039 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:41:16.305039 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:41:16.951349 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.65 seconds
02:41:16.952352 [debug] [ThreadPool]: On list_portfolio_website: Close
02:41:17.023537 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.72 seconds
02:41:17.024538 [debug] [ThreadPool]: On list_portfolio_website: Close
02:41:17.025536 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
02:41:17.025536 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
02:41:17.029537 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
02:41:17.030536 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
02:41:17.030536 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
02:41:17.031536 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
02:41:17.031536 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:41:17.031536 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:41:17.611208 [debug] [ThreadPool]: SQL status: BEGIN in 0.58 seconds
02:41:17.611208 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
02:41:17.611208 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
02:41:17.620174 [debug] [ThreadPool]: SQL status: BEGIN in 0.59 seconds
02:41:17.620174 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
02:41:17.620174 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
02:41:17.683684 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.07 seconds
02:41:17.685683 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
02:41:17.693671 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
02:41:17.694671 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
02:41:17.755453 [debug] [ThreadPool]: On list_portfolio_website_production: Close
02:41:17.766047 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
02:41:17.769067 [debug] [MainThread]: Using postgres connection "master"
02:41:17.769067 [debug] [MainThread]: On master: BEGIN
02:41:17.769067 [debug] [MainThread]: Opening a new connection, currently in state init
02:41:18.377136 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
02:41:18.377136 [debug] [MainThread]: Using postgres connection "master"
02:41:18.377136 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:41:18.458136 [debug] [MainThread]: SQL status: SELECT 3 in 0.08 seconds
02:41:18.459135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04f0c04-9b24-46fc-8daf-c9ff7a8787ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDCA8940>]}
02:41:18.460138 [debug] [MainThread]: On master: ROLLBACK
02:41:18.533136 [debug] [MainThread]: Using postgres connection "master"
02:41:18.534136 [debug] [MainThread]: On master: BEGIN
02:41:18.679339 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
02:41:18.679339 [debug] [MainThread]: On master: COMMIT
02:41:18.679339 [debug] [MainThread]: Using postgres connection "master"
02:41:18.679339 [debug] [MainThread]: On master: COMMIT
02:41:18.753339 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
02:41:18.753339 [debug] [MainThread]: On master: Close
02:41:18.753339 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
02:41:18.754353 [info ] [MainThread]: 
02:41:18.758353 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
02:41:18.758353 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
02:41:18.759351 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
02:41:18.759351 [info ] [Thread-1 (]: 1 of 4 START view model staging.stg_satellite_detail_dm ........................ [RUN]
02:41:18.759351 [info ] [Thread-2 (]: 2 of 4 START view model staging.stg_satellite_position_ft ...................... [RUN]
02:41:18.759351 [info ] [Thread-3 (]: 3 of 4 START view model staging.stg_satellite_tle_ft ........................... [RUN]
02:41:18.760352 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:41:18.761351 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:41:18.761351 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:41:18.761351 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
02:41:18.761351 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
02:41:18.762351 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
02:41:18.762351 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
02:41:18.762351 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
02:41:18.762351 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
02:41:18.765352 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
02:41:18.768352 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
02:41:18.770352 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
02:41:18.770352 [debug] [Thread-1 (]: finished collecting timing info
02:41:18.771350 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
02:41:18.771350 [debug] [Thread-2 (]: finished collecting timing info
02:41:18.786350 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
02:41:18.786350 [debug] [Thread-3 (]: finished collecting timing info
02:41:18.786350 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
02:41:18.786350 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
02:41:18.788353 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
02:41:18.788353 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:41:18.789351 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
02:41:18.790352 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
02:41:18.790352 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:41:18.790352 [debug] [Thread-1 (]: Opening a new connection, currently in state init
02:41:18.790352 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:41:18.790352 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
02:41:18.791351 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
02:41:18.791351 [debug] [Thread-2 (]: Opening a new connection, currently in state init
02:41:18.791351 [debug] [Thread-3 (]: Opening a new connection, currently in state init
02:41:19.389210 [debug] [Thread-3 (]: SQL status: BEGIN in 0.6 seconds
02:41:19.389210 [debug] [Thread-1 (]: SQL status: BEGIN in 0.6 seconds
02:41:19.389210 [debug] [Thread-2 (]: SQL status: BEGIN in 0.6 seconds
02:41:19.390210 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:41:19.390210 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:41:19.390210 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:41:19.391210 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
02:41:19.391210 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
02:41:19.391210 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
02:41:19.466384 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.08 seconds
02:41:19.470383 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:41:19.470383 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.08 seconds
02:41:19.470383 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.08 seconds
02:41:19.471385 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
02:41:19.472386 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:41:19.473383 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:41:19.474386 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
02:41:19.474386 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
02:41:19.547888 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
02:41:19.547888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
02:41:19.547888 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
02:41:19.548899 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:41:19.549899 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:41:19.551899 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:41:19.551899 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
02:41:19.552901 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
02:41:19.552901 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
02:41:19.628057 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.08 seconds
02:41:19.628249 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.08 seconds
02:41:19.628249 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.08 seconds
02:41:19.632254 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
02:41:19.633255 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
02:41:19.634254 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
02:41:19.634254 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:41:19.634254 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:41:19.635255 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:41:19.635255 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
02:41:19.635255 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
02:41:19.635255 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
02:41:19.710223 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
02:41:19.710223 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
02:41:19.710223 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
02:41:19.714223 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:41:19.715223 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:41:19.716223 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:41:19.716223 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
02:41:19.717223 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
02:41:19.717223 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
02:41:19.791266 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
02:41:19.791266 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
02:41:19.791266 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
02:41:19.792290 [debug] [Thread-2 (]: finished collecting timing info
02:41:19.793279 [debug] [Thread-3 (]: finished collecting timing info
02:41:19.794278 [debug] [Thread-1 (]: finished collecting timing info
02:41:19.794278 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
02:41:19.794278 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
02:41:19.794278 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
02:41:19.795282 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f0c04-9b24-46fc-8daf-c9ff7a8787ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDD75E70>]}
02:41:19.795282 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f0c04-9b24-46fc-8daf-c9ff7a8787ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDD6F940>]}
02:41:19.796281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f0c04-9b24-46fc-8daf-c9ff7a8787ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDDCE980>]}
02:41:19.796664 [info ] [Thread-2 (]: 2 of 4 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 1.03s]
02:41:19.796664 [info ] [Thread-3 (]: 3 of 4 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.03s]
02:41:19.796664 [info ] [Thread-1 (]: 1 of 4 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.04s]
02:41:19.798674 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
02:41:19.798674 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
02:41:19.799675 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_tracking
02:41:19.799675 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
02:41:19.799675 [info ] [Thread-5 (]: 4 of 4 START view model production.satellite_tracking .......................... [RUN]
02:41:19.800674 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
02:41:19.800674 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_tracking
02:41:19.800674 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_tracking
02:41:19.802673 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
02:41:19.803673 [debug] [Thread-5 (]: finished collecting timing info
02:41:19.803673 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_tracking
02:41:19.804675 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
02:41:19.805674 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:41:19.805674 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: BEGIN
02:41:19.805674 [debug] [Thread-5 (]: Opening a new connection, currently in state init
02:41:20.367298 [debug] [Thread-5 (]: SQL status: BEGIN in 0.56 seconds
02:41:20.367298 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:41:20.367298 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft"

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft"
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id, satellite_position.timestamp)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id, satellite_tle.timestamp)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
02:41:20.439951 [debug] [Thread-5 (]: Postgres adapter: Postgres error: operator does not exist: integer = record
LINE 62:         ON satellites_to_track.id = newest_satellite_positio...
                                           ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

02:41:20.441974 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: ROLLBACK
02:41:20.512117 [debug] [Thread-5 (]: finished collecting timing info
02:41:20.512117 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: Close
02:41:20.513140 [debug] [Thread-5 (]: Database Error in model satellite_tracking (models\production\satellite_tracking.sql)
  operator does not exist: integer = record
  LINE 62:         ON satellites_to_track.id = newest_satellite_positio...
                                             ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target\run\satellite_tracker\models\production\satellite_tracking.sql
02:41:20.513140 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04f0c04-9b24-46fc-8daf-c9ff7a8787ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDE4C2B0>]}
02:41:20.513140 [error] [Thread-5 (]: 4 of 4 ERROR creating view model production.satellite_tracking ................. [[31mERROR[0m in 0.71s]
02:41:20.514140 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_tracking
02:41:20.515139 [debug] [MainThread]: Acquiring new postgres connection "master"
02:41:20.516128 [debug] [MainThread]: Using postgres connection "master"
02:41:20.516128 [debug] [MainThread]: On master: BEGIN
02:41:20.516128 [debug] [MainThread]: Opening a new connection, currently in state closed
02:41:21.118835 [debug] [MainThread]: SQL status: BEGIN in 0.6 seconds
02:41:21.119836 [debug] [MainThread]: On master: COMMIT
02:41:21.119836 [debug] [MainThread]: Using postgres connection "master"
02:41:21.119836 [debug] [MainThread]: On master: COMMIT
02:41:21.194195 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
02:41:21.195200 [debug] [MainThread]: On master: Close
02:41:21.195200 [info ] [MainThread]: 
02:41:21.196204 [info ] [MainThread]: Finished running 4 view models in 4.90s.
02:41:21.196204 [debug] [MainThread]: Connection 'master' was properly closed.
02:41:21.196204 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
02:41:21.196204 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
02:41:21.197228 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
02:41:21.197228 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
02:41:21.197228 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
02:41:21.197228 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
02:41:21.197228 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
02:41:21.198217 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
02:41:21.202216 [info ] [MainThread]: 
02:41:21.202216 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
02:41:21.203215 [info ] [MainThread]: 
02:41:21.203215 [error] [MainThread]: [33mDatabase Error in model satellite_tracking (models\production\satellite_tracking.sql)[0m
02:41:21.204215 [error] [MainThread]:   operator does not exist: integer = record
02:41:21.204215 [error] [MainThread]:   LINE 62:         ON satellites_to_track.id = newest_satellite_positio...
02:41:21.205217 [error] [MainThread]:                                              ^
02:41:21.205217 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
02:41:21.206216 [error] [MainThread]:   compiled SQL at target\run\satellite_tracker\models\production\satellite_tracking.sql
02:41:21.206216 [info ] [MainThread]: 
02:41:21.206216 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
02:41:21.207215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDE4C460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDE4C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286DDE53880>]}


============================== 2022-07-10 02:43:00.818095 | b296115c-6244-4c42-ba38-2d288c81d6b5 ==============================
02:43:00.818095 [info ] [MainThread]: Running with dbt=1.1.1
02:43:00.818095 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:43:00.819094 [debug] [MainThread]: Tracking: tracking
02:43:00.826096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB417610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB416FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB417220>]}
02:43:00.863095 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
02:43:00.863095 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\satellite_tracking.sql
02:43:00.870095 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
02:43:00.884095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b296115c-6244-4c42-ba38-2d288c81d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB581480>]}
02:43:00.888095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b296115c-6244-4c42-ba38-2d288c81d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB53D840>]}
02:43:00.889096 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
02:43:00.889096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b296115c-6244-4c42-ba38-2d288c81d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB53F6A0>]}
02:43:00.890096 [info ] [MainThread]: 
02:43:00.891094 [debug] [MainThread]: Acquiring new postgres connection "master"
02:43:00.892095 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
02:43:00.892095 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
02:43:00.898095 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
02:43:00.899095 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
02:43:00.899095 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
02:43:00.899095 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
02:43:00.900095 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:43:00.900095 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:43:01.488164 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.59 seconds
02:43:01.489164 [debug] [ThreadPool]: On list_portfolio_website: Close
02:43:01.508388 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
02:43:01.508388 [debug] [ThreadPool]: On list_portfolio_website: Close
02:43:01.510400 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
02:43:01.510400 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
02:43:01.513411 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
02:43:01.515411 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
02:43:01.515411 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
02:43:01.515411 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
02:43:01.515411 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:43:01.515411 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:43:02.077237 [debug] [ThreadPool]: SQL status: BEGIN in 0.56 seconds
02:43:02.078238 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
02:43:02.078238 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
02:43:02.082750 [debug] [ThreadPool]: SQL status: BEGIN in 0.57 seconds
02:43:02.082750 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
02:43:02.082750 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
02:43:02.149790 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
02:43:02.150799 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
02:43:02.153799 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.07 seconds
02:43:02.154799 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
02:43:02.219113 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
02:43:02.224419 [debug] [ThreadPool]: On list_portfolio_website_production: Close
02:43:02.226420 [debug] [MainThread]: Using postgres connection "master"
02:43:02.227419 [debug] [MainThread]: On master: BEGIN
02:43:02.227419 [debug] [MainThread]: Opening a new connection, currently in state init
02:43:02.805965 [debug] [MainThread]: SQL status: BEGIN in 0.58 seconds
02:43:02.805965 [debug] [MainThread]: Using postgres connection "master"
02:43:02.805965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:43:02.886809 [debug] [MainThread]: SQL status: SELECT 3 in 0.08 seconds
02:43:02.887822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b296115c-6244-4c42-ba38-2d288c81d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB53E020>]}
02:43:02.887822 [debug] [MainThread]: On master: ROLLBACK
02:43:02.959506 [debug] [MainThread]: Using postgres connection "master"
02:43:02.959506 [debug] [MainThread]: On master: BEGIN
02:43:03.104090 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
02:43:03.104090 [debug] [MainThread]: On master: COMMIT
02:43:03.104090 [debug] [MainThread]: Using postgres connection "master"
02:43:03.104090 [debug] [MainThread]: On master: COMMIT
02:43:03.176049 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
02:43:03.176049 [debug] [MainThread]: On master: Close
02:43:03.176049 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
02:43:03.177060 [info ] [MainThread]: 
02:43:03.181060 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
02:43:03.181060 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
02:43:03.181060 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
02:43:03.182059 [info ] [Thread-1 (]: 1 of 4 START view model staging.stg_satellite_detail_dm ........................ [RUN]
02:43:03.182059 [info ] [Thread-2 (]: 2 of 4 START view model staging.stg_satellite_position_ft ...................... [RUN]
02:43:03.182059 [info ] [Thread-3 (]: 3 of 4 START view model staging.stg_satellite_tle_ft ........................... [RUN]
02:43:03.183059 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:43:03.183059 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:43:03.184062 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:43:03.184062 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
02:43:03.184062 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
02:43:03.184062 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
02:43:03.185061 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
02:43:03.185061 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
02:43:03.185061 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
02:43:03.187061 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
02:43:03.190059 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
02:43:03.191059 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
02:43:03.192060 [debug] [Thread-1 (]: finished collecting timing info
02:43:03.192060 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
02:43:03.192060 [debug] [Thread-2 (]: finished collecting timing info
02:43:03.207060 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
02:43:03.207060 [debug] [Thread-3 (]: finished collecting timing info
02:43:03.207060 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
02:43:03.208060 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
02:43:03.210061 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
02:43:03.210061 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:43:03.212063 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
02:43:03.212063 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
02:43:03.212063 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:43:03.213060 [debug] [Thread-1 (]: Opening a new connection, currently in state init
02:43:03.213060 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
02:43:03.213060 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:43:03.213060 [debug] [Thread-2 (]: Opening a new connection, currently in state init
02:43:03.213060 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
02:43:03.214060 [debug] [Thread-3 (]: Opening a new connection, currently in state init
02:43:03.780107 [debug] [Thread-3 (]: SQL status: BEGIN in 0.57 seconds
02:43:03.780107 [debug] [Thread-1 (]: SQL status: BEGIN in 0.57 seconds
02:43:03.780107 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:43:03.780107 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:43:03.781133 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
02:43:03.781133 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
02:43:03.823354 [debug] [Thread-2 (]: SQL status: BEGIN in 0.61 seconds
02:43:03.823354 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:43:03.824354 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
02:43:03.853633 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.07 seconds
02:43:03.853633 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.07 seconds
02:43:03.857407 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:43:03.859080 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:43:03.859080 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
02:43:03.859080 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
02:43:03.903133 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.08 seconds
02:43:03.904138 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:43:03.904138 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
02:43:03.930002 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
02:43:03.930002 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
02:43:03.931024 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:43:03.932024 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:43:03.932024 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
02:43:03.932024 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
02:43:03.982045 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.08 seconds
02:43:03.982794 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:43:03.982794 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
02:43:03.999850 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
02:43:04.003850 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
02:43:04.003850 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
02:43:04.004850 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:43:04.004850 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
02:43:04.005851 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
02:43:04.005851 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:43:04.005851 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
02:43:04.061009 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.08 seconds
02:43:04.062009 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
02:43:04.062009 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:43:04.062009 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
02:43:04.075020 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
02:43:04.075020 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
02:43:04.078024 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:43:04.078220 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:43:04.079232 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
02:43:04.079232 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
02:43:04.139634 [debug] [Thread-2 (]: SQL status: COMMIT in 0.08 seconds
02:43:04.140634 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:43:04.140634 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
02:43:04.147652 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
02:43:04.148650 [debug] [Thread-3 (]: finished collecting timing info
02:43:04.148650 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
02:43:04.149650 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b296115c-6244-4c42-ba38-2d288c81d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB5E9930>]}
02:43:04.149650 [info ] [Thread-3 (]: 3 of 4 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 0.96s]
02:43:04.150651 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
02:43:04.150651 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
02:43:04.151650 [debug] [Thread-1 (]: finished collecting timing info
02:43:04.151650 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
02:43:04.151650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b296115c-6244-4c42-ba38-2d288c81d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB63E9E0>]}
02:43:04.151650 [info ] [Thread-1 (]: 1 of 4 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 0.97s]
02:43:04.152650 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
02:43:04.218040 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.08 seconds
02:43:04.219041 [debug] [Thread-2 (]: finished collecting timing info
02:43:04.219041 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
02:43:04.219041 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b296115c-6244-4c42-ba38-2d288c81d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB628A60>]}
02:43:04.220042 [info ] [Thread-2 (]: 2 of 4 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 1.04s]
02:43:04.221041 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
02:43:04.221041 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_tracking
02:43:04.221041 [info ] [Thread-5 (]: 4 of 4 START view model production.satellite_tracking .......................... [RUN]
02:43:04.222043 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
02:43:04.222043 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_tracking
02:43:04.222043 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_tracking
02:43:04.225042 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
02:43:04.225042 [debug] [Thread-5 (]: finished collecting timing info
02:43:04.225042 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_tracking
02:43:04.226044 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
02:43:04.227044 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:43:04.227044 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: BEGIN
02:43:04.227044 [debug] [Thread-5 (]: Opening a new connection, currently in state init
02:43:04.815885 [debug] [Thread-5 (]: SQL status: BEGIN in 0.59 seconds
02:43:04.815885 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:43:04.815885 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft"

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft"
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id, satellite_position.timestamp)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id, satellite_tle.timestamp)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
02:43:04.891400 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.08 seconds
02:43:04.894400 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:43:04.894400 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
02:43:04.968054 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
02:43:04.969065 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: COMMIT
02:43:04.969065 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:43:04.969065 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: COMMIT
02:43:05.042966 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
02:43:05.043513 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:43:05.043513 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
02:43:05.117091 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
02:43:05.118111 [debug] [Thread-5 (]: finished collecting timing info
02:43:05.118111 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: Close
02:43:05.118111 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b296115c-6244-4c42-ba38-2d288c81d6b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB6B7C10>]}
02:43:05.119103 [info ] [Thread-5 (]: 4 of 4 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.90s]
02:43:05.119103 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_tracking
02:43:05.120104 [debug] [MainThread]: Acquiring new postgres connection "master"
02:43:05.121102 [debug] [MainThread]: Using postgres connection "master"
02:43:05.121102 [debug] [MainThread]: On master: BEGIN
02:43:05.121102 [debug] [MainThread]: Opening a new connection, currently in state closed
02:43:05.710982 [debug] [MainThread]: SQL status: BEGIN in 0.59 seconds
02:43:05.710982 [debug] [MainThread]: On master: COMMIT
02:43:05.710982 [debug] [MainThread]: Using postgres connection "master"
02:43:05.711982 [debug] [MainThread]: On master: COMMIT
02:43:05.784254 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
02:43:05.784254 [debug] [MainThread]: On master: Close
02:43:05.785244 [info ] [MainThread]: 
02:43:05.785244 [info ] [MainThread]: Finished running 4 view models in 4.89s.
02:43:05.786242 [debug] [MainThread]: Connection 'master' was properly closed.
02:43:05.786242 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
02:43:05.786242 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
02:43:05.786242 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
02:43:05.787242 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
02:43:05.787242 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
02:43:05.787242 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
02:43:05.787242 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
02:43:05.787242 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
02:43:05.791242 [info ] [MainThread]: 
02:43:05.792243 [info ] [MainThread]: [32mCompleted successfully[0m
02:43:05.792243 [info ] [MainThread]: 
02:43:05.793242 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
02:43:05.793242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB6C4550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB6C44F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235CB6C41F0>]}


============================== 2022-07-10 02:59:55.520648 | 4419dca8-b928-4739-8bd5-8d7c1fad7eed ==============================
02:59:55.520648 [info ] [MainThread]: Running with dbt=1.1.1
02:59:55.521648 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
02:59:55.521648 [debug] [MainThread]: Tracking: tracking
02:59:55.529648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C437610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C436FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C437220>]}
02:59:55.566648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
02:59:55.567648 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\satellite_tracking.sql
02:59:55.567648 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\staging\stg_satellite_position_ft.sql
02:59:55.574649 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
02:59:55.582649 [debug] [MainThread]: 1603: static parser failed on staging\stg_satellite_position_ft.sql
02:59:55.586649 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_satellite_position_ft.sql
02:59:55.618649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4419dca8-b928-4739-8bd5-8d7c1fad7eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C5BF1C0>]}
02:59:55.621648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4419dca8-b928-4739-8bd5-8d7c1fad7eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C5282B0>]}
02:59:55.622648 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
02:59:55.622648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4419dca8-b928-4739-8bd5-8d7c1fad7eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C528460>]}
02:59:55.623649 [info ] [MainThread]: 
02:59:55.623649 [debug] [MainThread]: Acquiring new postgres connection "master"
02:59:55.624649 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
02:59:55.625649 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
02:59:55.630649 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
02:59:55.631648 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
02:59:55.631648 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
02:59:55.631648 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
02:59:55.632648 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:59:55.632648 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:59:56.243828 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
02:59:56.244829 [debug] [ThreadPool]: On list_portfolio_website: Close
02:59:56.248828 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.62 seconds
02:59:56.249831 [debug] [ThreadPool]: On list_portfolio_website: Close
02:59:56.250829 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
02:59:56.250829 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
02:59:56.254831 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
02:59:56.255832 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
02:59:56.255832 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
02:59:56.256830 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
02:59:56.256830 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:59:56.256830 [debug] [ThreadPool]: Opening a new connection, currently in state init
02:59:56.835165 [debug] [ThreadPool]: SQL status: BEGIN in 0.58 seconds
02:59:56.836174 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
02:59:56.836174 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
02:59:56.864791 [debug] [ThreadPool]: SQL status: BEGIN in 0.61 seconds
02:59:56.864791 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
02:59:56.864791 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
02:59:56.912875 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.08 seconds
02:59:56.913889 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
02:59:56.957924 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.09 seconds
02:59:56.958924 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
02:59:56.985955 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
02:59:57.033009 [debug] [ThreadPool]: On list_portfolio_website_production: Close
02:59:57.036009 [debug] [MainThread]: Using postgres connection "master"
02:59:57.036009 [debug] [MainThread]: On master: BEGIN
02:59:57.037010 [debug] [MainThread]: Opening a new connection, currently in state init
02:59:57.641603 [debug] [MainThread]: SQL status: BEGIN in 0.6 seconds
02:59:57.641603 [debug] [MainThread]: Using postgres connection "master"
02:59:57.641603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
02:59:57.721868 [debug] [MainThread]: SQL status: SELECT 5 in 0.08 seconds
02:59:57.722880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4419dca8-b928-4739-8bd5-8d7c1fad7eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C563970>]}
02:59:57.722880 [debug] [MainThread]: On master: ROLLBACK
02:59:57.795097 [debug] [MainThread]: Using postgres connection "master"
02:59:57.795097 [debug] [MainThread]: On master: BEGIN
02:59:57.937993 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
02:59:57.937993 [debug] [MainThread]: On master: COMMIT
02:59:57.937993 [debug] [MainThread]: Using postgres connection "master"
02:59:57.937993 [debug] [MainThread]: On master: COMMIT
02:59:58.009086 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
02:59:58.009086 [debug] [MainThread]: On master: Close
02:59:58.010087 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
02:59:58.010087 [info ] [MainThread]: 
02:59:58.015086 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
02:59:58.015086 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
02:59:58.015086 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
02:59:58.015086 [info ] [Thread-1 (]: 1 of 4 START view model staging.stg_satellite_detail_dm ........................ [RUN]
02:59:58.016086 [info ] [Thread-2 (]: 2 of 4 START view model staging.stg_satellite_position_ft ...................... [RUN]
02:59:58.016086 [info ] [Thread-3 (]: 3 of 4 START view model staging.stg_satellite_tle_ft ........................... [RUN]
02:59:58.017087 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.017087 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.018087 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.018087 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
02:59:58.018087 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
02:59:58.018087 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
02:59:58.019087 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
02:59:58.019087 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
02:59:58.019087 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
02:59:58.021086 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.023086 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.025087 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.025087 [debug] [Thread-1 (]: finished collecting timing info
02:59:58.026086 [debug] [Thread-2 (]: finished collecting timing info
02:59:58.026086 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
02:59:58.026086 [debug] [Thread-3 (]: finished collecting timing info
02:59:58.026086 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
02:59:58.039088 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.039088 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
02:59:58.041086 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.042086 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.043086 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.043086 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.043086 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
02:59:58.043086 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.044087 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
02:59:58.044087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
02:59:58.044087 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
02:59:58.044087 [debug] [Thread-2 (]: Opening a new connection, currently in state init
02:59:58.045087 [debug] [Thread-3 (]: Opening a new connection, currently in state init
02:59:58.606796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.56 seconds
02:59:58.607797 [debug] [Thread-2 (]: SQL status: BEGIN in 0.56 seconds
02:59:58.607797 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.607797 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.608796 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
02:59:58.608796 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
02:59:58.649602 [debug] [Thread-3 (]: SQL status: BEGIN in 0.6 seconds
02:59:58.649602 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.649602 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
02:59:58.686694 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.08 seconds
02:59:58.686694 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.08 seconds
02:59:58.690698 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.693695 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.693695 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
02:59:58.693695 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
02:59:58.726753 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.08 seconds
02:59:58.728755 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.728755 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
02:59:58.763872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
02:59:58.763872 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
02:59:58.764877 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.766872 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.766872 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
02:59:58.766872 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
02:59:58.803838 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.08 seconds
02:59:58.804862 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.804862 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
02:59:58.836915 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
02:59:58.836915 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
02:59:58.840914 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
02:59:58.841902 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
02:59:58.841902 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.842902 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.842902 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
02:59:58.842902 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
02:59:58.880982 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.08 seconds
02:59:58.881983 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
02:59:58.881983 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.882982 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
02:59:58.913730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
02:59:58.913730 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
02:59:58.916755 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
02:59:58.917753 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
02:59:58.917753 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
02:59:58.917753 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
02:59:58.957791 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
02:59:58.958796 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
02:59:58.958796 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
02:59:58.989138 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
02:59:58.989138 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
02:59:58.990162 [debug] [Thread-1 (]: finished collecting timing info
02:59:58.990162 [debug] [Thread-2 (]: finished collecting timing info
02:59:58.991161 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
02:59:58.991161 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
02:59:58.991161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4419dca8-b928-4739-8bd5-8d7c1fad7eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C683C70>]}
02:59:58.992161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4419dca8-b928-4739-8bd5-8d7c1fad7eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C68FA30>]}
02:59:58.992161 [info ] [Thread-1 (]: 1 of 4 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 0.97s]
02:59:58.992161 [info ] [Thread-2 (]: 2 of 4 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 0.98s]
02:59:58.993162 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
02:59:58.994162 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
02:59:59.040796 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.08 seconds
02:59:59.041796 [debug] [Thread-3 (]: finished collecting timing info
02:59:59.041796 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
02:59:59.042796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4419dca8-b928-4739-8bd5-8d7c1fad7eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C6BA140>]}
02:59:59.042796 [info ] [Thread-3 (]: 3 of 4 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.02s]
02:59:59.043795 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
02:59:59.044797 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_tracking
02:59:59.044797 [info ] [Thread-5 (]: 4 of 4 START view model production.satellite_tracking .......................... [RUN]
02:59:59.045796 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
02:59:59.045796 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_tracking
02:59:59.045796 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_tracking
02:59:59.047797 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
02:59:59.048797 [debug] [Thread-5 (]: finished collecting timing info
02:59:59.048797 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_tracking
02:59:59.049797 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
02:59:59.050797 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:59:59.050797 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: BEGIN
02:59:59.050797 [debug] [Thread-5 (]: Opening a new connection, currently in state init
02:59:59.636742 [debug] [Thread-5 (]: SQL status: BEGIN in 0.59 seconds
02:59:59.636742 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:59:59.636742 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    WHERE satellite_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id, satellite_position.timestamp)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id, satellite_tle.timestamp)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
02:59:59.712351 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.07 seconds
02:59:59.713860 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:59:59.713860 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
02:59:59.787106 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
02:59:59.787106 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: COMMIT
02:59:59.788040 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:59:59.788040 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: COMMIT
02:59:59.861380 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
02:59:59.862381 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
02:59:59.862381 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
02:59:59.934889 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
02:59:59.935888 [debug] [Thread-5 (]: finished collecting timing info
02:59:59.935888 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: Close
02:59:59.936888 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4419dca8-b928-4739-8bd5-8d7c1fad7eed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C7F42B0>]}
02:59:59.936888 [info ] [Thread-5 (]: 4 of 4 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.89s]
02:59:59.937888 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_tracking
02:59:59.938889 [debug] [MainThread]: Acquiring new postgres connection "master"
02:59:59.938889 [debug] [MainThread]: Using postgres connection "master"
02:59:59.938889 [debug] [MainThread]: On master: BEGIN
02:59:59.938889 [debug] [MainThread]: Opening a new connection, currently in state closed
03:00:00.595186 [debug] [MainThread]: SQL status: BEGIN in 0.66 seconds
03:00:00.596187 [debug] [MainThread]: On master: COMMIT
03:00:00.596187 [debug] [MainThread]: Using postgres connection "master"
03:00:00.596187 [debug] [MainThread]: On master: COMMIT
03:00:00.672660 [debug] [MainThread]: SQL status: COMMIT in 0.08 seconds
03:00:00.672660 [debug] [MainThread]: On master: Close
03:00:00.673660 [info ] [MainThread]: 
03:00:00.673660 [info ] [MainThread]: Finished running 4 view models in 5.05s.
03:00:00.674660 [debug] [MainThread]: Connection 'master' was properly closed.
03:00:00.674660 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
03:00:00.674660 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
03:00:00.674660 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
03:00:00.674660 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
03:00:00.675660 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
03:00:00.675660 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
03:00:00.675660 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
03:00:00.675660 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
03:00:00.679660 [info ] [MainThread]: 
03:00:00.680660 [info ] [MainThread]: [32mCompleted successfully[0m
03:00:00.680660 [info ] [MainThread]: 
03:00:00.681661 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
03:00:00.681661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C68E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C479ED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A56C5352A0>]}


============================== 2022-07-10 03:04:56.786860 | 0f9e6f39-f9a2-4eff-b40b-6a4cf682f243 ==============================
03:04:56.786860 [info ] [MainThread]: Running with dbt=1.1.1
03:04:56.786860 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
03:04:56.787860 [debug] [MainThread]: Tracking: tracking
03:04:56.796860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDB97610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDB96FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDB97520>]}
03:04:56.832860 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:04:56.832860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:04:56.836860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f9e6f39-f9a2-4eff-b40b-6a4cf682f243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDCD24D0>]}
03:04:56.840860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f9e6f39-f9a2-4eff-b40b-6a4cf682f243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDC96770>]}
03:04:56.840860 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
03:04:56.841861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9e6f39-f9a2-4eff-b40b-6a4cf682f243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDC96800>]}
03:04:56.842860 [info ] [MainThread]: 
03:04:56.843860 [debug] [MainThread]: Acquiring new postgres connection "master"
03:04:56.844860 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
03:04:56.844860 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
03:04:56.850860 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:04:56.851860 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:04:56.852859 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
03:04:56.852859 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
03:04:56.852859 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:04:56.852859 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:04:57.541016 [debug] [ThreadPool]: SQL status: BEGIN in 0.69 seconds
03:04:57.541016 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:04:57.541016 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
03:04:57.550051 [debug] [ThreadPool]: SQL status: BEGIN in 0.7 seconds
03:04:57.550051 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:04:57.551053 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
03:04:57.612268 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
03:04:57.614269 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
03:04:57.624114 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.07 seconds
03:04:57.624300 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
03:04:57.684753 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
03:04:57.696754 [debug] [ThreadPool]: On list_portfolio_website_production: Close
03:04:57.699753 [debug] [MainThread]: Using postgres connection "master"
03:04:57.699753 [debug] [MainThread]: On master: BEGIN
03:04:57.699753 [debug] [MainThread]: Opening a new connection, currently in state init
03:04:58.286514 [debug] [MainThread]: SQL status: BEGIN in 0.59 seconds
03:04:58.286514 [debug] [MainThread]: Using postgres connection "master"
03:04:58.286514 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
03:04:58.376571 [debug] [MainThread]: SQL status: SELECT 5 in 0.09 seconds
03:04:58.377287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f9e6f39-f9a2-4eff-b40b-6a4cf682f243', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDC944F0>]}
03:04:58.377287 [debug] [MainThread]: On master: ROLLBACK
03:04:58.445794 [debug] [MainThread]: On master: Close
03:04:58.446798 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
03:04:58.446798 [info ] [MainThread]: 
03:04:58.450795 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
03:04:58.450795 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
03:04:58.450795 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
03:04:58.451795 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:04:58.451795 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:04:58.451795 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:04:58.452797 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
03:04:58.452797 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
03:04:58.452797 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
03:04:58.452797 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
03:04:58.452797 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
03:04:58.453796 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
03:04:58.455795 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
03:04:58.459793 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
03:04:58.460794 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
03:04:58.461793 [debug] [Thread-1 (]: finished collecting timing info
03:04:58.461793 [debug] [Thread-2 (]: finished collecting timing info
03:04:58.462795 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
03:04:58.462795 [debug] [Thread-3 (]: finished collecting timing info
03:04:58.462795 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
03:04:58.462795 [debug] [Thread-1 (]: finished collecting timing info
03:04:58.462795 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
03:04:58.463796 [debug] [Thread-2 (]: finished collecting timing info
03:04:58.463796 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
03:04:58.463796 [debug] [Thread-3 (]: finished collecting timing info
03:04:58.464795 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
03:04:58.464795 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:04:58.464795 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:04:58.465795 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
03:04:58.465795 [debug] [Thread-1 (]: Began running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:04:58.465795 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:04:58.466796 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
03:04:58.466796 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
03:04:58.466796 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:04:58.467796 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
03:04:58.467796 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
03:04:58.467796 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:04:58.468795 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:04:58.468795 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
03:04:58.468795 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:04:58.469795 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:04:58.469795 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:04:58.469795 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:04:58.469795 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:04:58.469795 [debug] [Thread-1 (]: Compiling test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:04:58.470795 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:04:58.478797 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
03:04:58.480797 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
03:04:58.480797 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:04:58.486794 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
03:04:58.488795 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
03:04:58.491795 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
03:04:58.491795 [debug] [Thread-5 (]: finished collecting timing info
03:04:58.491795 [debug] [Thread-4 (]: finished collecting timing info
03:04:58.492795 [debug] [Thread-1 (]: finished collecting timing info
03:04:58.492795 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:04:58.492795 [debug] [Thread-2 (]: finished collecting timing info
03:04:58.492795 [debug] [Thread-3 (]: finished collecting timing info
03:04:58.492795 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:04:58.493795 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:04:58.493795 [debug] [Thread-5 (]: finished collecting timing info
03:04:58.493795 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:04:58.493795 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:04:58.494795 [debug] [Thread-4 (]: finished collecting timing info
03:04:58.494795 [debug] [Thread-1 (]: finished collecting timing info
03:04:58.494795 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:04:58.495794 [debug] [Thread-2 (]: finished collecting timing info
03:04:58.495794 [debug] [Thread-3 (]: finished collecting timing info
03:04:58.495794 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:04:58.496794 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:04:58.496794 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:04:58.496794 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:04:58.497794 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:04:58.497794 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:04:58.497794 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:04:58.498796 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
03:04:58.498796 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:04:58.498796 [debug] [Thread-3 (]: Began running node model.satellite_tracker.satellite_tracking
03:04:58.498796 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
03:04:58.499798 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
03:04:58.499798 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:04:58.499798 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
03:04:58.500795 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
03:04:58.500795 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:04:58.500795 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:04:58.500795 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:04:58.500795 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:04:58.501795 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.satellite_tracking
03:04:58.501795 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:04:58.501795 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:04:58.503797 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
03:04:58.504797 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:04:58.504797 [debug] [Thread-3 (]: Compiling model.satellite_tracker.satellite_tracking
03:04:58.506795 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
03:04:58.509795 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
03:04:58.511795 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
03:04:58.513794 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
03:04:58.513794 [debug] [Thread-5 (]: finished collecting timing info
03:04:58.514794 [debug] [Thread-4 (]: finished collecting timing info
03:04:58.514794 [debug] [Thread-1 (]: finished collecting timing info
03:04:58.514794 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:04:58.514794 [debug] [Thread-2 (]: finished collecting timing info
03:04:58.515795 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:04:58.515795 [debug] [Thread-3 (]: finished collecting timing info
03:04:58.515795 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:04:58.515795 [debug] [Thread-5 (]: finished collecting timing info
03:04:58.515795 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:04:58.516795 [debug] [Thread-4 (]: finished collecting timing info
03:04:58.516795 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.satellite_tracking
03:04:58.516795 [debug] [Thread-1 (]: finished collecting timing info
03:04:58.516795 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:04:58.517795 [debug] [Thread-2 (]: finished collecting timing info
03:04:58.517795 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:04:58.517795 [debug] [Thread-3 (]: finished collecting timing info
03:04:58.518795 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:04:58.518795 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:04:58.518795 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:04:58.518795 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:04:58.519795 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.satellite_tracking
03:04:58.519795 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:04:58.519795 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
03:04:58.519795 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:04:58.520799 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
03:04:58.520799 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:04:58.520799 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
03:04:58.521795 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:04:58.521795 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
03:04:58.521795 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:04:58.521795 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
03:04:58.522795 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:04:58.522795 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:04:58.522795 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:04:58.522795 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:04:58.523795 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:04:58.523795 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:04:58.525795 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
03:04:58.525795 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:04:58.527795 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
03:04:58.527795 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:04:58.529794 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
03:04:58.532796 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
03:04:58.532796 [debug] [Thread-5 (]: finished collecting timing info
03:04:58.534795 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
03:04:58.534795 [debug] [Thread-4 (]: finished collecting timing info
03:04:58.535795 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:04:58.535795 [debug] [Thread-1 (]: finished collecting timing info
03:04:58.535795 [debug] [Thread-2 (]: finished collecting timing info
03:04:58.535795 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:04:58.536795 [debug] [Thread-3 (]: finished collecting timing info
03:04:58.536795 [debug] [Thread-5 (]: finished collecting timing info
03:04:58.536795 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:04:58.536795 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:04:58.536795 [debug] [Thread-4 (]: finished collecting timing info
03:04:58.537795 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:04:58.537795 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:04:58.537795 [debug] [Thread-1 (]: finished collecting timing info
03:04:58.538794 [debug] [Thread-2 (]: finished collecting timing info
03:04:58.538794 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:04:58.538794 [debug] [Thread-3 (]: finished collecting timing info
03:04:58.539796 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:04:58.539796 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:04:58.540795 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:04:58.541796 [debug] [MainThread]: Connection 'master' was properly closed.
03:04:58.541796 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
03:04:58.541796 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
03:04:58.542798 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11' was properly closed.
03:04:58.542798 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f' was properly closed.
03:04:58.542798 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9' was properly closed.
03:04:58.542798 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034' was properly closed.
03:04:58.542798 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3' was properly closed.
03:04:58.546797 [info ] [MainThread]: Done.
03:04:58.546797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDCC7E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDD4F460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298EDD4F400>]}


============================== 2022-07-10 03:05:29.058605 | 0f12fee2-e91c-46f6-93bd-fdd0c76c31ce ==============================
03:05:29.058605 [info ] [MainThread]: Running with dbt=1.1.1
03:05:29.059605 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
03:05:29.059605 [debug] [MainThread]: Tracking: tracking
03:05:29.067606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD107610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD106FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD107220>]}
03:05:29.099605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:05:29.099605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:05:29.103606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0f12fee2-e91c-46f6-93bd-fdd0c76c31ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD23E530>]}
03:05:29.107605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0f12fee2-e91c-46f6-93bd-fdd0c76c31ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD1527D0>]}
03:05:29.108605 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
03:05:29.108605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f12fee2-e91c-46f6-93bd-fdd0c76c31ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD152860>]}
03:05:29.109606 [info ] [MainThread]: 
03:05:29.110607 [debug] [MainThread]: Acquiring new postgres connection "master"
03:05:29.111606 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
03:05:29.111606 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
03:05:29.117608 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:05:29.118606 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:05:29.119606 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
03:05:29.119606 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
03:05:29.119606 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:05:29.119606 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:05:29.723709 [debug] [ThreadPool]: SQL status: BEGIN in 0.6 seconds
03:05:29.723709 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:05:29.724538 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
03:05:29.798870 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.07 seconds
03:05:29.799869 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
03:05:29.843010 [debug] [ThreadPool]: SQL status: BEGIN in 0.72 seconds
03:05:29.843010 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:05:29.843010 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
03:05:29.873036 [debug] [ThreadPool]: On list_portfolio_website_production: Close
03:05:29.930112 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.09 seconds
03:05:29.931112 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
03:05:30.016253 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
03:05:30.020254 [debug] [MainThread]: Using postgres connection "master"
03:05:30.020254 [debug] [MainThread]: On master: BEGIN
03:05:30.020254 [debug] [MainThread]: Opening a new connection, currently in state init
03:05:30.586886 [debug] [MainThread]: SQL status: BEGIN in 0.57 seconds
03:05:30.586886 [debug] [MainThread]: Using postgres connection "master"
03:05:30.586886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
03:05:30.664981 [debug] [MainThread]: SQL status: SELECT 5 in 0.08 seconds
03:05:30.665981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0f12fee2-e91c-46f6-93bd-fdd0c76c31ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD279810>]}
03:05:30.665981 [debug] [MainThread]: On master: ROLLBACK
03:05:30.736295 [debug] [MainThread]: On master: Close
03:05:30.736295 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
03:05:30.737296 [info ] [MainThread]: 
03:05:30.741296 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
03:05:30.741296 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
03:05:30.741296 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
03:05:30.741296 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:05:30.742298 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:05:30.742298 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:05:30.743297 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
03:05:30.743297 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
03:05:30.743297 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
03:05:30.743297 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
03:05:30.744295 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
03:05:30.744295 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
03:05:30.746295 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
03:05:30.749296 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
03:05:30.751296 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
03:05:30.752296 [debug] [Thread-1 (]: finished collecting timing info
03:05:30.752296 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
03:05:30.752296 [debug] [Thread-2 (]: finished collecting timing info
03:05:30.752296 [debug] [Thread-1 (]: finished collecting timing info
03:05:30.752296 [debug] [Thread-3 (]: finished collecting timing info
03:05:30.752296 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
03:05:30.753297 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
03:05:30.753297 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
03:05:30.753297 [debug] [Thread-2 (]: finished collecting timing info
03:05:30.754297 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:05:30.754297 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:05:30.754297 [debug] [Thread-3 (]: finished collecting timing info
03:05:30.755296 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
03:05:30.755296 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
03:05:30.755296 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
03:05:30.756296 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
03:05:30.756296 [debug] [Thread-1 (]: Began running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:05:30.756296 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:05:30.757295 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:05:30.757295 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:05:30.757295 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:05:30.758296 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
03:05:30.758296 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
03:05:30.758296 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:05:30.758296 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:05:30.759295 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
03:05:30.759295 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:05:30.759295 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:05:30.767296 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
03:05:30.770296 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
03:05:30.770296 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:05:30.770296 [debug] [Thread-1 (]: Compiling test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:05:30.770296 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:05:30.771297 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:05:30.771297 [debug] [Thread-5 (]: finished collecting timing info
03:05:30.777295 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
03:05:30.777295 [debug] [Thread-4 (]: finished collecting timing info
03:05:30.779295 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
03:05:30.781295 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
03:05:30.782295 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:05:30.782295 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:05:30.782295 [debug] [Thread-1 (]: finished collecting timing info
03:05:30.783296 [debug] [Thread-5 (]: finished collecting timing info
03:05:30.783296 [debug] [Thread-2 (]: finished collecting timing info
03:05:30.783296 [debug] [Thread-3 (]: finished collecting timing info
03:05:30.783296 [debug] [Thread-4 (]: finished collecting timing info
03:05:30.784296 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:05:30.784296 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:05:30.784296 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:05:30.785296 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:05:30.785296 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:05:30.785296 [debug] [Thread-1 (]: finished collecting timing info
03:05:30.786296 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:05:30.786296 [debug] [Thread-2 (]: finished collecting timing info
03:05:30.786296 [debug] [Thread-3 (]: finished collecting timing info
03:05:30.786296 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:05:30.787296 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:05:30.787296 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
03:05:30.788295 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:05:30.788295 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:05:30.788295 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
03:05:30.789295 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:05:30.789295 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:05:30.789295 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:05:30.789295 [debug] [Thread-3 (]: Began running node model.satellite_tracker.satellite_tracking
03:05:30.790295 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:05:30.790295 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
03:05:30.790295 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:05:30.790295 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
03:05:30.791295 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
03:05:30.791295 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:05:30.791295 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:05:30.794295 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
03:05:30.794295 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:05:30.794295 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.satellite_tracking
03:05:30.797296 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
03:05:30.797296 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:05:30.797296 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:05:30.797296 [debug] [Thread-5 (]: finished collecting timing info
03:05:30.798295 [debug] [Thread-3 (]: Compiling model.satellite_tracker.satellite_tracking
03:05:30.800295 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
03:05:30.800295 [debug] [Thread-4 (]: finished collecting timing info
03:05:30.803295 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
03:05:30.803295 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:05:30.806297 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
03:05:30.806297 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:05:30.806297 [debug] [Thread-1 (]: finished collecting timing info
03:05:30.807296 [debug] [Thread-5 (]: finished collecting timing info
03:05:30.807296 [debug] [Thread-2 (]: finished collecting timing info
03:05:30.807296 [debug] [Thread-4 (]: finished collecting timing info
03:05:30.807296 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:05:30.807296 [debug] [Thread-3 (]: finished collecting timing info
03:05:30.808297 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:05:30.808297 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:05:30.809296 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:05:30.809296 [debug] [Thread-1 (]: finished collecting timing info
03:05:30.809296 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.satellite_tracking
03:05:30.809296 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:05:30.809296 [debug] [Thread-2 (]: finished collecting timing info
03:05:30.810295 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:05:30.810295 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:05:30.810295 [debug] [Thread-3 (]: finished collecting timing info
03:05:30.811296 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
03:05:30.811296 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:05:30.812296 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
03:05:30.812296 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:05:30.812296 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.satellite_tracking
03:05:30.813297 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:05:30.813297 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:05:30.813297 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:05:30.813297 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
03:05:30.814296 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:05:30.814296 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:05:30.814296 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
03:05:30.814296 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:05:30.815297 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:05:30.815297 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
03:05:30.817295 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
03:05:30.817295 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:05:30.820297 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
03:05:30.820297 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:05:30.820297 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:05:30.821297 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:05:30.821297 [debug] [Thread-5 (]: finished collecting timing info
03:05:30.823296 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
03:05:30.823296 [debug] [Thread-4 (]: finished collecting timing info
03:05:30.824297 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:05:30.825295 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
03:05:30.826295 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:05:30.826295 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:05:30.826295 [debug] [Thread-1 (]: finished collecting timing info
03:05:30.828295 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
03:05:30.829296 [debug] [Thread-5 (]: finished collecting timing info
03:05:30.829296 [debug] [Thread-2 (]: finished collecting timing info
03:05:30.829296 [debug] [Thread-4 (]: finished collecting timing info
03:05:30.830296 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:05:30.830296 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:05:30.830296 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:05:30.830296 [debug] [Thread-3 (]: finished collecting timing info
03:05:30.831295 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:05:30.831295 [debug] [Thread-1 (]: finished collecting timing info
03:05:30.832296 [debug] [Thread-2 (]: finished collecting timing info
03:05:30.832296 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:05:30.832296 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:05:30.833296 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:05:30.833296 [debug] [Thread-3 (]: finished collecting timing info
03:05:30.834295 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:05:30.835295 [debug] [MainThread]: Connection 'master' was properly closed.
03:05:30.835295 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
03:05:30.835295 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
03:05:30.835295 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11' was properly closed.
03:05:30.836295 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f' was properly closed.
03:05:30.836295 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9' was properly closed.
03:05:30.836295 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034' was properly closed.
03:05:30.836295 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3' was properly closed.
03:05:30.840295 [info ] [MainThread]: Done.
03:05:30.841297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD32CE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD32C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000220CD32D930>]}


============================== 2022-07-10 03:07:01.594162 | 3f42d11a-70de-49a4-93d3-b38e43928774 ==============================
03:07:01.594162 [info ] [MainThread]: Running with dbt=1.1.1
03:07:01.595162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
03:07:01.595162 [debug] [MainThread]: Tracking: tracking
03:07:01.602163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A0F62050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A0F56FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A0F57550>]}
03:07:01.633164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:07:01.633164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:07:01.638162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f42d11a-70de-49a4-93d3-b38e43928774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A108E500>]}
03:07:01.642162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f42d11a-70de-49a4-93d3-b38e43928774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A0FA2770>]}
03:07:01.642162 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
03:07:01.643162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f42d11a-70de-49a4-93d3-b38e43928774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A0F62050>]}
03:07:01.644162 [info ] [MainThread]: 
03:07:01.644162 [debug] [MainThread]: Acquiring new postgres connection "master"
03:07:01.645163 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
03:07:01.646163 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
03:07:01.652162 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:07:01.653164 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:07:01.653164 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
03:07:01.654162 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
03:07:01.654162 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:07:01.654162 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:07:02.265349 [debug] [ThreadPool]: SQL status: BEGIN in 0.61 seconds
03:07:02.266352 [debug] [ThreadPool]: SQL status: BEGIN in 0.61 seconds
03:07:02.266352 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:07:02.266352 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:07:02.266352 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
03:07:02.267351 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
03:07:02.339485 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
03:07:02.339485 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.07 seconds
03:07:02.340486 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
03:07:02.341486 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
03:07:02.414019 [debug] [ThreadPool]: On list_portfolio_website_production: Close
03:07:02.414019 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
03:07:02.417468 [debug] [MainThread]: Using postgres connection "master"
03:07:02.417468 [debug] [MainThread]: On master: BEGIN
03:07:02.417468 [debug] [MainThread]: Opening a new connection, currently in state init
03:07:03.008198 [debug] [MainThread]: SQL status: BEGIN in 0.59 seconds
03:07:03.008198 [debug] [MainThread]: Using postgres connection "master"
03:07:03.009199 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
03:07:03.097366 [debug] [MainThread]: SQL status: SELECT 5 in 0.09 seconds
03:07:03.098368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f42d11a-70de-49a4-93d3-b38e43928774', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A10D88B0>]}
03:07:03.098368 [debug] [MainThread]: On master: ROLLBACK
03:07:03.171152 [debug] [MainThread]: On master: Close
03:07:03.172152 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
03:07:03.172152 [info ] [MainThread]: 
03:07:03.176154 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
03:07:03.176154 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
03:07:03.176154 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
03:07:03.177152 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:07:03.177152 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:07:03.177152 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:07:03.178155 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
03:07:03.178155 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
03:07:03.178155 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
03:07:03.178155 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
03:07:03.179153 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
03:07:03.179153 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
03:07:03.181153 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
03:07:03.185155 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
03:07:03.186152 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
03:07:03.187153 [debug] [Thread-1 (]: finished collecting timing info
03:07:03.187153 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
03:07:03.187153 [debug] [Thread-2 (]: finished collecting timing info
03:07:03.188154 [debug] [Thread-1 (]: finished collecting timing info
03:07:03.188154 [debug] [Thread-3 (]: finished collecting timing info
03:07:03.188154 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
03:07:03.188154 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
03:07:03.189154 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
03:07:03.189154 [debug] [Thread-2 (]: finished collecting timing info
03:07:03.189154 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:07:03.189154 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:07:03.190153 [debug] [Thread-3 (]: finished collecting timing info
03:07:03.190153 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
03:07:03.190153 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
03:07:03.191152 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
03:07:03.191152 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
03:07:03.191152 [debug] [Thread-1 (]: Began running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:07:03.192153 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:07:03.192153 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:07:03.192153 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:07:03.193153 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:07:03.193153 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
03:07:03.193153 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
03:07:03.194152 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:07:03.194152 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:07:03.194152 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
03:07:03.195153 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:07:03.195153 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:07:03.203153 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
03:07:03.205152 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
03:07:03.205152 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:07:03.205152 [debug] [Thread-1 (]: Compiling test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:07:03.205152 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:07:03.206153 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:07:03.206153 [debug] [Thread-5 (]: finished collecting timing info
03:07:03.206153 [debug] [Thread-4 (]: finished collecting timing info
03:07:03.211152 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
03:07:03.214153 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
03:07:03.216153 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
03:07:03.216153 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:07:03.216153 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:07:03.217152 [debug] [Thread-1 (]: finished collecting timing info
03:07:03.217152 [debug] [Thread-5 (]: finished collecting timing info
03:07:03.217152 [debug] [Thread-2 (]: finished collecting timing info
03:07:03.217152 [debug] [Thread-3 (]: finished collecting timing info
03:07:03.217152 [debug] [Thread-4 (]: finished collecting timing info
03:07:03.218152 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:07:03.218152 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:07:03.218152 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:07:03.219153 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:07:03.219153 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:07:03.219153 [debug] [Thread-1 (]: finished collecting timing info
03:07:03.220153 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:07:03.220153 [debug] [Thread-2 (]: finished collecting timing info
03:07:03.220153 [debug] [Thread-3 (]: finished collecting timing info
03:07:03.220153 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:07:03.221153 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:07:03.221153 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
03:07:03.221153 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:07:03.222152 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:07:03.222152 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
03:07:03.222152 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:07:03.223153 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:07:03.223153 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:07:03.223153 [debug] [Thread-3 (]: Began running node model.satellite_tracker.satellite_tracking
03:07:03.223153 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:07:03.224154 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
03:07:03.224154 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:07:03.224154 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
03:07:03.225152 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
03:07:03.225152 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:07:03.225152 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:07:03.228153 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
03:07:03.228153 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:07:03.228153 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.satellite_tracking
03:07:03.231153 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
03:07:03.231153 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:07:03.231153 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:07:03.232152 [debug] [Thread-5 (]: finished collecting timing info
03:07:03.232152 [debug] [Thread-3 (]: Compiling model.satellite_tracker.satellite_tracking
03:07:03.234155 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
03:07:03.237155 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
03:07:03.237155 [debug] [Thread-4 (]: finished collecting timing info
03:07:03.238152 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:07:03.240152 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
03:07:03.241156 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:07:03.241156 [debug] [Thread-1 (]: finished collecting timing info
03:07:03.241156 [debug] [Thread-5 (]: finished collecting timing info
03:07:03.241156 [debug] [Thread-2 (]: finished collecting timing info
03:07:03.241156 [debug] [Thread-4 (]: finished collecting timing info
03:07:03.242153 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:07:03.242153 [debug] [Thread-3 (]: finished collecting timing info
03:07:03.242153 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:07:03.242153 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:07:03.243155 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:07:03.243155 [debug] [Thread-1 (]: finished collecting timing info
03:07:03.243155 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.satellite_tracking
03:07:03.244152 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:07:03.244152 [debug] [Thread-2 (]: finished collecting timing info
03:07:03.244152 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:07:03.244152 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:07:03.245154 [debug] [Thread-3 (]: finished collecting timing info
03:07:03.245154 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
03:07:03.245154 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:07:03.246152 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
03:07:03.246152 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:07:03.246152 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.satellite_tracking
03:07:03.247155 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:07:03.247155 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:07:03.247155 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:07:03.248155 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
03:07:03.248155 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:07:03.248155 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:07:03.248155 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
03:07:03.249153 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:07:03.249153 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:07:03.249153 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
03:07:03.251152 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
03:07:03.252153 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:07:03.254156 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
03:07:03.254156 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:07:03.255154 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:07:03.255154 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:07:03.255154 [debug] [Thread-5 (]: finished collecting timing info
03:07:03.257156 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
03:07:03.257156 [debug] [Thread-4 (]: finished collecting timing info
03:07:03.258155 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:07:03.259155 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
03:07:03.260156 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:07:03.260156 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:07:03.261155 [debug] [Thread-1 (]: finished collecting timing info
03:07:03.262156 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
03:07:03.263154 [debug] [Thread-5 (]: finished collecting timing info
03:07:03.263154 [debug] [Thread-2 (]: finished collecting timing info
03:07:03.263154 [debug] [Thread-4 (]: finished collecting timing info
03:07:03.264155 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:07:03.264155 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:07:03.264155 [debug] [Thread-3 (]: finished collecting timing info
03:07:03.265153 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:07:03.265153 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:07:03.265153 [debug] [Thread-1 (]: finished collecting timing info
03:07:03.266153 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:07:03.266153 [debug] [Thread-2 (]: finished collecting timing info
03:07:03.266153 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:07:03.267152 [debug] [Thread-3 (]: finished collecting timing info
03:07:03.267152 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:07:03.268153 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:07:03.269154 [debug] [MainThread]: Connection 'master' was properly closed.
03:07:03.269154 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
03:07:03.269154 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
03:07:03.269154 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11' was properly closed.
03:07:03.269154 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f' was properly closed.
03:07:03.270152 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9' was properly closed.
03:07:03.270152 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034' was properly closed.
03:07:03.270152 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3' was properly closed.
03:07:03.274153 [info ] [MainThread]: Done.
03:07:03.275152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A11841C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A1184280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199A11856C0>]}


============================== 2022-07-10 03:08:39.935787 | 8707d384-ac41-4ca8-a462-d81c0e848a70 ==============================
03:08:39.935787 [info ] [MainThread]: Running with dbt=1.1.1
03:08:39.935787 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
03:08:39.935787 [debug] [MainThread]: Tracking: tracking
03:08:39.942789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FCFA7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FCFA6FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FCFA7220>]}
03:08:39.976788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
03:08:39.976788 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\satellite_tracking.sql
03:08:39.983787 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
03:08:39.996789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8707d384-ac41-4ca8-a462-d81c0e848a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD139450>]}
03:08:40.001789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8707d384-ac41-4ca8-a462-d81c0e848a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD0CF9D0>]}
03:08:40.001789 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
03:08:40.001789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8707d384-ac41-4ca8-a462-d81c0e848a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD0CECB0>]}
03:08:40.003790 [info ] [MainThread]: 
03:08:40.003790 [debug] [MainThread]: Acquiring new postgres connection "master"
03:08:40.004790 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
03:08:40.004790 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
03:08:40.009788 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
03:08:40.010789 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
03:08:40.011788 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
03:08:40.011788 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
03:08:40.011788 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:40.011788 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:40.628115 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.62 seconds
03:08:40.629120 [debug] [ThreadPool]: On list_portfolio_website: Close
03:08:40.672370 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.66 seconds
03:08:40.673394 [debug] [ThreadPool]: On list_portfolio_website: Close
03:08:40.674537 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
03:08:40.675394 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
03:08:40.679394 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:08:40.680394 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:08:40.680394 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
03:08:40.680394 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
03:08:40.680394 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:40.681382 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:08:41.259485 [debug] [ThreadPool]: SQL status: BEGIN in 0.58 seconds
03:08:41.259485 [debug] [ThreadPool]: SQL status: BEGIN in 0.58 seconds
03:08:41.259485 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:08:41.259485 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:08:41.260487 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
03:08:41.260487 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
03:08:41.334159 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.07 seconds
03:08:41.334159 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
03:08:41.335167 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
03:08:41.336167 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
03:08:41.408886 [debug] [ThreadPool]: On list_portfolio_website_production: Close
03:08:41.408886 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
03:08:41.411887 [debug] [MainThread]: Using postgres connection "master"
03:08:41.411887 [debug] [MainThread]: On master: BEGIN
03:08:41.411887 [debug] [MainThread]: Opening a new connection, currently in state init
03:08:42.037816 [debug] [MainThread]: SQL status: BEGIN in 0.63 seconds
03:08:42.037816 [debug] [MainThread]: Using postgres connection "master"
03:08:42.037816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
03:08:42.118962 [debug] [MainThread]: SQL status: SELECT 5 in 0.08 seconds
03:08:42.119961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8707d384-ac41-4ca8-a462-d81c0e848a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD138520>]}
03:08:42.120963 [debug] [MainThread]: On master: ROLLBACK
03:08:42.196477 [debug] [MainThread]: Using postgres connection "master"
03:08:42.196477 [debug] [MainThread]: On master: BEGIN
03:08:42.348873 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
03:08:42.348873 [debug] [MainThread]: On master: COMMIT
03:08:42.348873 [debug] [MainThread]: Using postgres connection "master"
03:08:42.348873 [debug] [MainThread]: On master: COMMIT
03:08:42.420972 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
03:08:42.421972 [debug] [MainThread]: On master: Close
03:08:42.421972 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
03:08:42.422963 [info ] [MainThread]: 
03:08:42.426977 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
03:08:42.426977 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
03:08:42.426977 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
03:08:42.426977 [info ] [Thread-1 (]: 1 of 4 START view model staging.stg_satellite_detail_dm ........................ [RUN]
03:08:42.427975 [info ] [Thread-2 (]: 2 of 4 START view model staging.stg_satellite_position_ft ...................... [RUN]
03:08:42.427975 [info ] [Thread-3 (]: 3 of 4 START view model staging.stg_satellite_tle_ft ........................... [RUN]
03:08:42.427975 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:08:42.428974 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:08:42.428974 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:08:42.429974 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
03:08:42.429974 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
03:08:42.429974 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
03:08:42.429974 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
03:08:42.429974 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
03:08:42.430975 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
03:08:42.432975 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
03:08:42.435975 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
03:08:42.436976 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
03:08:42.437975 [debug] [Thread-1 (]: finished collecting timing info
03:08:42.437975 [debug] [Thread-2 (]: finished collecting timing info
03:08:42.438974 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
03:08:42.438974 [debug] [Thread-3 (]: finished collecting timing info
03:08:42.438974 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
03:08:42.453974 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
03:08:42.453974 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
03:08:42.455973 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
03:08:42.456974 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
03:08:42.457975 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:08:42.457975 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:08:42.457975 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
03:08:42.458974 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:08:42.458974 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
03:08:42.458974 [debug] [Thread-1 (]: Opening a new connection, currently in state init
03:08:42.458974 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
03:08:42.458974 [debug] [Thread-2 (]: Opening a new connection, currently in state init
03:08:42.459975 [debug] [Thread-3 (]: Opening a new connection, currently in state init
03:08:43.028386 [debug] [Thread-3 (]: SQL status: BEGIN in 0.57 seconds
03:08:43.028386 [debug] [Thread-2 (]: SQL status: BEGIN in 0.57 seconds
03:08:43.028386 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:08:43.029387 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:08:43.029387 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
03:08:43.029387 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
03:08:43.037869 [debug] [Thread-1 (]: SQL status: BEGIN in 0.58 seconds
03:08:43.038869 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:08:43.038869 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
03:08:43.107952 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.08 seconds
03:08:43.107952 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.08 seconds
03:08:43.111948 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:08:43.111948 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.07 seconds
03:08:43.113950 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:08:43.113950 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
03:08:43.114952 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:08:43.115948 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
03:08:43.115948 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
03:08:43.186408 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
03:08:43.188409 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:08:43.188409 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
03:08:43.189410 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
03:08:43.189410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
03:08:43.190409 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:08:43.192408 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:08:43.192642 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
03:08:43.192642 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
03:08:43.260676 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
03:08:43.264676 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
03:08:43.264676 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
03:08:43.264676 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
03:08:43.264676 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:08:43.265676 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
03:08:43.266676 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
03:08:43.266676 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
03:08:43.266676 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:08:43.267676 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:08:43.267676 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
03:08:43.267676 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
03:08:43.336983 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
03:08:43.339695 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:08:43.340695 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
03:08:43.340695 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
03:08:43.340695 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
03:08:43.341695 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:08:43.342695 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:08:43.343695 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
03:08:43.343695 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
03:08:43.413814 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
03:08:43.414814 [debug] [Thread-3 (]: finished collecting timing info
03:08:43.414814 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
03:08:43.415815 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8707d384-ac41-4ca8-a462-d81c0e848a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD0CEB90>]}
03:08:43.415815 [info ] [Thread-3 (]: 3 of 4 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 0.99s]
03:08:43.416814 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
03:08:43.419815 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.08 seconds
03:08:43.419815 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.08 seconds
03:08:43.420817 [debug] [Thread-2 (]: finished collecting timing info
03:08:43.421816 [debug] [Thread-1 (]: finished collecting timing info
03:08:43.421816 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
03:08:43.421816 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
03:08:43.422816 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8707d384-ac41-4ca8-a462-d81c0e848a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD0CFD00>]}
03:08:43.422816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8707d384-ac41-4ca8-a462-d81c0e848a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD0D3760>]}
03:08:43.422816 [info ] [Thread-2 (]: 2 of 4 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 0.99s]
03:08:43.422816 [info ] [Thread-1 (]: 1 of 4 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 0.99s]
03:08:43.423816 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
03:08:43.424814 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
03:08:43.424814 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_tracking
03:08:43.424814 [info ] [Thread-5 (]: 4 of 4 START view model production.satellite_tracking .......................... [RUN]
03:08:43.425814 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
03:08:43.425814 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_tracking
03:08:43.425814 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_tracking
03:08:43.428814 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
03:08:43.428814 [debug] [Thread-5 (]: finished collecting timing info
03:08:43.428814 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_tracking
03:08:43.430814 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
03:08:43.430814 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
03:08:43.430814 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: BEGIN
03:08:43.431815 [debug] [Thread-5 (]: Opening a new connection, currently in state init
03:08:44.023006 [debug] [Thread-5 (]: SQL status: BEGIN in 0.59 seconds
03:08:44.024010 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
03:08:44.024010 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    WHERE satellite_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
03:08:44.099154 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.08 seconds
03:08:44.102153 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
03:08:44.102153 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
03:08:44.175265 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
03:08:44.176266 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: COMMIT
03:08:44.176266 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
03:08:44.176266 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: COMMIT
03:08:44.250381 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
03:08:44.251386 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
03:08:44.251386 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
03:08:44.325512 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
03:08:44.326512 [debug] [Thread-5 (]: finished collecting timing info
03:08:44.326512 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_tracking: Close
03:08:44.326512 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8707d384-ac41-4ca8-a462-d81c0e848a70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD242B90>]}
03:08:44.327513 [info ] [Thread-5 (]: 4 of 4 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.90s]
03:08:44.327513 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_tracking
03:08:44.328514 [debug] [MainThread]: Acquiring new postgres connection "master"
03:08:44.329513 [debug] [MainThread]: Using postgres connection "master"
03:08:44.329513 [debug] [MainThread]: On master: BEGIN
03:08:44.329513 [debug] [MainThread]: Opening a new connection, currently in state closed
03:08:44.981734 [debug] [MainThread]: SQL status: BEGIN in 0.65 seconds
03:08:44.981734 [debug] [MainThread]: On master: COMMIT
03:08:44.981734 [debug] [MainThread]: Using postgres connection "master"
03:08:44.981734 [debug] [MainThread]: On master: COMMIT
03:08:45.061305 [debug] [MainThread]: SQL status: COMMIT in 0.08 seconds
03:08:45.061305 [debug] [MainThread]: On master: Close
03:08:45.061305 [info ] [MainThread]: 
03:08:45.062306 [info ] [MainThread]: Finished running 4 view models in 5.06s.
03:08:45.062306 [debug] [MainThread]: Connection 'master' was properly closed.
03:08:45.063306 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
03:08:45.063306 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
03:08:45.063306 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
03:08:45.063306 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
03:08:45.063306 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
03:08:45.064305 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
03:08:45.064305 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
03:08:45.064305 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
03:08:45.068306 [info ] [MainThread]: 
03:08:45.069305 [info ] [MainThread]: [32mCompleted successfully[0m
03:08:45.069305 [info ] [MainThread]: 
03:08:45.070307 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
03:08:45.070307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD2503D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD250370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000182FD250070>]}


============================== 2022-07-10 03:14:50.608054 | 1b589a12-f9d7-4053-99dd-3e215b499e11 ==============================
03:14:50.608054 [info ] [MainThread]: Running with dbt=1.1.1
03:14:50.609054 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
03:14:50.609054 [debug] [MainThread]: Tracking: tracking
03:14:50.619054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A337610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A336FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A337220>]}
03:14:50.656054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
03:14:50.656054 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
03:14:50.660054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b589a12-f9d7-4053-99dd-3e215b499e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A476530>]}
03:14:50.664053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b589a12-f9d7-4053-99dd-3e215b499e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A4367D0>]}
03:14:50.665054 [info ] [MainThread]: Found 4 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
03:14:50.665054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b589a12-f9d7-4053-99dd-3e215b499e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A436860>]}
03:14:50.667054 [info ] [MainThread]: 
03:14:50.667054 [debug] [MainThread]: Acquiring new postgres connection "master"
03:14:50.668055 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
03:14:50.674054 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:14:50.674054 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
03:14:50.675054 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
03:14:50.676054 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:14:50.676054 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:14:50.676054 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
03:14:50.677055 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:14:51.267911 [debug] [ThreadPool]: SQL status: BEGIN in 0.59 seconds
03:14:51.267911 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
03:14:51.267911 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
03:14:51.270917 [debug] [ThreadPool]: SQL status: BEGIN in 0.59 seconds
03:14:51.270917 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
03:14:51.270917 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
03:14:51.340994 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
03:14:51.341995 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
03:14:51.342995 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.07 seconds
03:14:51.343995 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
03:14:51.411760 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
03:14:51.413211 [debug] [ThreadPool]: On list_portfolio_website_production: Close
03:14:51.415770 [debug] [MainThread]: Using postgres connection "master"
03:14:51.415770 [debug] [MainThread]: On master: BEGIN
03:14:51.415770 [debug] [MainThread]: Opening a new connection, currently in state init
03:14:52.022792 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
03:14:52.023793 [debug] [MainThread]: Using postgres connection "master"
03:14:52.023793 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
03:14:52.107912 [debug] [MainThread]: SQL status: SELECT 5 in 0.08 seconds
03:14:52.108918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b589a12-f9d7-4053-99dd-3e215b499e11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A436440>]}
03:14:52.108918 [debug] [MainThread]: On master: ROLLBACK
03:14:52.181028 [debug] [MainThread]: On master: Close
03:14:52.181028 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
03:14:52.182416 [info ] [MainThread]: 
03:14:52.186429 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
03:14:52.186429 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
03:14:52.186429 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
03:14:52.186429 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
03:14:52.186429 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
03:14:52.187429 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
03:14:52.187429 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
03:14:52.187429 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
03:14:52.187429 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
03:14:52.188428 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
03:14:52.188428 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
03:14:52.188428 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
03:14:52.190430 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
03:14:52.193428 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
03:14:52.195429 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
03:14:52.195429 [debug] [Thread-1 (]: finished collecting timing info
03:14:52.195429 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
03:14:52.196430 [debug] [Thread-2 (]: finished collecting timing info
03:14:52.196430 [debug] [Thread-1 (]: finished collecting timing info
03:14:52.196430 [debug] [Thread-3 (]: finished collecting timing info
03:14:52.196430 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
03:14:52.196430 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
03:14:52.197430 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
03:14:52.197430 [debug] [Thread-2 (]: finished collecting timing info
03:14:52.197430 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:14:52.197430 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:14:52.197430 [debug] [Thread-3 (]: finished collecting timing info
03:14:52.198428 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
03:14:52.198428 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
03:14:52.198428 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
03:14:52.199427 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
03:14:52.199427 [debug] [Thread-1 (]: Began running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:14:52.200428 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:14:52.200428 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:14:52.200428 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:14:52.200428 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:14:52.201427 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
03:14:52.201427 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
03:14:52.201427 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:14:52.201427 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:14:52.202430 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
03:14:52.202430 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:14:52.202430 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:14:52.210427 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
03:14:52.212427 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
03:14:52.212427 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:14:52.212427 [debug] [Thread-1 (]: Compiling test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:14:52.213427 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:14:52.213427 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:14:52.213427 [debug] [Thread-5 (]: finished collecting timing info
03:14:52.219428 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
03:14:52.219428 [debug] [Thread-4 (]: finished collecting timing info
03:14:52.222428 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
03:14:52.224427 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
03:14:52.224427 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:14:52.225428 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:14:52.225428 [debug] [Thread-1 (]: finished collecting timing info
03:14:52.225428 [debug] [Thread-5 (]: finished collecting timing info
03:14:52.226429 [debug] [Thread-2 (]: finished collecting timing info
03:14:52.226429 [debug] [Thread-4 (]: finished collecting timing info
03:14:52.226429 [debug] [Thread-3 (]: finished collecting timing info
03:14:52.226429 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:14:52.226429 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
03:14:52.227430 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:14:52.227430 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
03:14:52.227430 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:14:52.227430 [debug] [Thread-1 (]: finished collecting timing info
03:14:52.228428 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:14:52.228428 [debug] [Thread-2 (]: finished collecting timing info
03:14:52.228428 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:14:52.228428 [debug] [Thread-3 (]: finished collecting timing info
03:14:52.229430 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
03:14:52.229430 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
03:14:52.229430 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
03:14:52.230427 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
03:14:52.230427 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
03:14:52.230427 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:14:52.230427 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:14:52.231428 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:14:52.231428 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:14:52.231428 [debug] [Thread-3 (]: Began running node model.satellite_tracker.satellite_tracking
03:14:52.231428 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
03:14:52.232431 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:14:52.232431 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
03:14:52.232431 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:14:52.232431 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
03:14:52.233428 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:14:52.235428 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
03:14:52.235428 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:14:52.237427 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
03:14:52.237427 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.satellite_tracking
03:14:52.237427 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:14:52.237427 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:14:52.238428 [debug] [Thread-5 (]: finished collecting timing info
03:14:52.238428 [debug] [Thread-3 (]: Compiling model.satellite_tracker.satellite_tracking
03:14:52.240431 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
03:14:52.240431 [debug] [Thread-4 (]: finished collecting timing info
03:14:52.243427 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
03:14:52.243427 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:14:52.245427 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
03:14:52.246431 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:14:52.246431 [debug] [Thread-1 (]: finished collecting timing info
03:14:52.246431 [debug] [Thread-5 (]: finished collecting timing info
03:14:52.246431 [debug] [Thread-2 (]: finished collecting timing info
03:14:52.247429 [debug] [Thread-4 (]: finished collecting timing info
03:14:52.247429 [debug] [Thread-3 (]: finished collecting timing info
03:14:52.247429 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:14:52.247429 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
03:14:52.248429 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:14:52.248429 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
03:14:52.248429 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.satellite_tracking
03:14:52.248429 [debug] [Thread-1 (]: finished collecting timing info
03:14:52.249430 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:14:52.249430 [debug] [Thread-2 (]: finished collecting timing info
03:14:52.249430 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:14:52.249430 [debug] [Thread-3 (]: finished collecting timing info
03:14:52.250427 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
03:14:52.250427 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
03:14:52.250427 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
03:14:52.251427 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
03:14:52.251427 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.satellite_tracking
03:14:52.251427 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:14:52.251427 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:14:52.252427 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:14:52.252427 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:14:52.252427 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:14:52.252427 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
03:14:52.253431 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:14:52.253431 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
03:14:52.253431 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:14:52.253431 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
03:14:52.254427 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:14:52.255427 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
03:14:52.256427 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:14:52.258427 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
03:14:52.258427 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:14:52.258427 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:14:52.258427 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:14:52.259429 [debug] [Thread-5 (]: finished collecting timing info
03:14:52.259429 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:14:52.261431 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
03:14:52.261431 [debug] [Thread-4 (]: finished collecting timing info
03:14:52.263427 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
03:14:52.263427 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:14:52.265427 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
03:14:52.266431 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:14:52.266431 [debug] [Thread-1 (]: finished collecting timing info
03:14:52.266431 [debug] [Thread-5 (]: finished collecting timing info
03:14:52.266431 [debug] [Thread-2 (]: finished collecting timing info
03:14:52.267429 [debug] [Thread-4 (]: finished collecting timing info
03:14:52.267429 [debug] [Thread-3 (]: finished collecting timing info
03:14:52.267429 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:14:52.267429 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
03:14:52.268429 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:14:52.268429 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
03:14:52.268429 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:14:52.268429 [debug] [Thread-1 (]: finished collecting timing info
03:14:52.269429 [debug] [Thread-2 (]: finished collecting timing info
03:14:52.269429 [debug] [Thread-3 (]: finished collecting timing info
03:14:52.269429 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
03:14:52.270427 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
03:14:52.270427 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
03:14:52.271427 [debug] [MainThread]: Connection 'master' was properly closed.
03:14:52.272428 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
03:14:52.272428 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
03:14:52.272428 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11' was properly closed.
03:14:52.272428 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f' was properly closed.
03:14:52.272428 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9' was properly closed.
03:14:52.272428 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034' was properly closed.
03:14:52.273427 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3' was properly closed.
03:14:52.276427 [info ] [MainThread]: Done.
03:14:52.371427 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
03:14:52.371427 [info ] [MainThread]: Building catalog
03:14:52.373427 [debug] [ThreadPool]: Acquiring new postgres connection "portfolio_website.information_schema"
03:14:52.377427 [debug] [ThreadPool]: Using postgres connection "portfolio_website.information_schema"
03:14:52.377427 [debug] [ThreadPool]: On portfolio_website.information_schema: BEGIN
03:14:52.377427 [debug] [ThreadPool]: Opening a new connection, currently in state init
03:14:52.956273 [debug] [ThreadPool]: SQL status: BEGIN in 0.58 seconds
03:14:52.956273 [debug] [ThreadPool]: Using postgres connection "portfolio_website.information_schema"
03:14:52.956273 [debug] [ThreadPool]: On portfolio_website.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "portfolio_website.information_schema"} */

    
    

    select
        'portfolio_website' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('staging') or upper(sch.nspname) = upper('production'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
03:14:53.032582 [debug] [ThreadPool]: SQL status: SELECT 45 in 0.08 seconds
03:14:53.037323 [debug] [ThreadPool]: On portfolio_website.information_schema: ROLLBACK
03:14:53.105476 [debug] [ThreadPool]: On portfolio_website.information_schema: Close
03:14:53.111476 [info ] [MainThread]: Catalog written to C:\Users\Matt\source\satellite_tracker\satellite_tracker\dbt\target\catalog.json
03:14:53.112477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A337610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A336E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E92A59B610>]}
03:14:53.462747 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
03:14:53.462747 [debug] [MainThread]: Connection 'portfolio_website.information_schema' was properly closed.


============================== 2022-07-10 03:14:59.365779 | 27c4ae86-055d-4b2a-8917-912ccc06482e ==============================
03:14:59.365779 [info ] [MainThread]: Running with dbt=1.1.1
03:14:59.366779 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
03:14:59.366779 [debug] [MainThread]: Tracking: tracking
03:14:59.373779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F5A37280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F5A36FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F5A37250>]}
03:14:59.374780 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
03:14:59.375779 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
03:14:59.375779 [info ] [MainThread]: 
03:14:59.376782 [info ] [MainThread]: 
03:14:59.376782 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-07-10 07:59:43.667223 | 97080214-dc27-4ff9-8ea0-ff97c4345f75 ==============================
07:59:43.667223 [info ] [MainThread]: Running with dbt=1.1.1
07:59:43.668223 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:59:43.668223 [debug] [MainThread]: Tracking: tracking
07:59:43.678224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD6E1FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD6D6FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD6D7220>]}
07:59:43.690224 [info ] [MainThread]: Unable to do partial parsing because profile has changed
07:59:43.690224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD6E5A50>]}
07:59:43.714225 [debug] [MainThread]: Parsing macros\altitude_to_orbital_velocity_mph.sql
07:59:43.714225 [debug] [MainThread]: Parsing macros\generate_schema_name.sql
07:59:43.715224 [debug] [MainThread]: Parsing macros\adapters.sql
07:59:43.729223 [debug] [MainThread]: Parsing macros\catalog.sql
07:59:43.730224 [debug] [MainThread]: Parsing macros\relations.sql
07:59:43.731223 [debug] [MainThread]: Parsing macros\materializations\snapshot_merge.sql
07:59:43.733224 [debug] [MainThread]: Parsing macros\adapters\columns.sql
07:59:43.739224 [debug] [MainThread]: Parsing macros\adapters\freshness.sql
07:59:43.741223 [debug] [MainThread]: Parsing macros\adapters\indexes.sql
07:59:43.743223 [debug] [MainThread]: Parsing macros\adapters\metadata.sql
07:59:43.747223 [debug] [MainThread]: Parsing macros\adapters\persist_docs.sql
07:59:43.750224 [debug] [MainThread]: Parsing macros\adapters\relation.sql
07:59:43.756223 [debug] [MainThread]: Parsing macros\adapters\schema.sql
07:59:43.758223 [debug] [MainThread]: Parsing macros\etc\datetime.sql
07:59:43.762223 [debug] [MainThread]: Parsing macros\etc\statement.sql
07:59:43.766224 [debug] [MainThread]: Parsing macros\generic_test_sql\accepted_values.sql
07:59:43.767224 [debug] [MainThread]: Parsing macros\generic_test_sql\not_null.sql
07:59:43.767224 [debug] [MainThread]: Parsing macros\generic_test_sql\relationships.sql
07:59:43.768224 [debug] [MainThread]: Parsing macros\generic_test_sql\unique.sql
07:59:43.768224 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_alias.sql
07:59:43.770223 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_database.sql
07:59:43.771224 [debug] [MainThread]: Parsing macros\get_custom_name\get_custom_schema.sql
07:59:43.773224 [debug] [MainThread]: Parsing macros\materializations\configs.sql
07:59:43.774224 [debug] [MainThread]: Parsing macros\materializations\hooks.sql
07:59:43.777224 [debug] [MainThread]: Parsing macros\materializations\models\incremental\column_helpers.sql
07:59:43.780223 [debug] [MainThread]: Parsing macros\materializations\models\incremental\incremental.sql
07:59:43.786223 [debug] [MainThread]: Parsing macros\materializations\models\incremental\is_incremental.sql
07:59:43.787224 [debug] [MainThread]: Parsing macros\materializations\models\incremental\merge.sql
07:59:43.796223 [debug] [MainThread]: Parsing macros\materializations\models\incremental\on_schema_change.sql
07:59:43.804223 [debug] [MainThread]: Parsing macros\materializations\models\table\create_table_as.sql
07:59:43.806223 [debug] [MainThread]: Parsing macros\materializations\models\table\table.sql
07:59:43.810223 [debug] [MainThread]: Parsing macros\materializations\models\view\create_or_replace_view.sql
07:59:43.812223 [debug] [MainThread]: Parsing macros\materializations\models\view\create_view_as.sql
07:59:43.814224 [debug] [MainThread]: Parsing macros\materializations\models\view\helpers.sql
07:59:43.815224 [debug] [MainThread]: Parsing macros\materializations\models\view\view.sql
07:59:43.820223 [debug] [MainThread]: Parsing macros\materializations\seeds\helpers.sql
07:59:43.829223 [debug] [MainThread]: Parsing macros\materializations\seeds\seed.sql
07:59:43.833223 [debug] [MainThread]: Parsing macros\materializations\snapshots\helpers.sql
07:59:43.840227 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot.sql
07:59:43.846223 [debug] [MainThread]: Parsing macros\materializations\snapshots\snapshot_merge.sql
07:59:43.847223 [debug] [MainThread]: Parsing macros\materializations\snapshots\strategies.sql
07:59:43.857223 [debug] [MainThread]: Parsing macros\materializations\tests\helpers.sql
07:59:43.858225 [debug] [MainThread]: Parsing macros\materializations\tests\test.sql
07:59:43.861224 [debug] [MainThread]: Parsing macros\materializations\tests\where_subquery.sql
07:59:43.862224 [debug] [MainThread]: Parsing tests\generic\builtin.sql
07:59:43.964223 [debug] [MainThread]: 1699: static parser successfully parsed production\daily_satellite_stats.sql
07:59:43.971223 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
07:59:43.973223 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_satellite_detail_dm.sql
07:59:43.974225 [debug] [MainThread]: 1603: static parser failed on staging\stg_satellite_position_ft.sql
07:59:43.978224 [debug] [MainThread]: 1602: parser fallback to jinja rendering on staging\stg_satellite_position_ft.sql
07:59:43.979224 [debug] [MainThread]: 1699: static parser successfully parsed staging\stg_satellite_tle_ft.sql
07:59:44.030224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD736470>]}
07:59:44.034224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD6E0DC0>]}
07:59:44.034224 [info ] [MainThread]: Found 5 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
07:59:44.035224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD7C7190>]}
07:59:44.035224 [info ] [MainThread]: 
07:59:44.036224 [debug] [MainThread]: Acquiring new postgres connection "master"
07:59:44.037223 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
07:59:44.042223 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
07:59:44.043224 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
07:59:44.044225 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
07:59:44.044225 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
07:59:44.045224 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
07:59:44.045224 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:59:44.045224 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:59:44.652905 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
07:59:44.654917 [debug] [ThreadPool]: On list_portfolio_website: Close
07:59:44.703476 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.66 seconds
07:59:44.704476 [debug] [ThreadPool]: On list_portfolio_website: Close
07:59:44.705476 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
07:59:44.708476 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
07:59:44.709476 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
07:59:44.709476 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
07:59:44.710476 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
07:59:44.710476 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:59:44.710476 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
07:59:44.711476 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:59:45.297205 [debug] [ThreadPool]: SQL status: BEGIN in 0.59 seconds
07:59:45.297205 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
07:59:45.298211 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
07:59:45.334316 [debug] [ThreadPool]: SQL status: BEGIN in 0.62 seconds
07:59:45.334316 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
07:59:45.335317 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
07:59:45.370859 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.07 seconds
07:59:45.371859 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
07:59:45.408890 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
07:59:45.408890 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
07:59:45.443675 [debug] [ThreadPool]: On list_portfolio_website_production: Close
07:59:45.482136 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
07:59:45.485139 [debug] [MainThread]: Using postgres connection "master"
07:59:45.485139 [debug] [MainThread]: On master: BEGIN
07:59:45.486138 [debug] [MainThread]: Opening a new connection, currently in state init
07:59:46.077416 [debug] [MainThread]: SQL status: BEGIN in 0.59 seconds
07:59:46.077416 [debug] [MainThread]: Using postgres connection "master"
07:59:46.078416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
07:59:46.157627 [debug] [MainThread]: SQL status: SELECT 5 in 0.08 seconds
07:59:46.158627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD72BBE0>]}
07:59:46.158627 [debug] [MainThread]: On master: ROLLBACK
07:59:46.229686 [debug] [MainThread]: Using postgres connection "master"
07:59:46.229955 [debug] [MainThread]: On master: BEGIN
07:59:46.373606 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
07:59:46.373606 [debug] [MainThread]: On master: COMMIT
07:59:46.373606 [debug] [MainThread]: Using postgres connection "master"
07:59:46.373606 [debug] [MainThread]: On master: COMMIT
07:59:46.445575 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
07:59:46.445575 [debug] [MainThread]: On master: Close
07:59:46.445575 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
07:59:46.446575 [info ] [MainThread]: 
07:59:46.450562 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
07:59:46.450562 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
07:59:46.451563 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
07:59:46.451563 [info ] [Thread-1 (]: 1 of 5 START view model staging.stg_satellite_detail_dm ........................ [RUN]
07:59:46.451563 [info ] [Thread-2 (]: 2 of 5 START view model staging.stg_satellite_position_ft ...................... [RUN]
07:59:46.452562 [info ] [Thread-3 (]: 3 of 5 START view model staging.stg_satellite_tle_ft ........................... [RUN]
07:59:46.452562 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
07:59:46.453563 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
07:59:46.453563 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
07:59:46.453563 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
07:59:46.453563 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
07:59:46.454562 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
07:59:46.454562 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
07:59:46.454562 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
07:59:46.454562 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
07:59:46.456562 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
07:59:46.459563 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
07:59:46.461563 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
07:59:46.461563 [debug] [Thread-1 (]: finished collecting timing info
07:59:46.462563 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
07:59:46.462563 [debug] [Thread-2 (]: finished collecting timing info
07:59:46.475563 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
07:59:46.476562 [debug] [Thread-3 (]: finished collecting timing info
07:59:46.476562 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
07:59:46.476562 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
07:59:46.478563 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
07:59:46.478563 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
07:59:46.479564 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
07:59:46.480562 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
07:59:46.480562 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
07:59:46.480562 [debug] [Thread-1 (]: Opening a new connection, currently in state init
07:59:46.480562 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
07:59:46.481563 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
07:59:46.481563 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
07:59:46.481563 [debug] [Thread-2 (]: Opening a new connection, currently in state init
07:59:46.482562 [debug] [Thread-3 (]: Opening a new connection, currently in state init
07:59:47.054735 [debug] [Thread-2 (]: SQL status: BEGIN in 0.57 seconds
07:59:47.054735 [debug] [Thread-3 (]: SQL status: BEGIN in 0.57 seconds
07:59:47.054735 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
07:59:47.054735 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
07:59:47.055747 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
07:59:47.055747 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
07:59:47.113030 [debug] [Thread-1 (]: SQL status: BEGIN in 0.63 seconds
07:59:47.113323 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
07:59:47.113323 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
07:59:47.131059 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.08 seconds
07:59:47.135060 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
07:59:47.135060 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.08 seconds
07:59:47.135060 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
07:59:47.137060 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
07:59:47.137060 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
07:59:47.196232 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.08 seconds
07:59:47.197455 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
07:59:47.197455 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
07:59:47.206803 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
07:59:47.208802 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
07:59:47.208802 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
07:59:47.209802 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
07:59:47.211790 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
07:59:47.211790 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
07:59:47.277392 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.08 seconds
07:59:47.278401 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
07:59:47.278401 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
07:59:47.278401 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
07:59:47.282398 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
07:59:47.283399 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
07:59:47.283399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
07:59:47.283399 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
07:59:47.284398 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
07:59:47.284398 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
07:59:47.284398 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
07:59:47.356149 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
07:59:47.356149 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
07:59:47.359150 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
07:59:47.359150 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.08 seconds
07:59:47.360150 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
07:59:47.360150 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
07:59:47.361150 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
07:59:47.361150 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
07:59:47.362150 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
07:59:47.362150 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
07:59:47.434800 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
07:59:47.435800 [debug] [Thread-3 (]: finished collecting timing info
07:59:47.435800 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
07:59:47.435800 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD72B2E0>]}
07:59:47.435800 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
07:59:47.436800 [info ] [Thread-3 (]: 3 of 5 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 0.98s]
07:59:47.436800 [debug] [Thread-2 (]: finished collecting timing info
07:59:47.437800 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
07:59:47.437800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD7B51B0>]}
07:59:47.437800 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
07:59:47.438800 [info ] [Thread-2 (]: 2 of 5 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 0.98s]
07:59:47.438800 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
07:59:47.438800 [debug] [Thread-1 (]: SQL status: COMMIT in 0.08 seconds
07:59:47.439800 [debug] [Thread-5 (]: Began running node model.satellite_tracker.daily_satellite_stats
07:59:47.439800 [debug] [Thread-4 (]: Began running node model.satellite_tracker.satellite_tracking
07:59:47.440800 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
07:59:47.440800 [info ] [Thread-5 (]: 4 of 5 START view model production.daily_satellite_stats ....................... [RUN]
07:59:47.440800 [info ] [Thread-4 (]: 5 of 5 START view model production.satellite_tracking .......................... [RUN]
07:59:47.441800 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
07:59:47.441800 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
07:59:47.442800 [debug] [Thread-4 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
07:59:47.442800 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
07:59:47.442800 [debug] [Thread-4 (]: Began compiling node model.satellite_tracker.satellite_tracking
07:59:47.443799 [debug] [Thread-5 (]: Compiling model.satellite_tracker.daily_satellite_stats
07:59:47.443799 [debug] [Thread-4 (]: Compiling model.satellite_tracker.satellite_tracking
07:59:47.444800 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
07:59:47.446800 [debug] [Thread-4 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
07:59:47.447800 [debug] [Thread-5 (]: finished collecting timing info
07:59:47.447800 [debug] [Thread-4 (]: finished collecting timing info
07:59:47.448801 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.daily_satellite_stats
07:59:47.448801 [debug] [Thread-4 (]: Began executing node model.satellite_tracker.satellite_tracking
07:59:47.449800 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.daily_satellite_stats"
07:59:47.450802 [debug] [Thread-4 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
07:59:47.451800 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
07:59:47.451800 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
07:59:47.451800 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: BEGIN
07:59:47.452801 [debug] [Thread-4 (]: On model.satellite_tracker.satellite_tracking: BEGIN
07:59:47.452801 [debug] [Thread-5 (]: Opening a new connection, currently in state init
07:59:47.452801 [debug] [Thread-4 (]: Opening a new connection, currently in state init
07:59:47.520816 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.08 seconds
07:59:47.522817 [debug] [Thread-1 (]: finished collecting timing info
07:59:47.522817 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
07:59:47.522817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD909300>]}
07:59:47.523817 [info ] [Thread-1 (]: 1 of 5 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.07s]
07:59:47.523817 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
07:59:48.022293 [debug] [Thread-4 (]: SQL status: BEGIN in 0.57 seconds
07:59:48.022293 [debug] [Thread-5 (]: SQL status: BEGIN in 0.57 seconds
07:59:48.023291 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
07:59:48.023291 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
07:59:48.023291 [debug] [Thread-4 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    WHERE satellite_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
07:59:48.023291 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */

  create view "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" as (
    -- Set configuration settings


WITH daily_satellite_stats AS (
    SELECT
        DATE_TRUNC('day', timestamp) AS day,
        id AS satellite_id,
        AVG(velocity_mph) AS average_velocity,
        AVG(altitude) AS average_altitude
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    GROUP BY id, DATE_TRUNC('day', timestamp)
)

SELECT
    *
FROM daily_satellite_stats
  );
07:59:48.097349 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.07 seconds
07:59:48.099350 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
07:59:48.099350 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
alter table "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" rename to "daily_satellite_stats"
07:59:48.100350 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.08 seconds
07:59:48.101350 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
07:59:48.101350 [debug] [Thread-4 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
07:59:48.171147 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
07:59:48.172154 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
07:59:48.172154 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
07:59:48.172154 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
07:59:48.172154 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.07 seconds
07:59:48.173156 [debug] [Thread-4 (]: On model.satellite_tracker.satellite_tracking: COMMIT
07:59:48.173156 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
07:59:48.173156 [debug] [Thread-4 (]: On model.satellite_tracker.satellite_tracking: COMMIT
07:59:48.243648 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
07:59:48.243648 [debug] [Thread-4 (]: SQL status: COMMIT in 0.07 seconds
07:59:48.244672 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
07:59:48.246671 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
07:59:48.246671 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
drop view if exists "portfolio_website"."production"."daily_satellite_stats__dbt_backup" cascade
07:59:48.246671 [debug] [Thread-4 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
07:59:48.317189 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
07:59:48.317189 [debug] [Thread-5 (]: finished collecting timing info
07:59:48.318200 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: Close
07:59:48.318200 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.07 seconds
07:59:48.318200 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDDAF6950>]}
07:59:48.319200 [debug] [Thread-4 (]: finished collecting timing info
07:59:48.319200 [info ] [Thread-5 (]: 4 of 5 OK created view model production.daily_satellite_stats .................. [[32mCREATE VIEW[0m in 0.88s]
07:59:48.319200 [debug] [Thread-4 (]: On model.satellite_tracker.satellite_tracking: Close
07:59:48.320200 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '97080214-dc27-4ff9-8ea0-ff97c4345f75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDDAF6BC0>]}
07:59:48.320200 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.daily_satellite_stats
07:59:48.321206 [info ] [Thread-4 (]: 5 of 5 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.88s]
07:59:48.321206 [debug] [Thread-4 (]: Finished running node model.satellite_tracker.satellite_tracking
07:59:48.322199 [debug] [MainThread]: Acquiring new postgres connection "master"
07:59:48.323201 [debug] [MainThread]: Using postgres connection "master"
07:59:48.323201 [debug] [MainThread]: On master: BEGIN
07:59:48.323201 [debug] [MainThread]: Opening a new connection, currently in state closed
07:59:48.922952 [debug] [MainThread]: SQL status: BEGIN in 0.6 seconds
07:59:48.922952 [debug] [MainThread]: On master: COMMIT
07:59:48.922952 [debug] [MainThread]: Using postgres connection "master"
07:59:48.923952 [debug] [MainThread]: On master: COMMIT
07:59:48.995624 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
07:59:48.995624 [debug] [MainThread]: On master: Close
07:59:48.995624 [info ] [MainThread]: 
07:59:48.996648 [info ] [MainThread]: Finished running 5 view models in 4.96s.
07:59:48.996648 [debug] [MainThread]: Connection 'master' was properly closed.
07:59:48.996648 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
07:59:48.997639 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
07:59:48.997639 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
07:59:48.997639 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
07:59:48.997639 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
07:59:48.997639 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
07:59:48.998646 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
07:59:48.998646 [debug] [MainThread]: Connection 'model.satellite_tracker.daily_satellite_stats' was properly closed.
07:59:48.998646 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
07:59:49.002636 [info ] [MainThread]: 
07:59:49.003637 [info ] [MainThread]: [32mCompleted successfully[0m
07:59:49.003637 [info ] [MainThread]: 
07:59:49.004635 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
07:59:49.004635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD826B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD755C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023BDD7572B0>]}


============================== 2022-07-10 08:00:42.673575 | b725e5d9-636f-4c8b-bf6c-10738845b9fd ==============================
08:00:42.673575 [info ] [MainThread]: Running with dbt=1.1.1
08:00:42.673575 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:00:42.673575 [debug] [MainThread]: Tracking: tracking
08:00:42.682577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126217A7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126217A6FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126217A7220>]}
08:00:42.718576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
08:00:42.718576 [debug] [MainThread]: Partial parsing: added file: satellite_tracker://models\staging\testing.sql
08:00:42.725578 [debug] [MainThread]: 1699: static parser successfully parsed staging\testing.sql
08:00:42.737578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126219315A0>]}
08:00:42.742579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126218C2920>]}
08:00:42.743578 [info ] [MainThread]: Found 6 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:00:42.743578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126218C3FA0>]}
08:00:42.744577 [info ] [MainThread]: 
08:00:42.745575 [debug] [MainThread]: Acquiring new postgres connection "master"
08:00:42.746576 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:00:42.746576 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:00:42.752578 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:00:42.753576 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:00:42.754574 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:00:42.754574 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:00:42.754574 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:00:42.754574 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:00:43.391917 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.64 seconds
08:00:43.391917 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.64 seconds
08:00:43.392917 [debug] [ThreadPool]: On list_portfolio_website: Close
08:00:43.393917 [debug] [ThreadPool]: On list_portfolio_website: Close
08:00:43.394917 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
08:00:43.395917 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
08:00:43.398917 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:00:43.400917 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:00:43.400917 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
08:00:43.400917 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
08:00:43.400917 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:00:43.401917 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:00:43.985971 [debug] [ThreadPool]: SQL status: BEGIN in 0.59 seconds
08:00:43.986972 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:00:43.986972 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
08:00:44.021585 [debug] [ThreadPool]: SQL status: BEGIN in 0.62 seconds
08:00:44.021585 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:00:44.022008 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
08:00:44.068974 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.08 seconds
08:00:44.069974 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
08:00:44.103031 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.08 seconds
08:00:44.104037 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
08:00:44.142397 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
08:00:44.181033 [debug] [ThreadPool]: On list_portfolio_website_production: Close
08:00:44.184034 [debug] [MainThread]: Using postgres connection "master"
08:00:44.184034 [debug] [MainThread]: On master: BEGIN
08:00:44.185033 [debug] [MainThread]: Opening a new connection, currently in state init
08:00:44.790897 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
08:00:44.790897 [debug] [MainThread]: Using postgres connection "master"
08:00:44.790897 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:00:44.875234 [debug] [MainThread]: SQL status: SELECT 6 in 0.08 seconds
08:00:44.876235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126218C1D50>]}
08:00:44.877235 [debug] [MainThread]: On master: ROLLBACK
08:00:44.949981 [debug] [MainThread]: Using postgres connection "master"
08:00:44.950981 [debug] [MainThread]: On master: BEGIN
08:00:45.097467 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
08:00:45.097713 [debug] [MainThread]: On master: COMMIT
08:00:45.097713 [debug] [MainThread]: Using postgres connection "master"
08:00:45.097713 [debug] [MainThread]: On master: COMMIT
08:00:45.170929 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:00:45.170929 [debug] [MainThread]: On master: Close
08:00:45.170929 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
08:00:45.171931 [info ] [MainThread]: 
08:00:45.175929 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
08:00:45.175929 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
08:00:45.176930 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
08:00:45.176930 [debug] [Thread-4 (]: Began running node model.satellite_tracker.testing
08:00:45.176930 [info ] [Thread-1 (]: 1 of 6 START view model staging.stg_satellite_detail_dm ........................ [RUN]
08:00:45.176930 [info ] [Thread-2 (]: 2 of 6 START view model staging.stg_satellite_position_ft ...................... [RUN]
08:00:45.177930 [info ] [Thread-3 (]: 3 of 6 START view model staging.stg_satellite_tle_ft ........................... [RUN]
08:00:45.177930 [info ] [Thread-4 (]: 4 of 6 START view model staging.testing ........................................ [RUN]
08:00:45.178930 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:00:45.178930 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:00:45.179930 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:00:45.179930 [debug] [Thread-4 (]: Acquiring new postgres connection "model.satellite_tracker.testing"
08:00:45.179930 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
08:00:45.179930 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
08:00:45.180929 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
08:00:45.180929 [debug] [Thread-4 (]: Began compiling node model.satellite_tracker.testing
08:00:45.180929 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
08:00:45.180929 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
08:00:45.180929 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
08:00:45.181930 [debug] [Thread-4 (]: Compiling model.satellite_tracker.testing
08:00:45.183933 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:00:45.186930 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:00:45.188930 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:00:45.189930 [debug] [Thread-4 (]: Writing injected SQL for node "model.satellite_tracker.testing"
08:00:45.190932 [debug] [Thread-1 (]: finished collecting timing info
08:00:45.190932 [debug] [Thread-2 (]: finished collecting timing info
08:00:45.191930 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
08:00:45.191930 [debug] [Thread-3 (]: finished collecting timing info
08:00:45.191930 [debug] [Thread-4 (]: finished collecting timing info
08:00:45.191930 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
08:00:45.206930 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:00:45.206930 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
08:00:45.207930 [debug] [Thread-4 (]: Began executing node model.satellite_tracker.testing
08:00:45.208931 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:00:45.210931 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:00:45.211931 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:00:45.212931 [debug] [Thread-4 (]: Writing runtime SQL for node "model.satellite_tracker.testing"
08:00:45.213930 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
08:00:45.213930 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:00:45.213930 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:00:45.213930 [debug] [Thread-1 (]: Opening a new connection, currently in state init
08:00:45.213930 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:00:45.214930 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
08:00:45.214930 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
08:00:45.214930 [debug] [Thread-4 (]: On model.satellite_tracker.testing: BEGIN
08:00:45.215931 [debug] [Thread-2 (]: Opening a new connection, currently in state init
08:00:45.215931 [debug] [Thread-3 (]: Opening a new connection, currently in state init
08:00:45.215931 [debug] [Thread-4 (]: Opening a new connection, currently in state init
08:00:45.796617 [debug] [Thread-3 (]: SQL status: BEGIN in 0.58 seconds
08:00:45.796617 [debug] [Thread-2 (]: SQL status: BEGIN in 0.58 seconds
08:00:45.796617 [debug] [Thread-4 (]: SQL status: BEGIN in 0.58 seconds
08:00:45.796617 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:00:45.797597 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:00:45.797597 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:00:45.797597 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
08:00:45.797597 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
08:00:45.798604 [debug] [Thread-4 (]: On model.satellite_tracker.testing: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.testing"} */

  create view "portfolio_website"."staging"."testing__dbt_tmp" as (
    -- Set configuration settings


SELECT
    1
  );
08:00:45.809604 [debug] [Thread-1 (]: SQL status: BEGIN in 0.6 seconds
08:00:45.809604 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:00:45.809604 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
08:00:45.883686 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.09 seconds
08:00:45.883686 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.09 seconds
08:00:45.883686 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.09 seconds
08:00:45.887686 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:00:45.887686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.08 seconds
08:00:45.888686 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:00:45.889685 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:00:45.890688 [debug] [Thread-4 (]: On model.satellite_tracker.testing: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.testing"} */
alter table "portfolio_website"."staging"."testing__dbt_tmp" rename to "testing"
08:00:45.891688 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:00:45.891688 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
08:00:45.892687 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
08:00:45.892687 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
08:00:45.966448 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.07 seconds
08:00:45.970192 [debug] [Thread-4 (]: On model.satellite_tracker.testing: COMMIT
08:00:45.970192 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.08 seconds
08:00:45.971193 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.08 seconds
08:00:45.971193 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:00:45.972193 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:00:45.973194 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.08 seconds
08:00:45.974192 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:00:45.974192 [debug] [Thread-4 (]: On model.satellite_tracker.testing: COMMIT
08:00:45.974192 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
08:00:45.976192 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:00:45.976192 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
08:00:45.976192 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
08:00:46.047739 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:00:46.047739 [debug] [Thread-4 (]: SQL status: COMMIT in 0.07 seconds
08:00:46.047739 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:00:46.048751 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:00:46.052750 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:00:46.052750 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.08 seconds
08:00:46.053750 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:00:46.053750 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:00:46.053750 [debug] [Thread-4 (]: On model.satellite_tracker.testing: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.testing"} */
drop view if exists "portfolio_website"."staging"."testing__dbt_backup" cascade
08:00:46.054750 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:00:46.054750 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:00:46.054750 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:00:46.055753 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:00:46.055753 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:00:46.055753 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:00:46.126986 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:00:46.126986 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:00:46.126986 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
08:00:46.126986 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.07 seconds
08:00:46.127986 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:00:46.129985 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:00:46.130986 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:00:46.131985 [debug] [Thread-4 (]: finished collecting timing info
08:00:46.132986 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
08:00:46.132986 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
08:00:46.132986 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
08:00:46.132986 [debug] [Thread-4 (]: On model.satellite_tracker.testing: Close
08:00:46.133985 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012621A437F0>]}
08:00:46.134985 [info ] [Thread-4 (]: 4 of 6 OK created view model staging.testing ................................... [[32mCREATE VIEW[0m in 0.95s]
08:00:46.135986 [debug] [Thread-4 (]: Finished running node model.satellite_tracker.testing
08:00:46.204620 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:00:46.205619 [debug] [Thread-2 (]: finished collecting timing info
08:00:46.205619 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
08:00:46.206619 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012621A5B730>]}
08:00:46.206619 [info ] [Thread-2 (]: 2 of 6 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 1.03s]
08:00:46.207620 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
08:00:46.207620 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:00:46.208620 [debug] [Thread-3 (]: finished collecting timing info
08:00:46.208620 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
08:00:46.209623 [debug] [Thread-1 (]: finished collecting timing info
08:00:46.209623 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
08:00:46.209623 [debug] [Thread-5 (]: Began running node model.satellite_tracker.daily_satellite_stats
08:00:46.210621 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
08:00:46.210621 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012621A5B8B0>]}
08:00:46.210621 [info ] [Thread-5 (]: 5 of 6 START view model production.daily_satellite_stats ....................... [RUN]
08:00:46.211621 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126217B5A80>]}
08:00:46.211621 [info ] [Thread-3 (]: 3 of 6 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.03s]
08:00:46.212620 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
08:00:46.212620 [info ] [Thread-1 (]: 1 of 6 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.03s]
08:00:46.212620 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
08:00:46.213622 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
08:00:46.213622 [debug] [Thread-5 (]: Compiling model.satellite_tracker.daily_satellite_stats
08:00:46.213622 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
08:00:46.214619 [debug] [Thread-2 (]: Began running node model.satellite_tracker.satellite_tracking
08:00:46.215619 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
08:00:46.216622 [info ] [Thread-2 (]: 6 of 6 START view model production.satellite_tracking .......................... [RUN]
08:00:46.217620 [debug] [Thread-5 (]: finished collecting timing info
08:00:46.217620 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
08:00:46.217620 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.daily_satellite_stats
08:00:46.217620 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.satellite_tracking
08:00:46.219620 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.daily_satellite_stats"
08:00:46.219620 [debug] [Thread-2 (]: Compiling model.satellite_tracker.satellite_tracking
08:00:46.221619 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
08:00:46.222620 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:00:46.222620 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: BEGIN
08:00:46.222620 [debug] [Thread-5 (]: Opening a new connection, currently in state init
08:00:46.222620 [debug] [Thread-2 (]: finished collecting timing info
08:00:46.223622 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.satellite_tracking
08:00:46.224620 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
08:00:46.224620 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:00:46.225621 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: BEGIN
08:00:46.225621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
08:00:46.811431 [debug] [Thread-2 (]: SQL status: BEGIN in 0.59 seconds
08:00:46.811431 [debug] [Thread-5 (]: SQL status: BEGIN in 0.59 seconds
08:00:46.811431 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:00:46.812433 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:00:46.812433 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    WHERE satellite_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
08:00:46.812433 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */

  create view "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" as (
    -- Set configuration settings


WITH daily_satellite_stats AS (
    SELECT
        DATE_TRUNC('day', timestamp) AS day,
        id AS satellite_id,
        AVG(velocity_mph) AS average_velocity,
        AVG(altitude) AS average_altitude
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    GROUP BY id, DATE_TRUNC('day', timestamp)
)

SELECT
    *
FROM daily_satellite_stats
  );
08:00:46.886996 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.07 seconds
08:00:46.886996 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.07 seconds
08:00:46.888998 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:00:46.890996 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:00:46.890996 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
alter table "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" rename to "daily_satellite_stats"
08:00:46.891998 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
08:00:46.963471 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:00:46.963471 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
08:00:46.964471 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:00:46.965469 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:00:46.965469 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:00:46.966460 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:00:46.966460 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:00:46.966460 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:00:47.038308 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
08:00:47.038308 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:00:47.039311 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:00:47.040320 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:00:47.041094 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
drop view if exists "portfolio_website"."production"."daily_satellite_stats__dbt_backup" cascade
08:00:47.041094 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
08:00:47.113300 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:00:47.113300 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
08:00:47.114300 [debug] [Thread-2 (]: finished collecting timing info
08:00:47.115300 [debug] [Thread-5 (]: finished collecting timing info
08:00:47.115300 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: Close
08:00:47.115300 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: Close
08:00:47.116289 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001262196F2E0>]}
08:00:47.116289 [info ] [Thread-2 (]: 6 of 6 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.90s]
08:00:47.116289 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b725e5d9-636f-4c8b-bf6c-10738845b9fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126218BAE60>]}
08:00:47.117288 [info ] [Thread-5 (]: 5 of 6 OK created view model production.daily_satellite_stats .................. [[32mCREATE VIEW[0m in 0.90s]
08:00:47.117288 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.satellite_tracking
08:00:47.118290 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.daily_satellite_stats
08:00:47.119288 [debug] [MainThread]: Acquiring new postgres connection "master"
08:00:47.119288 [debug] [MainThread]: Using postgres connection "master"
08:00:47.119288 [debug] [MainThread]: On master: BEGIN
08:00:47.120288 [debug] [MainThread]: Opening a new connection, currently in state closed
08:00:47.699071 [debug] [MainThread]: SQL status: BEGIN in 0.58 seconds
08:00:47.699071 [debug] [MainThread]: On master: COMMIT
08:00:47.699071 [debug] [MainThread]: Using postgres connection "master"
08:00:47.699071 [debug] [MainThread]: On master: COMMIT
08:00:47.771106 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:00:47.771106 [debug] [MainThread]: On master: Close
08:00:47.771106 [info ] [MainThread]: 
08:00:47.772098 [info ] [MainThread]: Finished running 6 view models in 5.03s.
08:00:47.772098 [debug] [MainThread]: Connection 'master' was properly closed.
08:00:47.772098 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:00:47.772098 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:00:47.773107 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
08:00:47.773107 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
08:00:47.773107 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
08:00:47.773107 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
08:00:47.773107 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
08:00:47.774107 [debug] [MainThread]: Connection 'model.satellite_tracker.testing' was properly closed.
08:00:47.774107 [debug] [MainThread]: Connection 'model.satellite_tracker.daily_satellite_stats' was properly closed.
08:00:47.778109 [info ] [MainThread]: 
08:00:47.778109 [info ] [MainThread]: [32mCompleted successfully[0m
08:00:47.779107 [info ] [MainThread]: 
08:00:47.779107 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
08:00:47.780106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126218C21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126218C2260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000126218BB580>]}


============================== 2022-07-10 08:01:43.499525 | 7720c31a-cbb2-4cf0-8976-c4de1af7c461 ==============================
08:01:43.499525 [info ] [MainThread]: Running with dbt=1.1.1
08:01:43.499525 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:01:43.499525 [debug] [MainThread]: Tracking: tracking
08:01:43.507525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6CA01F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6C96FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6C97520>]}
08:01:43.546525 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
08:01:43.547525 [debug] [MainThread]: Partial parsing: added file: satellite_tracker://models\production\testing.sql
08:01:43.547525 [debug] [MainThread]: Partial parsing: deleted file: satellite_tracker://models\staging\testing.sql
08:01:43.554525 [debug] [MainThread]: 1699: static parser successfully parsed production\testing.sql
08:01:43.567524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6E058A0>]}
08:01:43.573526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6DBBCA0>]}
08:01:43.573526 [info ] [MainThread]: Found 6 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:01:43.573526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6CA01F0>]}
08:01:43.575524 [info ] [MainThread]: 
08:01:43.575524 [debug] [MainThread]: Acquiring new postgres connection "master"
08:01:43.576525 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:01:43.576525 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:01:43.582525 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:01:43.583525 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:01:43.583525 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:01:43.584525 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:01:43.584525 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:01:43.584525 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:01:44.195790 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
08:01:44.195790 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
08:01:44.196790 [debug] [ThreadPool]: On list_portfolio_website: Close
08:01:44.197790 [debug] [ThreadPool]: On list_portfolio_website: Close
08:01:44.199790 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
08:01:44.199790 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
08:01:44.203792 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:01:44.204790 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:01:44.204790 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
08:01:44.205792 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
08:01:44.205792 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:01:44.205792 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:01:44.778950 [debug] [ThreadPool]: SQL status: BEGIN in 0.57 seconds
08:01:44.779951 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:01:44.779951 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
08:01:44.818051 [debug] [ThreadPool]: SQL status: BEGIN in 0.61 seconds
08:01:44.818051 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:01:44.819052 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
08:01:44.851534 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.07 seconds
08:01:44.852054 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
08:01:44.902019 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.08 seconds
08:01:44.903019 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
08:01:44.920074 [debug] [ThreadPool]: On list_portfolio_website_production: Close
08:01:44.982139 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
08:01:44.985141 [debug] [MainThread]: Using postgres connection "master"
08:01:44.986141 [debug] [MainThread]: On master: BEGIN
08:01:44.986141 [debug] [MainThread]: Opening a new connection, currently in state init
08:01:45.627293 [debug] [MainThread]: SQL status: BEGIN in 0.64 seconds
08:01:45.627293 [debug] [MainThread]: Using postgres connection "master"
08:01:45.627293 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:01:45.716033 [debug] [MainThread]: SQL status: SELECT 6 in 0.09 seconds
08:01:45.717034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6E04520>]}
08:01:45.718034 [debug] [MainThread]: On master: ROLLBACK
08:01:45.795116 [debug] [MainThread]: Using postgres connection "master"
08:01:45.795116 [debug] [MainThread]: On master: BEGIN
08:01:45.949225 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
08:01:45.950220 [debug] [MainThread]: On master: COMMIT
08:01:45.950220 [debug] [MainThread]: Using postgres connection "master"
08:01:45.950220 [debug] [MainThread]: On master: COMMIT
08:01:46.026600 [debug] [MainThread]: SQL status: COMMIT in 0.08 seconds
08:01:46.027622 [debug] [MainThread]: On master: Close
08:01:46.027622 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
08:01:46.027622 [info ] [MainThread]: 
08:01:46.032611 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
08:01:46.032611 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
08:01:46.032611 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
08:01:46.032611 [debug] [Thread-4 (]: Began running node model.satellite_tracker.testing
08:01:46.033613 [info ] [Thread-1 (]: 1 of 6 START view model staging.stg_satellite_detail_dm ........................ [RUN]
08:01:46.033613 [info ] [Thread-2 (]: 2 of 6 START view model staging.stg_satellite_position_ft ...................... [RUN]
08:01:46.033613 [info ] [Thread-3 (]: 3 of 6 START view model staging.stg_satellite_tle_ft ........................... [RUN]
08:01:46.034611 [info ] [Thread-4 (]: 4 of 6 START view model production.testing ..................................... [RUN]
08:01:46.034611 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.035612 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.035612 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.035612 [debug] [Thread-4 (]: Acquiring new postgres connection "model.satellite_tracker.testing"
08:01:46.036613 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
08:01:46.036613 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
08:01:46.036613 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
08:01:46.036613 [debug] [Thread-4 (]: Began compiling node model.satellite_tracker.testing
08:01:46.037612 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
08:01:46.037612 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
08:01:46.037612 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
08:01:46.037612 [debug] [Thread-4 (]: Compiling model.satellite_tracker.testing
08:01:46.039611 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.043612 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.044611 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.046611 [debug] [Thread-4 (]: Writing injected SQL for node "model.satellite_tracker.testing"
08:01:46.046611 [debug] [Thread-1 (]: finished collecting timing info
08:01:46.047611 [debug] [Thread-2 (]: finished collecting timing info
08:01:46.047611 [debug] [Thread-3 (]: finished collecting timing info
08:01:46.047611 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
08:01:46.047611 [debug] [Thread-4 (]: finished collecting timing info
08:01:46.048611 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
08:01:46.048611 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
08:01:46.063611 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.063611 [debug] [Thread-4 (]: Began executing node model.satellite_tracker.testing
08:01:46.065610 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.066611 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.068611 [debug] [Thread-4 (]: Writing runtime SQL for node "model.satellite_tracker.testing"
08:01:46.068611 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.068611 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.069611 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
08:01:46.069611 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.069611 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
08:01:46.069611 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:01:46.069611 [debug] [Thread-1 (]: Opening a new connection, currently in state init
08:01:46.069611 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
08:01:46.070611 [debug] [Thread-2 (]: Opening a new connection, currently in state init
08:01:46.070611 [debug] [Thread-4 (]: On model.satellite_tracker.testing: BEGIN
08:01:46.070611 [debug] [Thread-3 (]: Opening a new connection, currently in state init
08:01:46.071611 [debug] [Thread-4 (]: Opening a new connection, currently in state init
08:01:46.635420 [debug] [Thread-2 (]: SQL status: BEGIN in 0.56 seconds
08:01:46.635420 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.635420 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
08:01:46.652664 [debug] [Thread-4 (]: SQL status: BEGIN in 0.58 seconds
08:01:46.652664 [debug] [Thread-3 (]: SQL status: BEGIN in 0.58 seconds
08:01:46.653664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.58 seconds
08:01:46.653664 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:01:46.653664 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.653664 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.654666 [debug] [Thread-4 (]: On model.satellite_tracker.testing: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.testing"} */

  create view "portfolio_website"."production"."testing__dbt_tmp" as (
    -- Set configuration settings


SELECT
    1
  );
08:01:46.654666 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
08:01:46.654666 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
08:01:46.708229 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.07 seconds
08:01:46.712219 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.712219 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
08:01:46.729219 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.07 seconds
08:01:46.729219 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.07 seconds
08:01:46.731219 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:01:46.731219 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.08 seconds
08:01:46.732219 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.732219 [debug] [Thread-4 (]: On model.satellite_tracker.testing: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.testing"} */
alter table "portfolio_website"."production"."testing__dbt_tmp" rename to "testing"
08:01:46.734219 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.734219 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
08:01:46.734219 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
08:01:46.781531 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:46.783536 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.783536 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
08:01:46.805560 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:46.809562 [debug] [Thread-4 (]: On model.satellite_tracker.testing: COMMIT
08:01:46.809562 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:46.809562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:46.809562 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:01:46.811560 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.813561 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.813561 [debug] [Thread-4 (]: On model.satellite_tracker.testing: COMMIT
08:01:46.813561 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
08:01:46.813561 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
08:01:46.853636 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:46.853636 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:01:46.854636 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.854636 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:01:46.886674 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:46.886674 [debug] [Thread-4 (]: SQL status: COMMIT in 0.07 seconds
08:01:46.886674 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:46.887677 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:01:46.890674 [debug] [Thread-4 (]: Using postgres connection "model.satellite_tracker.testing"
08:01:46.891673 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:01:46.891673 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.892674 [debug] [Thread-4 (]: On model.satellite_tracker.testing: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.testing"} */
drop view if exists "portfolio_website"."production"."testing__dbt_backup" cascade
08:01:46.892674 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.892674 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:01:46.893674 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:01:46.923688 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:01:46.924690 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:01:46.925688 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
08:01:46.965744 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
08:01:46.966744 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.07 seconds
08:01:46.966744 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:01:46.968744 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:01:46.969746 [debug] [Thread-4 (]: finished collecting timing info
08:01:46.970744 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:01:46.970744 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
08:01:46.970744 [debug] [Thread-4 (]: On model.satellite_tracker.testing: Close
08:01:46.971744 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
08:01:46.972745 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6F384C0>]}
08:01:46.972745 [info ] [Thread-4 (]: 4 of 6 OK created view model production.testing ................................ [[32mCREATE VIEW[0m in 0.94s]
08:01:46.973744 [debug] [Thread-4 (]: Finished running node model.satellite_tracker.testing
08:01:46.994745 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:01:46.995744 [debug] [Thread-2 (]: finished collecting timing info
08:01:46.996744 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
08:01:46.996744 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6DBC8B0>]}
08:01:46.996744 [info ] [Thread-2 (]: 2 of 6 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 0.96s]
08:01:46.997744 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
08:01:46.997744 [debug] [Thread-5 (]: Began running node model.satellite_tracker.daily_satellite_stats
08:01:46.998745 [info ] [Thread-5 (]: 5 of 6 START view model production.daily_satellite_stats ....................... [RUN]
08:01:46.998745 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
08:01:46.998745 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
08:01:46.999746 [debug] [Thread-5 (]: Compiling model.satellite_tracker.daily_satellite_stats
08:01:47.000746 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
08:01:47.001744 [debug] [Thread-5 (]: finished collecting timing info
08:01:47.001744 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.daily_satellite_stats
08:01:47.002745 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.daily_satellite_stats"
08:01:47.003744 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:01:47.003744 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: BEGIN
08:01:47.003744 [debug] [Thread-5 (]: Opening a new connection, currently in state init
08:01:47.043757 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
08:01:47.044758 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:01:47.045758 [debug] [Thread-3 (]: finished collecting timing info
08:01:47.045758 [debug] [Thread-1 (]: finished collecting timing info
08:01:47.046762 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
08:01:47.046762 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
08:01:47.046762 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6F3D1B0>]}
08:01:47.047758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6ED7EB0>]}
08:01:47.047758 [info ] [Thread-3 (]: 3 of 6 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.01s]
08:01:47.047758 [info ] [Thread-1 (]: 1 of 6 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.01s]
08:01:47.048758 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
08:01:47.049758 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
08:01:47.049758 [debug] [Thread-2 (]: Began running node model.satellite_tracker.satellite_tracking
08:01:47.049758 [info ] [Thread-2 (]: 6 of 6 START view model production.satellite_tracking .......................... [RUN]
08:01:47.050761 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
08:01:47.050761 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.satellite_tracking
08:01:47.050761 [debug] [Thread-2 (]: Compiling model.satellite_tracker.satellite_tracking
08:01:47.053760 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
08:01:47.053760 [debug] [Thread-2 (]: finished collecting timing info
08:01:47.054761 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.satellite_tracking
08:01:47.055758 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
08:01:47.056759 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:01:47.056759 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: BEGIN
08:01:47.056759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
08:01:47.581278 [debug] [Thread-5 (]: SQL status: BEGIN in 0.58 seconds
08:01:47.582279 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:01:47.582279 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */

  create view "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" as (
    -- Set configuration settings


WITH daily_satellite_stats AS (
    SELECT
        DATE_TRUNC('day', timestamp) AS day,
        id AS satellite_id,
        AVG(velocity_mph) AS average_velocity,
        AVG(altitude) AS average_altitude
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    GROUP BY id, DATE_TRUNC('day', timestamp)
)

SELECT
    *
FROM daily_satellite_stats
  );
08:01:47.640337 [debug] [Thread-2 (]: SQL status: BEGIN in 0.58 seconds
08:01:47.640337 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:01:47.640337 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    WHERE satellite_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
08:01:47.653819 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.07 seconds
08:01:47.655347 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:01:47.655347 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
alter table "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" rename to "daily_satellite_stats"
08:01:47.716333 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.07 seconds
08:01:47.717333 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:01:47.717333 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
08:01:47.725349 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:47.726348 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:01:47.726348 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:01:47.727349 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:01:47.790556 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:01:47.791559 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:01:47.791559 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:01:47.791559 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:01:47.798842 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
08:01:47.799560 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:01:47.799560 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
drop view if exists "portfolio_website"."production"."daily_satellite_stats__dbt_backup" cascade
08:01:47.864661 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:01:47.865660 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:01:47.865660 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
08:01:47.869660 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
08:01:47.870661 [debug] [Thread-5 (]: finished collecting timing info
08:01:47.870661 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: Close
08:01:47.870661 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6EE2950>]}
08:01:47.871660 [info ] [Thread-5 (]: 5 of 6 OK created view model production.daily_satellite_stats .................. [[32mCREATE VIEW[0m in 0.87s]
08:01:47.871660 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.daily_satellite_stats
08:01:47.938597 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:01:47.939610 [debug] [Thread-2 (]: finished collecting timing info
08:01:47.939610 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: Close
08:01:47.940609 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7720c31a-cbb2-4cf0-8976-c4de1af7c461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6D93DF0>]}
08:01:47.940609 [info ] [Thread-2 (]: 6 of 6 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.89s]
08:01:47.941609 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.satellite_tracking
08:01:47.942610 [debug] [MainThread]: Acquiring new postgres connection "master"
08:01:47.942610 [debug] [MainThread]: Using postgres connection "master"
08:01:47.943611 [debug] [MainThread]: On master: BEGIN
08:01:47.943611 [debug] [MainThread]: Opening a new connection, currently in state closed
08:01:48.556509 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
08:01:48.556509 [debug] [MainThread]: On master: COMMIT
08:01:48.556509 [debug] [MainThread]: Using postgres connection "master"
08:01:48.556509 [debug] [MainThread]: On master: COMMIT
08:01:48.633589 [debug] [MainThread]: SQL status: COMMIT in 0.08 seconds
08:01:48.634590 [debug] [MainThread]: On master: Close
08:01:48.634590 [info ] [MainThread]: 
08:01:48.635589 [info ] [MainThread]: Finished running 6 view models in 5.06s.
08:01:48.635589 [debug] [MainThread]: Connection 'master' was properly closed.
08:01:48.635589 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:01:48.635589 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:01:48.636591 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
08:01:48.636591 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
08:01:48.636591 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
08:01:48.636591 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
08:01:48.636591 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
08:01:48.636591 [debug] [MainThread]: Connection 'model.satellite_tracker.testing' was properly closed.
08:01:48.637591 [debug] [MainThread]: Connection 'model.satellite_tracker.daily_satellite_stats' was properly closed.
08:01:48.641589 [info ] [MainThread]: 
08:01:48.641589 [info ] [MainThread]: [32mCompleted successfully[0m
08:01:48.642590 [info ] [MainThread]: 
08:01:48.642590 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
08:01:48.642590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A7057580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A6DBB1C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283A707B0D0>]}


============================== 2022-07-10 08:03:48.441451 | a598dc0f-80b9-479f-8f67-61f369d228bd ==============================
08:03:48.441451 [info ] [MainThread]: Running with dbt=1.1.1
08:03:48.441451 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:03:48.441451 [debug] [MainThread]: Tracking: tracking
08:03:48.450454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1BA7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1BA6FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1BA7220>]}
08:03:48.487454 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 1 files changed.
08:03:48.487454 [debug] [MainThread]: Partial parsing: deleted file: satellite_tracker://models\production\testing.sql
08:03:48.487454 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\daily_satellite_stats.sql
08:03:48.495451 [debug] [MainThread]: 1699: static parser successfully parsed production\daily_satellite_stats.sql
08:03:48.508454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1D0D780>]}
08:03:48.513454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1CC9D80>]}
08:03:48.513454 [info ] [MainThread]: Found 5 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:03:48.513454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1CC9C60>]}
08:03:48.515451 [info ] [MainThread]: 
08:03:48.515451 [debug] [MainThread]: Acquiring new postgres connection "master"
08:03:48.516452 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:03:48.516452 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:03:48.522454 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:03:48.523454 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:03:48.523454 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:03:48.524452 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:03:48.524452 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:03:48.524452 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:03:49.105182 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.58 seconds
08:03:49.106187 [debug] [ThreadPool]: On list_portfolio_website: Close
08:03:49.108183 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.58 seconds
08:03:49.108183 [debug] [ThreadPool]: On list_portfolio_website: Close
08:03:49.110184 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
08:03:49.113186 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:03:49.114186 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
08:03:49.114186 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
08:03:49.115186 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:03:49.115186 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:03:49.115186 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
08:03:49.115186 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:03:49.710187 [debug] [ThreadPool]: SQL status: BEGIN in 0.6 seconds
08:03:49.710187 [debug] [ThreadPool]: SQL status: BEGIN in 0.6 seconds
08:03:49.710187 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:03:49.710187 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:03:49.711187 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
08:03:49.711187 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
08:03:49.785832 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.07 seconds
08:03:49.786834 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
08:03:49.786834 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.08 seconds
08:03:49.787833 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
08:03:49.858470 [debug] [ThreadPool]: On list_portfolio_website_production: Close
08:03:49.858470 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
08:03:49.861493 [debug] [MainThread]: Using postgres connection "master"
08:03:49.861493 [debug] [MainThread]: On master: BEGIN
08:03:49.861493 [debug] [MainThread]: Opening a new connection, currently in state init
08:03:50.461781 [debug] [MainThread]: SQL status: BEGIN in 0.6 seconds
08:03:50.461781 [debug] [MainThread]: Using postgres connection "master"
08:03:50.462786 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:03:50.555384 [debug] [MainThread]: SQL status: SELECT 6 in 0.09 seconds
08:03:50.556384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1CC9630>]}
08:03:50.556384 [debug] [MainThread]: On master: ROLLBACK
08:03:50.628676 [debug] [MainThread]: Using postgres connection "master"
08:03:50.628676 [debug] [MainThread]: On master: BEGIN
08:03:50.776018 [debug] [MainThread]: SQL status: BEGIN in 0.15 seconds
08:03:50.777019 [debug] [MainThread]: On master: COMMIT
08:03:50.777019 [debug] [MainThread]: Using postgres connection "master"
08:03:50.777414 [debug] [MainThread]: On master: COMMIT
08:03:50.887166 [debug] [MainThread]: SQL status: COMMIT in 0.11 seconds
08:03:50.887166 [debug] [MainThread]: On master: Close
08:03:50.887166 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
08:03:50.888166 [info ] [MainThread]: 
08:03:50.892166 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
08:03:50.892166 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
08:03:50.892166 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
08:03:50.892166 [info ] [Thread-1 (]: 1 of 5 START view model staging.stg_satellite_detail_dm ........................ [RUN]
08:03:50.893166 [info ] [Thread-2 (]: 2 of 5 START view model staging.stg_satellite_position_ft ...................... [RUN]
08:03:50.893166 [info ] [Thread-3 (]: 3 of 5 START view model staging.stg_satellite_tle_ft ........................... [RUN]
08:03:50.894167 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:03:50.894167 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:03:50.894167 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:03:50.895167 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
08:03:50.895167 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
08:03:50.895167 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
08:03:50.895167 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
08:03:50.895167 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
08:03:50.896167 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
08:03:50.897167 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:03:50.901167 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:03:50.902166 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:03:50.903168 [debug] [Thread-1 (]: finished collecting timing info
08:03:50.903168 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
08:03:50.903168 [debug] [Thread-2 (]: finished collecting timing info
08:03:50.917166 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:03:50.918167 [debug] [Thread-3 (]: finished collecting timing info
08:03:50.918167 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
08:03:50.918167 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
08:03:50.920169 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:03:50.920169 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:03:50.921166 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:03:50.922167 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
08:03:50.922167 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:03:50.922167 [debug] [Thread-1 (]: Opening a new connection, currently in state init
08:03:50.922167 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:03:50.923168 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
08:03:50.923168 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
08:03:50.923168 [debug] [Thread-2 (]: Opening a new connection, currently in state init
08:03:50.923168 [debug] [Thread-3 (]: Opening a new connection, currently in state init
08:03:51.654088 [debug] [Thread-2 (]: SQL status: BEGIN in 0.73 seconds
08:03:51.655088 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:03:51.655088 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
08:03:51.714133 [debug] [Thread-3 (]: SQL status: BEGIN in 0.79 seconds
08:03:51.714133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.79 seconds
08:03:51.715134 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:03:51.715134 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:03:51.715134 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
08:03:51.715134 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
08:03:51.743252 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.09 seconds
08:03:51.747240 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:03:51.747240 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
08:03:51.789870 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.07 seconds
08:03:51.790887 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:03:51.790887 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
08:03:51.795874 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.08 seconds
08:03:51.796874 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:03:51.796874 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
08:03:51.824113 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.08 seconds
08:03:51.825113 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:03:51.825113 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
08:03:51.870380 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.08 seconds
08:03:51.871380 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:03:51.871380 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
08:03:51.884378 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.09 seconds
08:03:51.885380 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:03:51.886380 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
08:03:51.919194 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.09 seconds
08:03:51.923194 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:03:51.924194 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:03:51.924194 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:03:51.946200 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:03:51.947200 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:03:51.947200 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:03:51.947200 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:03:51.959459 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:03:51.959459 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:03:51.960458 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:03:51.960458 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:03:51.993772 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:03:51.995772 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:03:51.996772 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
08:03:52.035802 [debug] [Thread-3 (]: SQL status: COMMIT in 0.09 seconds
08:03:52.036802 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:03:52.036802 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
08:03:52.056221 [debug] [Thread-1 (]: SQL status: COMMIT in 0.1 seconds
08:03:52.057221 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:03:52.057221 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
08:03:52.068960 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:03:52.069960 [debug] [Thread-2 (]: finished collecting timing info
08:03:52.069960 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
08:03:52.069960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1D6C970>]}
08:03:52.070960 [info ] [Thread-2 (]: 2 of 5 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 1.18s]
08:03:52.071960 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
08:03:52.071960 [debug] [Thread-5 (]: Began running node model.satellite_tracker.daily_satellite_stats
08:03:52.071960 [info ] [Thread-5 (]: 4 of 5 START view model production.daily_satellite_stats ....................... [RUN]
08:03:52.072960 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
08:03:52.072960 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
08:03:52.072960 [debug] [Thread-5 (]: Compiling model.satellite_tracker.daily_satellite_stats
08:03:52.074960 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
08:03:52.074960 [debug] [Thread-5 (]: finished collecting timing info
08:03:52.074960 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.daily_satellite_stats
08:03:52.076961 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.daily_satellite_stats"
08:03:52.077959 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:03:52.077959 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: BEGIN
08:03:52.077959 [debug] [Thread-5 (]: Opening a new connection, currently in state init
08:03:52.115798 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.08 seconds
08:03:52.116798 [debug] [Thread-3 (]: finished collecting timing info
08:03:52.117796 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
08:03:52.118796 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1E48160>]}
08:03:52.118796 [info ] [Thread-3 (]: 3 of 5 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.22s]
08:03:52.119796 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
08:03:52.120796 [debug] [Thread-2 (]: Began running node model.satellite_tracker.satellite_tracking
08:03:52.120796 [info ] [Thread-2 (]: 5 of 5 START view model production.satellite_tracking .......................... [RUN]
08:03:52.120796 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
08:03:52.121796 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.satellite_tracking
08:03:52.121796 [debug] [Thread-2 (]: Compiling model.satellite_tracker.satellite_tracking
08:03:52.123797 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
08:03:52.124796 [debug] [Thread-2 (]: finished collecting timing info
08:03:52.124796 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.satellite_tracking
08:03:52.125798 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
08:03:52.126797 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:03:52.126797 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: BEGIN
08:03:52.127798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
08:03:52.163796 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.11 seconds
08:03:52.164801 [debug] [Thread-1 (]: finished collecting timing info
08:03:52.164801 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
08:03:52.165797 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1BA6EC0>]}
08:03:52.165797 [info ] [Thread-1 (]: 1 of 5 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.27s]
08:03:52.166796 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
08:03:52.863019 [debug] [Thread-2 (]: SQL status: BEGIN in 0.74 seconds
08:03:52.863019 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:03:52.863019 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    WHERE satellite_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
        ON satellites_to_track.id = satellite_position.id
    ORDER BY satellites_to_track.id, satellite_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
        ON satellites_to_track.id = satellite_tle.id
    ORDER BY satellites_to_track.id, satellite_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
08:03:52.933592 [debug] [Thread-5 (]: SQL status: BEGIN in 0.86 seconds
08:03:52.933592 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:03:52.934593 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */

  create view "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" as (
    -- Set configuration settings


WITH daily_satellite_stats AS (
    SELECT
        DATE_TRUNC('day', timestamp) AS day,
        id AS satellite_id,
        AVG(velocity_mph) AS average_velocity_mph,
        AVG(altitude) AS average_altitude_miles
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    GROUP BY id, DATE_TRUNC('day', timestamp)
)

SELECT
    *
FROM daily_satellite_stats
  );
08:03:52.952126 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.09 seconds
08:03:52.953127 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:03:52.954127 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
08:03:53.018147 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.08 seconds
08:03:53.020147 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:03:53.020147 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
alter table "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" rename to "daily_satellite_stats"
08:03:53.024146 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:03:53.024146 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:03:53.025149 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:03:53.025149 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:03:53.097622 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:03:53.097622 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:03:53.098635 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
08:03:53.098635 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.08 seconds
08:03:53.099633 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:03:53.099633 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:03:53.099633 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:03:53.175411 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.08 seconds
08:03:53.175411 [debug] [Thread-2 (]: finished collecting timing info
08:03:53.176411 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_tracking: Close
08:03:53.176411 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1CE9BD0>]}
08:03:53.176411 [info ] [Thread-2 (]: 5 of 5 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 1.06s]
08:03:53.177411 [debug] [Thread-5 (]: SQL status: COMMIT in 0.08 seconds
08:03:53.178414 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:03:53.178414 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.satellite_tracking
08:03:53.178414 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
drop view if exists "portfolio_website"."production"."daily_satellite_stats__dbt_backup" cascade
08:03:53.287490 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.11 seconds
08:03:53.288490 [debug] [Thread-5 (]: finished collecting timing info
08:03:53.288490 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: Close
08:03:53.289490 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a598dc0f-80b9-479f-8f67-61f369d228bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1E1E230>]}
08:03:53.289490 [info ] [Thread-5 (]: 4 of 5 OK created view model production.daily_satellite_stats .................. [[32mCREATE VIEW[0m in 1.22s]
08:03:53.290490 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.daily_satellite_stats
08:03:53.291491 [debug] [MainThread]: Acquiring new postgres connection "master"
08:03:53.291491 [debug] [MainThread]: Using postgres connection "master"
08:03:53.291491 [debug] [MainThread]: On master: BEGIN
08:03:53.292491 [debug] [MainThread]: Opening a new connection, currently in state closed
08:03:53.904786 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
08:03:53.904786 [debug] [MainThread]: On master: COMMIT
08:03:53.904786 [debug] [MainThread]: Using postgres connection "master"
08:03:53.904786 [debug] [MainThread]: On master: COMMIT
08:03:53.973874 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:03:53.973874 [debug] [MainThread]: On master: Close
08:03:53.974863 [info ] [MainThread]: 
08:03:53.974863 [info ] [MainThread]: Finished running 5 view models in 5.46s.
08:03:53.975864 [debug] [MainThread]: Connection 'master' was properly closed.
08:03:53.975864 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:03:53.975864 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:03:53.976863 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
08:03:53.976863 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
08:03:53.976863 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_detail_dm' was properly closed.
08:03:53.976863 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
08:03:53.976863 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
08:03:53.976863 [debug] [MainThread]: Connection 'model.satellite_tracker.daily_satellite_stats' was properly closed.
08:03:53.981863 [info ] [MainThread]: 
08:03:53.981863 [info ] [MainThread]: [32mCompleted successfully[0m
08:03:53.982865 [info ] [MainThread]: 
08:03:53.983863 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
08:03:53.983863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1E1E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1E4AF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255F1E32980>]}


============================== 2022-07-10 08:36:08.482440 | 91c78cd9-af0d-4498-9fed-ed9df35e9d24 ==============================
08:36:08.482440 [info ] [MainThread]: Running with dbt=1.1.1
08:36:08.483440 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:36:08.483440 [debug] [MainThread]: Tracking: tracking
08:36:08.492443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394A47610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394A46FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394A47220>]}
08:36:08.530440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
08:36:08.530440 [debug] [MainThread]: Partial parsing: added file: satellite_tracker://models\production\satellite_details.sql
08:36:08.531440 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\satellite_tracking.sql
08:36:08.537440 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_details.sql
08:36:08.546441 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
08:36:08.553441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394BAD930>]}
08:36:08.557440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394B6BDC0>]}
08:36:08.558442 [info ] [MainThread]: Found 6 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:36:08.558442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394B689A0>]}
08:36:08.559442 [info ] [MainThread]: 
08:36:08.560440 [debug] [MainThread]: Acquiring new postgres connection "master"
08:36:08.561441 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:36:08.561441 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:36:08.568445 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:36:08.569441 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:36:08.569441 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:36:08.570441 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:36:08.570441 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:36:08.570441 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:36:09.165333 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.59 seconds
08:36:09.167337 [debug] [ThreadPool]: On list_portfolio_website: Close
08:36:09.177332 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
08:36:09.178335 [debug] [ThreadPool]: On list_portfolio_website: Close
08:36:09.179335 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
08:36:09.179335 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
08:36:09.183333 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:36:09.184333 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:36:09.184333 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
08:36:09.184333 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
08:36:09.185335 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:36:09.185335 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:36:09.752921 [debug] [ThreadPool]: SQL status: BEGIN in 0.57 seconds
08:36:09.752921 [debug] [ThreadPool]: SQL status: BEGIN in 0.57 seconds
08:36:09.752921 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:36:09.753921 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:36:09.753921 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
08:36:09.753921 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
08:36:09.826265 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
08:36:09.826265 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.07 seconds
08:36:09.827265 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
08:36:09.828268 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
08:36:09.898240 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
08:36:09.898240 [debug] [ThreadPool]: On list_portfolio_website_production: Close
08:36:09.901240 [debug] [MainThread]: Using postgres connection "master"
08:36:09.901240 [debug] [MainThread]: On master: BEGIN
08:36:09.902245 [debug] [MainThread]: Opening a new connection, currently in state init
08:36:10.487067 [debug] [MainThread]: SQL status: BEGIN in 0.58 seconds
08:36:10.488068 [debug] [MainThread]: Using postgres connection "master"
08:36:10.488068 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:36:10.574463 [debug] [MainThread]: SQL status: SELECT 6 in 0.09 seconds
08:36:10.576470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394B68AC0>]}
08:36:10.576470 [debug] [MainThread]: On master: ROLLBACK
08:36:10.647232 [debug] [MainThread]: Using postgres connection "master"
08:36:10.647232 [debug] [MainThread]: On master: BEGIN
08:36:10.791179 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
08:36:10.791179 [debug] [MainThread]: On master: COMMIT
08:36:10.792170 [debug] [MainThread]: Using postgres connection "master"
08:36:10.792170 [debug] [MainThread]: On master: COMMIT
08:36:10.864360 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:36:10.865361 [debug] [MainThread]: On master: Close
08:36:10.865361 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
08:36:10.866363 [info ] [MainThread]: 
08:36:10.870361 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
08:36:10.870361 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
08:36:10.870361 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
08:36:10.871363 [info ] [Thread-1 (]: 1 of 6 START view model staging.stg_satellite_detail_dm ........................ [RUN]
08:36:10.871363 [info ] [Thread-2 (]: 2 of 6 START view model staging.stg_satellite_position_ft ...................... [RUN]
08:36:10.871363 [info ] [Thread-3 (]: 3 of 6 START view model staging.stg_satellite_tle_ft ........................... [RUN]
08:36:10.872362 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:36:10.872362 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:36:10.873363 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:36:10.873363 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
08:36:10.873363 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
08:36:10.873363 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
08:36:10.873363 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
08:36:10.874361 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
08:36:10.874361 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
08:36:10.876362 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:36:10.879361 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:36:10.880361 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:36:10.881362 [debug] [Thread-1 (]: finished collecting timing info
08:36:10.881362 [debug] [Thread-2 (]: finished collecting timing info
08:36:10.881362 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
08:36:10.881362 [debug] [Thread-3 (]: finished collecting timing info
08:36:10.882362 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
08:36:10.897363 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:36:10.897363 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
08:36:10.899364 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:36:10.901361 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:36:10.901361 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:36:10.901361 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
08:36:10.901361 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:36:10.902360 [debug] [Thread-1 (]: Opening a new connection, currently in state init
08:36:10.902360 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:36:10.902360 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
08:36:10.902360 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
08:36:10.902360 [debug] [Thread-2 (]: Opening a new connection, currently in state init
08:36:10.903362 [debug] [Thread-3 (]: Opening a new connection, currently in state init
08:36:11.464937 [debug] [Thread-3 (]: SQL status: BEGIN in 0.56 seconds
08:36:11.464937 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:36:11.465937 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
08:36:11.476139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.57 seconds
08:36:11.476139 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:36:11.476139 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
08:36:11.477606 [debug] [Thread-2 (]: SQL status: BEGIN in 0.58 seconds
08:36:11.477606 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:36:11.477606 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
08:36:11.542769 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.08 seconds
08:36:11.546769 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:36:11.546769 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
08:36:11.547770 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.07 seconds
08:36:11.548770 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:36:11.548770 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
08:36:11.565156 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.09 seconds
08:36:11.567156 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:36:11.567156 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
08:36:11.616647 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:36:11.617647 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:36:11.617647 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
08:36:11.619646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:36:11.620635 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:36:11.620635 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
08:36:11.638049 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:36:11.639055 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:36:11.639055 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
08:36:11.689402 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:36:11.693404 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:36:11.693404 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:36:11.693404 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:36:11.694405 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:36:11.694977 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:36:11.694977 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:36:11.694977 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:36:11.709674 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:36:11.710674 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:36:11.710674 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:36:11.710674 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:36:11.765167 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
08:36:11.768167 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:36:11.768167 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
08:36:11.769168 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:36:11.770168 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:36:11.770168 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
08:36:11.782935 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:36:11.783947 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:36:11.783947 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
08:36:11.837604 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
08:36:11.837604 [debug] [Thread-3 (]: finished collecting timing info
08:36:11.838627 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
08:36:11.838627 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394B6C310>]}
08:36:11.838627 [info ] [Thread-3 (]: 3 of 6 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 0.97s]
08:36:11.839715 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
08:36:11.839715 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:36:11.840738 [debug] [Thread-1 (]: finished collecting timing info
08:36:11.840738 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
08:36:11.841739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394C6F490>]}
08:36:11.841739 [info ] [Thread-1 (]: 1 of 6 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 0.97s]
08:36:11.841739 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
08:36:11.842727 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_details
08:36:11.842727 [info ] [Thread-5 (]: 4 of 6 START view model production.satellite_details ........................... [RUN]
08:36:11.843726 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_details"
08:36:11.843726 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_details
08:36:11.843726 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_details
08:36:11.845726 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_details"
08:36:11.845726 [debug] [Thread-5 (]: finished collecting timing info
08:36:11.845726 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_details
08:36:11.848728 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_details"
08:36:11.848728 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:36:11.848728 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: BEGIN
08:36:11.849726 [debug] [Thread-5 (]: Opening a new connection, currently in state init
08:36:11.855730 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:36:11.856727 [debug] [Thread-2 (]: finished collecting timing info
08:36:11.856727 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
08:36:11.857728 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394CEB640>]}
08:36:11.857728 [info ] [Thread-2 (]: 2 of 6 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 0.99s]
08:36:11.858727 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
08:36:11.859726 [debug] [Thread-3 (]: Began running node model.satellite_tracker.daily_satellite_stats
08:36:11.859726 [debug] [Thread-1 (]: Began running node model.satellite_tracker.satellite_tracking
08:36:11.859726 [info ] [Thread-3 (]: 5 of 6 START view model production.daily_satellite_stats ....................... [RUN]
08:36:11.859726 [info ] [Thread-1 (]: 6 of 6 START view model production.satellite_tracking .......................... [RUN]
08:36:11.860727 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
08:36:11.860727 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
08:36:11.860727 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
08:36:11.861727 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.satellite_tracking
08:36:11.861727 [debug] [Thread-3 (]: Compiling model.satellite_tracker.daily_satellite_stats
08:36:11.861727 [debug] [Thread-1 (]: Compiling model.satellite_tracker.satellite_tracking
08:36:11.863726 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
08:36:11.865726 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
08:36:11.866726 [debug] [Thread-3 (]: finished collecting timing info
08:36:11.866726 [debug] [Thread-1 (]: finished collecting timing info
08:36:11.866726 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.daily_satellite_stats
08:36:11.866726 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.satellite_tracking
08:36:11.868726 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.daily_satellite_stats"
08:36:11.869729 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
08:36:11.870727 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:36:11.870727 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: BEGIN
08:36:11.870727 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:36:11.871727 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
08:36:11.871727 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: BEGIN
08:36:11.871727 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
08:36:12.422730 [debug] [Thread-5 (]: SQL status: BEGIN in 0.57 seconds
08:36:12.422730 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:36:12.422730 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_details"} */

  create view "portfolio_website"."production"."satellite_details__dbt_tmp" as (
    -- Set configuration settings


WITH satellite_details AS (
    SELECT
        satellite_id,
        name,
        description,
        operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        satellite_bus,
        launch_mass_lbs,
        launch_date,
        AGE(launch_date) AS days_since_launch
        launch_site,
        reference_system,
        rocket,
        satellite_website,
        wikipedia_link
    FROM "portfolio_website"."staging"."stg_satellite_detail_dm" AS sat_details
)

SELECT
    *
FROM satellite_details
  );
08:36:12.467553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.6 seconds
08:36:12.467553 [debug] [Thread-3 (]: SQL status: BEGIN in 0.6 seconds
08:36:12.467553 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:36:12.467553 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:36:12.467553 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS sat_position
    WHERE sat_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_position.timestamp AS position_timestamp,
        satellite_position.latitude,
        satellite_position.longitude,
        satellite_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS sat_position
        ON satellites_to_track.id = sat_position.id
    ORDER BY satellites_to_track.id, sat_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        satellite_tle.timestamp,
        satellite_tle.timestamp AS tle_timestamp,
        satellite_tle.line_1,
        satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS sat_tle
        ON satellites_to_track.id = sat_tle.id
    ORDER BY satellites_to_track.id, sat_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
08:36:12.468577 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */

  create view "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" as (
    -- Set configuration settings


WITH daily_satellite_stats AS (
    SELECT
        DATE_TRUNC('day', timestamp) AS day,
        id AS satellite_id,
        AVG(velocity_mph) AS average_velocity_mph,
        AVG(altitude) AS average_altitude_miles
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    GROUP BY id, DATE_TRUNC('day', timestamp)
)

SELECT
    *
FROM daily_satellite_stats
  );
08:36:12.494622 [debug] [Thread-5 (]: Postgres adapter: Postgres error: syntax error at or near "launch_site"
LINE 22:         launch_site,
                 ^

08:36:12.494622 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: ROLLBACK
08:36:12.540683 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "satellite_position"
LINE 25:         satellite_position.timestamp AS position_timestamp,
                 ^

08:36:12.540683 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: ROLLBACK
08:36:12.542683 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.07 seconds
08:36:12.543684 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:36:12.544683 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
alter table "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" rename to "daily_satellite_stats"
08:36:12.566604 [debug] [Thread-5 (]: finished collecting timing info
08:36:12.567007 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: Close
08:36:12.567007 [debug] [Thread-5 (]: Database Error in model satellite_details (models\production\satellite_details.sql)
  syntax error at or near "launch_site"
  LINE 22:         launch_site,
                   ^
  compiled SQL at target\run\satellite_tracker\models\production\satellite_details.sql
08:36:12.567007 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394C166B0>]}
08:36:12.568019 [error] [Thread-5 (]: 4 of 6 ERROR creating view model production.satellite_details .................. [[31mERROR[0m in 0.72s]
08:36:12.568019 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_details
08:36:12.613506 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:36:12.613506 [debug] [Thread-1 (]: finished collecting timing info
08:36:12.614504 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:36:12.614504 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: Close
08:36:12.614504 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:36:12.614504 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:36:12.615504 [debug] [Thread-1 (]: Database Error in model satellite_tracking (models\production\satellite_tracking.sql)
  missing FROM-clause entry for table "satellite_position"
  LINE 25:         satellite_position.timestamp AS position_timestamp,
                   ^
  compiled SQL at target\run\satellite_tracker\models\production\satellite_tracking.sql
08:36:12.615504 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394C16140>]}
08:36:12.615504 [error] [Thread-1 (]: 6 of 6 ERROR creating view model production.satellite_tracking ................. [[31mERROR[0m in 0.75s]
08:36:12.616504 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.satellite_tracking
08:36:12.685921 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
08:36:12.687921 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:36:12.687921 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
drop view if exists "portfolio_website"."production"."daily_satellite_stats__dbt_backup" cascade
08:36:12.759297 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
08:36:12.759855 [debug] [Thread-3 (]: finished collecting timing info
08:36:12.759855 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: Close
08:36:12.760873 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '91c78cd9-af0d-4498-9fed-ed9df35e9d24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394C174C0>]}
08:36:12.760873 [info ] [Thread-3 (]: 5 of 6 OK created view model production.daily_satellite_stats .................. [[32mCREATE VIEW[0m in 0.90s]
08:36:12.761863 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.daily_satellite_stats
08:36:12.762862 [debug] [MainThread]: Acquiring new postgres connection "master"
08:36:12.762862 [debug] [MainThread]: Using postgres connection "master"
08:36:12.762862 [debug] [MainThread]: On master: BEGIN
08:36:12.762862 [debug] [MainThread]: Opening a new connection, currently in state closed
08:36:13.350118 [debug] [MainThread]: SQL status: BEGIN in 0.59 seconds
08:36:13.350118 [debug] [MainThread]: On master: COMMIT
08:36:13.350118 [debug] [MainThread]: Using postgres connection "master"
08:36:13.351122 [debug] [MainThread]: On master: COMMIT
08:36:13.423737 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:36:13.424744 [debug] [MainThread]: On master: Close
08:36:13.424744 [info ] [MainThread]: 
08:36:13.425647 [info ] [MainThread]: Finished running 6 view models in 4.86s.
08:36:13.425647 [debug] [MainThread]: Connection 'master' was properly closed.
08:36:13.425647 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:36:13.425647 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:36:13.426671 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
08:36:13.426671 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
08:36:13.426671 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
08:36:13.426671 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
08:36:13.426671 [debug] [MainThread]: Connection 'model.satellite_tracker.daily_satellite_stats' was properly closed.
08:36:13.426671 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_details' was properly closed.
08:36:13.430658 [info ] [MainThread]: 
08:36:13.431658 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
08:36:13.431658 [info ] [MainThread]: 
08:36:13.432658 [error] [MainThread]: [33mDatabase Error in model satellite_details (models\production\satellite_details.sql)[0m
08:36:13.432658 [error] [MainThread]:   syntax error at or near "launch_site"
08:36:13.433658 [error] [MainThread]:   LINE 22:         launch_site,
08:36:13.433658 [error] [MainThread]:                    ^
08:36:13.433658 [error] [MainThread]:   compiled SQL at target\run\satellite_tracker\models\production\satellite_details.sql
08:36:13.434658 [info ] [MainThread]: 
08:36:13.434658 [error] [MainThread]: [33mDatabase Error in model satellite_tracking (models\production\satellite_tracking.sql)[0m
08:36:13.435658 [error] [MainThread]:   missing FROM-clause entry for table "satellite_position"
08:36:13.435658 [error] [MainThread]:   LINE 25:         satellite_position.timestamp AS position_timestamp,
08:36:13.436658 [error] [MainThread]:                    ^
08:36:13.436658 [error] [MainThread]:   compiled SQL at target\run\satellite_tracker\models\production\satellite_tracking.sql
08:36:13.436658 [info ] [MainThread]: 
08:36:13.437658 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
08:36:13.437658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394C14AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394C16230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028394C124A0>]}


============================== 2022-07-10 08:37:48.380548 | 780651a8-83a1-434f-bbf8-ff7f8ec925d6 ==============================
08:37:48.380548 [info ] [MainThread]: Running with dbt=1.1.1
08:37:48.381548 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:37:48.381548 [debug] [MainThread]: Tracking: tracking
08:37:48.390548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018D27610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018D26FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018D27220>]}
08:37:48.426548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:37:48.426548 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\satellite_tracking.sql
08:37:48.433548 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_tracking.sql
08:37:48.447548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018EB5870>]}
08:37:48.451548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018E4BAF0>]}
08:37:48.451548 [info ] [MainThread]: Found 6 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:37:48.452548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018E489A0>]}
08:37:48.453550 [info ] [MainThread]: 
08:37:48.454549 [debug] [MainThread]: Acquiring new postgres connection "master"
08:37:48.455550 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:37:48.455550 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:37:48.461548 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:37:48.462548 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:37:48.463550 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:37:48.463550 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:37:48.463550 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:37:48.463550 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:37:49.105155 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.64 seconds
08:37:49.105155 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.64 seconds
08:37:49.106160 [debug] [ThreadPool]: On list_portfolio_website: Close
08:37:49.107163 [debug] [ThreadPool]: On list_portfolio_website: Close
08:37:49.108018 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
08:37:49.109030 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
08:37:49.112029 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:37:49.113029 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:37:49.113029 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
08:37:49.113029 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
08:37:49.114032 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:37:49.114032 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:37:49.710471 [debug] [ThreadPool]: SQL status: BEGIN in 0.6 seconds
08:37:49.710471 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:37:49.710471 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
08:37:49.766321 [debug] [ThreadPool]: SQL status: BEGIN in 0.65 seconds
08:37:49.767320 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:37:49.767320 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
08:37:49.784978 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
08:37:49.786001 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
08:37:49.846509 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.08 seconds
08:37:49.847507 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
08:37:49.856526 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
08:37:49.922874 [debug] [ThreadPool]: On list_portfolio_website_production: Close
08:37:49.926876 [debug] [MainThread]: Using postgres connection "master"
08:37:49.926876 [debug] [MainThread]: On master: BEGIN
08:37:49.926876 [debug] [MainThread]: Opening a new connection, currently in state init
08:37:50.529797 [debug] [MainThread]: SQL status: BEGIN in 0.6 seconds
08:37:50.530800 [debug] [MainThread]: Using postgres connection "master"
08:37:50.530800 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:37:50.612898 [debug] [MainThread]: SQL status: SELECT 4 in 0.08 seconds
08:37:50.613899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018EB4520>]}
08:37:50.613899 [debug] [MainThread]: On master: ROLLBACK
08:37:50.685459 [debug] [MainThread]: Using postgres connection "master"
08:37:50.686447 [debug] [MainThread]: On master: BEGIN
08:37:50.831363 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
08:37:50.832364 [debug] [MainThread]: On master: COMMIT
08:37:50.832364 [debug] [MainThread]: Using postgres connection "master"
08:37:50.832364 [debug] [MainThread]: On master: COMMIT
08:37:50.905112 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:37:50.906112 [debug] [MainThread]: On master: Close
08:37:50.906112 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
08:37:50.907114 [info ] [MainThread]: 
08:37:50.910112 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
08:37:50.910112 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
08:37:50.911112 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
08:37:50.911112 [info ] [Thread-1 (]: 1 of 6 START view model staging.stg_satellite_detail_dm ........................ [RUN]
08:37:50.911112 [info ] [Thread-2 (]: 2 of 6 START view model staging.stg_satellite_position_ft ...................... [RUN]
08:37:50.912113 [info ] [Thread-3 (]: 3 of 6 START view model staging.stg_satellite_tle_ft ........................... [RUN]
08:37:50.912113 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:37:50.913113 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:37:50.913113 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:37:50.913113 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
08:37:50.913113 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
08:37:50.914114 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
08:37:50.914114 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
08:37:50.914114 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
08:37:50.914114 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
08:37:50.916112 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:37:50.919112 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:37:50.921112 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:37:50.922114 [debug] [Thread-1 (]: finished collecting timing info
08:37:50.922114 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
08:37:50.922114 [debug] [Thread-2 (]: finished collecting timing info
08:37:50.933113 [debug] [Thread-3 (]: finished collecting timing info
08:37:50.937112 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:37:50.937112 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
08:37:50.938112 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
08:37:50.939112 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:37:50.939112 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:37:50.941113 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:37:50.941113 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
08:37:50.941113 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:37:50.942113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
08:37:50.942113 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:37:50.942113 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
08:37:50.942113 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
08:37:50.943113 [debug] [Thread-2 (]: Opening a new connection, currently in state init
08:37:50.943113 [debug] [Thread-3 (]: Opening a new connection, currently in state init
08:37:51.527458 [debug] [Thread-1 (]: SQL status: BEGIN in 0.59 seconds
08:37:51.527458 [debug] [Thread-3 (]: SQL status: BEGIN in 0.58 seconds
08:37:51.527458 [debug] [Thread-2 (]: SQL status: BEGIN in 0.58 seconds
08:37:51.528459 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:37:51.528459 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:37:51.528459 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:37:51.528459 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
08:37:51.529458 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
08:37:51.529458 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
08:37:51.603109 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.07 seconds
08:37:51.603109 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.07 seconds
08:37:51.607111 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:37:51.607111 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.08 seconds
08:37:51.608110 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:37:51.608110 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
08:37:51.610112 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:37:51.610112 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
08:37:51.610112 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
08:37:51.683481 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:37:51.684484 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:37:51.684484 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:37:51.684484 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:37:51.685482 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
08:37:51.686484 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:37:51.687878 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:37:51.687878 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
08:37:51.687878 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
08:37:51.758167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:37:51.762178 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:37:51.762178 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:37:51.762178 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:37:51.762178 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:37:51.763178 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:37:51.764178 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:37:51.764178 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:37:51.764178 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:37:51.764178 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:37:51.765178 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:37:51.765178 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:37:51.836347 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:37:51.836347 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:37:51.836347 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
08:37:51.839371 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:37:51.840371 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:37:51.841371 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:37:51.841371 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
08:37:51.841371 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
08:37:51.841371 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
08:37:51.912358 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:37:51.912358 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:37:51.912358 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
08:37:51.913359 [debug] [Thread-2 (]: finished collecting timing info
08:37:51.914145 [debug] [Thread-1 (]: finished collecting timing info
08:37:51.915165 [debug] [Thread-3 (]: finished collecting timing info
08:37:51.915165 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
08:37:51.915165 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
08:37:51.916165 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
08:37:51.916165 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018EF2410>]}
08:37:51.916165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018F53100>]}
08:37:51.917157 [info ] [Thread-2 (]: 2 of 6 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 1.00s]
08:37:51.917157 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018F247C0>]}
08:37:51.917157 [info ] [Thread-1 (]: 1 of 6 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.00s]
08:37:51.918155 [info ] [Thread-3 (]: 3 of 6 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.00s]
08:37:51.918155 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
08:37:51.919156 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
08:37:51.919156 [debug] [Thread-5 (]: Began running node model.satellite_tracker.daily_satellite_stats
08:37:51.919156 [debug] [Thread-2 (]: Began running node model.satellite_tracker.satellite_details
08:37:51.920155 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
08:37:51.920155 [info ] [Thread-5 (]: 4 of 6 START view model production.daily_satellite_stats ....................... [RUN]
08:37:51.920155 [info ] [Thread-2 (]: 5 of 6 START view model production.satellite_details ........................... [RUN]
08:37:51.921157 [debug] [Thread-1 (]: Began running node model.satellite_tracker.satellite_tracking
08:37:51.921157 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
08:37:51.921157 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_details"
08:37:51.922155 [info ] [Thread-1 (]: 6 of 6 START view model production.satellite_tracking .......................... [RUN]
08:37:51.922155 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
08:37:51.922155 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.satellite_details
08:37:51.923157 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
08:37:51.923157 [debug] [Thread-5 (]: Compiling model.satellite_tracker.daily_satellite_stats
08:37:51.923157 [debug] [Thread-2 (]: Compiling model.satellite_tracker.satellite_details
08:37:51.923157 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.satellite_tracking
08:37:51.925155 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
08:37:51.927157 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.satellite_details"
08:37:51.927157 [debug] [Thread-1 (]: Compiling model.satellite_tracker.satellite_tracking
08:37:51.931156 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
08:37:51.931156 [debug] [Thread-5 (]: finished collecting timing info
08:37:51.931156 [debug] [Thread-2 (]: finished collecting timing info
08:37:51.931156 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.daily_satellite_stats
08:37:51.931156 [debug] [Thread-1 (]: finished collecting timing info
08:37:51.932157 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.satellite_details
08:37:51.933156 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.daily_satellite_stats"
08:37:51.933156 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.satellite_tracking
08:37:51.935158 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_details"
08:37:51.936159 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
08:37:51.937160 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:37:51.937160 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:37:51.937160 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: BEGIN
08:37:51.937160 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:37:51.938159 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_details: BEGIN
08:37:51.938159 [debug] [Thread-5 (]: Opening a new connection, currently in state init
08:37:51.938159 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: BEGIN
08:37:51.938159 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
08:37:51.939159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
08:37:52.509848 [debug] [Thread-1 (]: SQL status: BEGIN in 0.57 seconds
08:37:52.509848 [debug] [Thread-2 (]: SQL status: BEGIN in 0.57 seconds
08:37:52.509848 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:37:52.510850 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:37:52.510850 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS sat_position
    WHERE sat_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        sat_position.timestamp AS position_timestamp,
        sat_position.latitude,
        sat_position.longitude,
        sat_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS sat_position
        ON satellites_to_track.id = sat_position.id
    ORDER BY satellites_to_track.id, sat_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        sat_tle.timestamp,
        sat_tle.timestamp AS tle_timestamp,
        sat_tle.line_1,
        sat_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS sat_tle
        ON satellites_to_track.id = sat_tle.id
    ORDER BY satellites_to_track.id, sat_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
08:37:52.510850 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_details"} */

  create view "portfolio_website"."production"."satellite_details__dbt_tmp" as (
    -- Set configuration settings


WITH satellite_details AS (
    SELECT
        satellite_id,
        name,
        description,
        operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        satellite_bus,
        launch_mass_lbs,
        launch_date,
        AGE(launch_date) AS days_since_launch
        launch_site,
        reference_system,
        rocket,
        satellite_website,
        wikipedia_link
    FROM "portfolio_website"."staging"."stg_satellite_detail_dm" AS sat_details
)

SELECT
    *
FROM satellite_details
  );
08:37:52.517138 [debug] [Thread-5 (]: SQL status: BEGIN in 0.58 seconds
08:37:52.517787 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:37:52.517787 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */

  create view "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" as (
    -- Set configuration settings


WITH daily_satellite_stats AS (
    SELECT
        DATE_TRUNC('day', timestamp) AS day,
        id AS satellite_id,
        AVG(velocity_mph) AS average_velocity_mph,
        AVG(altitude) AS average_altitude_miles
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    GROUP BY id, DATE_TRUNC('day', timestamp)
)

SELECT
    *
FROM daily_satellite_stats
  );
08:37:52.581409 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "launch_site"
LINE 22:         launch_site,
                 ^

08:37:52.582409 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_details: ROLLBACK
08:37:52.584648 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.07 seconds
08:37:52.585672 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:37:52.585672 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
08:37:52.592464 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.07 seconds
08:37:52.593464 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:37:52.593464 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
alter table "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" rename to "daily_satellite_stats"
08:37:52.654120 [debug] [Thread-2 (]: finished collecting timing info
08:37:52.654120 [debug] [Thread-2 (]: On model.satellite_tracker.satellite_details: Close
08:37:52.654946 [debug] [Thread-2 (]: Database Error in model satellite_details (models\production\satellite_details.sql)
  syntax error at or near "launch_site"
  LINE 22:         launch_site,
                   ^
  compiled SQL at target\run\satellite_tracker\models\production\satellite_details.sql
08:37:52.654946 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018E4A5C0>]}
08:37:52.654946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:37:52.654946 [error] [Thread-2 (]: 5 of 6 ERROR creating view model production.satellite_details .................. [[31mERROR[0m in 0.73s]
08:37:52.655952 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:37:52.656952 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:37:52.656952 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:37:52.656952 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.satellite_details
08:37:52.667634 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
08:37:52.668634 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:37:52.668634 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:37:52.668634 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:37:52.726716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:37:52.728716 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:37:52.728716 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
08:37:52.743581 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
08:37:52.744092 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:37:52.744092 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
drop view if exists "portfolio_website"."production"."daily_satellite_stats__dbt_backup" cascade
08:37:52.799191 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:37:52.800191 [debug] [Thread-1 (]: finished collecting timing info
08:37:52.800191 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: Close
08:37:52.800191 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018F8D240>]}
08:37:52.801192 [info ] [Thread-1 (]: 6 of 6 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.88s]
08:37:52.802194 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.satellite_tracking
08:37:52.816206 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
08:37:52.817208 [debug] [Thread-5 (]: finished collecting timing info
08:37:52.818208 [debug] [Thread-5 (]: On model.satellite_tracker.daily_satellite_stats: Close
08:37:52.818208 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '780651a8-83a1-434f-bbf8-ff7f8ec925d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018EB6F80>]}
08:37:52.818208 [info ] [Thread-5 (]: 4 of 6 OK created view model production.daily_satellite_stats .................. [[32mCREATE VIEW[0m in 0.90s]
08:37:52.819209 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.daily_satellite_stats
08:37:52.820207 [debug] [MainThread]: Acquiring new postgres connection "master"
08:37:52.820207 [debug] [MainThread]: Using postgres connection "master"
08:37:52.820207 [debug] [MainThread]: On master: BEGIN
08:37:52.821208 [debug] [MainThread]: Opening a new connection, currently in state closed
08:37:53.399141 [debug] [MainThread]: SQL status: BEGIN in 0.58 seconds
08:37:53.399141 [debug] [MainThread]: On master: COMMIT
08:37:53.399141 [debug] [MainThread]: Using postgres connection "master"
08:37:53.399788 [debug] [MainThread]: On master: COMMIT
08:37:53.470068 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:37:53.470068 [debug] [MainThread]: On master: Close
08:37:53.471073 [info ] [MainThread]: 
08:37:53.471813 [info ] [MainThread]: Finished running 6 view models in 5.02s.
08:37:53.471813 [debug] [MainThread]: Connection 'master' was properly closed.
08:37:53.471813 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:37:53.472837 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:37:53.472837 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
08:37:53.472837 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
08:37:53.472837 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
08:37:53.472837 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_details' was properly closed.
08:37:53.472837 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_tle_ft' was properly closed.
08:37:53.473833 [debug] [MainThread]: Connection 'model.satellite_tracker.daily_satellite_stats' was properly closed.
08:37:53.477825 [info ] [MainThread]: 
08:37:53.477825 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:37:53.478825 [info ] [MainThread]: 
08:37:53.478825 [error] [MainThread]: [33mDatabase Error in model satellite_details (models\production\satellite_details.sql)[0m
08:37:53.479824 [error] [MainThread]:   syntax error at or near "launch_site"
08:37:53.479824 [error] [MainThread]:   LINE 22:         launch_site,
08:37:53.479824 [error] [MainThread]:                    ^
08:37:53.480825 [error] [MainThread]:   compiled SQL at target\run\satellite_tracker\models\production\satellite_details.sql
08:37:53.480825 [info ] [MainThread]: 
08:37:53.481824 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
08:37:53.481824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018EB7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018EB7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029018FCDD20>]}


============================== 2022-07-10 08:38:11.227932 | d38a7948-a28b-41f3-9e99-70f247aef72a ==============================
08:38:11.227932 [info ] [MainThread]: Running with dbt=1.1.1
08:38:11.227932 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:38:11.227932 [debug] [MainThread]: Tracking: tracking
08:38:11.235932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706487610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706486FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706487220>]}
08:38:11.272933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:38:11.272933 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\satellite_details.sql
08:38:11.279933 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_details.sql
08:38:11.292932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7065F1810>]}
08:38:11.297933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7065A9090>]}
08:38:11.297933 [info ] [MainThread]: Found 6 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:38:11.298933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7065ABAC0>]}
08:38:11.299934 [info ] [MainThread]: 
08:38:11.300932 [debug] [MainThread]: Acquiring new postgres connection "master"
08:38:11.300932 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:38:11.301937 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:38:11.306935 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:38:11.307935 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:38:11.308934 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:38:11.308934 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:38:11.308934 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:38:11.308934 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:38:11.940471 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.63 seconds
08:38:11.941459 [debug] [ThreadPool]: On list_portfolio_website: Close
08:38:11.950458 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.64 seconds
08:38:11.951459 [debug] [ThreadPool]: On list_portfolio_website: Close
08:38:11.952460 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
08:38:11.953458 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
08:38:11.956458 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:38:11.957458 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:38:11.957458 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
08:38:11.957458 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
08:38:11.958458 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:38:11.958458 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:38:12.540042 [debug] [ThreadPool]: SQL status: BEGIN in 0.58 seconds
08:38:12.540042 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:38:12.541060 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
08:38:12.545869 [debug] [ThreadPool]: SQL status: BEGIN in 0.59 seconds
08:38:12.546869 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:38:12.546869 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
08:38:12.616117 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.08 seconds
08:38:12.617141 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
08:38:12.619140 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
08:38:12.621129 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
08:38:12.688441 [debug] [ThreadPool]: On list_portfolio_website_production: Close
08:38:12.692681 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
08:38:12.695705 [debug] [MainThread]: Using postgres connection "master"
08:38:12.695705 [debug] [MainThread]: On master: BEGIN
08:38:12.695705 [debug] [MainThread]: Opening a new connection, currently in state init
08:38:13.299799 [debug] [MainThread]: SQL status: BEGIN in 0.6 seconds
08:38:13.299799 [debug] [MainThread]: Using postgres connection "master"
08:38:13.299799 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:38:13.382713 [debug] [MainThread]: SQL status: SELECT 6 in 0.08 seconds
08:38:13.383713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7065AB280>]}
08:38:13.383713 [debug] [MainThread]: On master: ROLLBACK
08:38:13.457577 [debug] [MainThread]: Using postgres connection "master"
08:38:13.457577 [debug] [MainThread]: On master: BEGIN
08:38:13.602593 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
08:38:13.602593 [debug] [MainThread]: On master: COMMIT
08:38:13.602593 [debug] [MainThread]: Using postgres connection "master"
08:38:13.603605 [debug] [MainThread]: On master: COMMIT
08:38:13.675978 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:38:13.675978 [debug] [MainThread]: On master: Close
08:38:13.675978 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
08:38:13.677305 [info ] [MainThread]: 
08:38:13.681316 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
08:38:13.681316 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
08:38:13.681316 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
08:38:13.681316 [info ] [Thread-1 (]: 1 of 6 START view model staging.stg_satellite_detail_dm ........................ [RUN]
08:38:13.681316 [info ] [Thread-2 (]: 2 of 6 START view model staging.stg_satellite_position_ft ...................... [RUN]
08:38:13.682319 [info ] [Thread-3 (]: 3 of 6 START view model staging.stg_satellite_tle_ft ........................... [RUN]
08:38:13.682319 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:38:13.683317 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:38:13.683317 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
08:38:13.683317 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:38:13.683317 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
08:38:13.683317 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
08:38:13.684316 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
08:38:13.684316 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
08:38:13.685316 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:38:13.686316 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
08:38:13.689319 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:38:13.690317 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:38:13.691319 [debug] [Thread-1 (]: finished collecting timing info
08:38:13.691319 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
08:38:13.691319 [debug] [Thread-2 (]: finished collecting timing info
08:38:13.699316 [debug] [Thread-3 (]: finished collecting timing info
08:38:13.706316 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:38:13.707316 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
08:38:13.707316 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
08:38:13.708318 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:38:13.709316 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:38:13.710316 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:38:13.710316 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
08:38:13.711316 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:38:13.711316 [debug] [Thread-1 (]: Opening a new connection, currently in state init
08:38:13.711316 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:38:13.711316 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
08:38:13.712316 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
08:38:13.712316 [debug] [Thread-2 (]: Opening a new connection, currently in state init
08:38:13.712316 [debug] [Thread-3 (]: Opening a new connection, currently in state init
08:38:14.298286 [debug] [Thread-3 (]: SQL status: BEGIN in 0.59 seconds
08:38:14.298286 [debug] [Thread-2 (]: SQL status: BEGIN in 0.59 seconds
08:38:14.298286 [debug] [Thread-1 (]: SQL status: BEGIN in 0.59 seconds
08:38:14.299085 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:38:14.299085 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:38:14.299085 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:38:14.300092 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
08:38:14.300092 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
08:38:14.300092 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
08:38:14.374639 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.07 seconds
08:38:14.374639 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.07 seconds
08:38:14.379017 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:38:14.379017 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.08 seconds
08:38:14.380017 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:38:14.380017 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
08:38:14.382017 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:38:14.382017 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
08:38:14.383016 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
08:38:14.455067 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:38:14.455067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:38:14.455067 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:38:14.456079 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:38:14.458082 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:38:14.459078 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:38:14.460077 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
08:38:14.460077 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
08:38:14.460077 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
08:38:14.533098 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:38:14.533098 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:38:14.533098 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:38:14.537122 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:38:14.538121 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:38:14.539121 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:38:14.539121 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:38:14.539121 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:38:14.540110 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:38:14.540110 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:38:14.540110 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:38:14.540110 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:38:14.613269 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
08:38:14.613269 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:38:14.613269 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:38:14.616269 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:38:14.618269 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:38:14.619269 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:38:14.619269 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
08:38:14.619269 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
08:38:14.619269 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
08:38:14.689999 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
08:38:14.691000 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:38:14.692002 [debug] [Thread-3 (]: finished collecting timing info
08:38:14.692175 [debug] [Thread-1 (]: finished collecting timing info
08:38:14.692175 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:38:14.693189 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
08:38:14.693189 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
08:38:14.694196 [debug] [Thread-2 (]: finished collecting timing info
08:38:14.694196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706658730>]}
08:38:14.695192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706697A60>]}
08:38:14.695192 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
08:38:14.695192 [info ] [Thread-3 (]: 3 of 6 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.01s]
08:38:14.696187 [info ] [Thread-1 (]: 1 of 6 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.01s]
08:38:14.696378 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706656140>]}
08:38:14.697390 [info ] [Thread-2 (]: 2 of 6 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 1.01s]
08:38:14.697390 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
08:38:14.698390 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
08:38:14.698390 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_details
08:38:14.698390 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
08:38:14.698390 [info ] [Thread-5 (]: 4 of 6 START view model production.satellite_details ........................... [RUN]
08:38:14.699389 [debug] [Thread-3 (]: Began running node model.satellite_tracker.daily_satellite_stats
08:38:14.699389 [debug] [Thread-1 (]: Began running node model.satellite_tracker.satellite_tracking
08:38:14.699389 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_details"
08:38:14.700390 [info ] [Thread-3 (]: 5 of 6 START view model production.daily_satellite_stats ....................... [RUN]
08:38:14.700390 [info ] [Thread-1 (]: 6 of 6 START view model production.satellite_tracking .......................... [RUN]
08:38:14.700390 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_details
08:38:14.701389 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
08:38:14.701389 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_details
08:38:14.701389 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
08:38:14.701389 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
08:38:14.703626 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_details"
08:38:14.703626 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.satellite_tracking
08:38:14.703626 [debug] [Thread-3 (]: Compiling model.satellite_tracker.daily_satellite_stats
08:38:14.704389 [debug] [Thread-1 (]: Compiling model.satellite_tracker.satellite_tracking
08:38:14.704389 [debug] [Thread-5 (]: finished collecting timing info
08:38:14.707245 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
08:38:14.709253 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
08:38:14.710255 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_details
08:38:14.712263 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_details"
08:38:14.712263 [debug] [Thread-3 (]: finished collecting timing info
08:38:14.712263 [debug] [Thread-1 (]: finished collecting timing info
08:38:14.712263 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.daily_satellite_stats
08:38:14.712263 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:38:14.713261 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.satellite_tracking
08:38:14.714260 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.daily_satellite_stats"
08:38:14.714260 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: BEGIN
08:38:14.715260 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
08:38:14.716260 [debug] [Thread-5 (]: Opening a new connection, currently in state init
08:38:14.716260 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:38:14.717260 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: BEGIN
08:38:14.717260 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:38:14.717260 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
08:38:14.717260 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: BEGIN
08:38:14.717260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
08:38:15.307357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.59 seconds
08:38:15.307357 [debug] [Thread-5 (]: SQL status: BEGIN in 0.59 seconds
08:38:15.307357 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:38:15.307357 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:38:15.308357 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS sat_position
    WHERE sat_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        sat_position.timestamp AS position_timestamp,
        sat_position.latitude,
        sat_position.longitude,
        sat_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS sat_position
        ON satellites_to_track.id = sat_position.id
    ORDER BY satellites_to_track.id, sat_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        sat_tle.timestamp,
        sat_tle.timestamp AS tle_timestamp,
        sat_tle.line_1,
        sat_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS sat_tle
        ON satellites_to_track.id = sat_tle.id
    ORDER BY satellites_to_track.id, sat_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
08:38:15.308357 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_details"} */

  create view "portfolio_website"."production"."satellite_details__dbt_tmp" as (
    -- Set configuration settings


WITH satellite_details AS (
    SELECT
        satellite_id,
        name,
        description,
        operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        satellite_bus,
        launch_mass_lbs,
        launch_date,
        AGE(launch_date) AS days_since_launch,
        launch_site,
        reference_system,
        rocket,
        satellite_website,
        wikipedia_link
    FROM "portfolio_website"."staging"."stg_satellite_detail_dm" AS sat_details
)

SELECT
    *
FROM satellite_details
  );
08:38:15.351417 [debug] [Thread-3 (]: SQL status: BEGIN in 0.63 seconds
08:38:15.352417 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:38:15.352417 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */

  create view "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" as (
    -- Set configuration settings


WITH daily_satellite_stats AS (
    SELECT
        DATE_TRUNC('day', timestamp) AS day,
        id AS satellite_id,
        AVG(velocity_mph) AS average_velocity_mph,
        AVG(altitude) AS average_altitude_miles
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    GROUP BY id, DATE_TRUNC('day', timestamp)
)

SELECT
    *
FROM daily_satellite_stats
  );
08:38:15.382448 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.07 seconds
08:38:15.383448 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:38:15.383448 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_details"} */
alter table "portfolio_website"."production"."satellite_details__dbt_tmp" rename to "satellite_details"
08:38:15.384448 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.08 seconds
08:38:15.385451 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:38:15.385451 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
08:38:15.433629 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.08 seconds
08:38:15.434653 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:38:15.434653 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
alter table "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" rename to "daily_satellite_stats"
08:38:15.453786 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
08:38:15.454785 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: COMMIT
08:38:15.454785 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:38:15.454785 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: COMMIT
08:38:15.458785 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:38:15.459785 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:38:15.459785 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:38:15.459785 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:38:15.516069 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.08 seconds
08:38:15.517071 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:38:15.517071 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:38:15.517071 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:38:15.526825 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
08:38:15.527849 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_details"
08:38:15.527849 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_details"} */
drop view if exists "portfolio_website"."production"."satellite_details__dbt_backup" cascade
08:38:15.531868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:38:15.532870 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:38:15.532870 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
08:38:15.596837 [debug] [Thread-3 (]: SQL status: COMMIT in 0.08 seconds
08:38:15.596837 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
08:38:15.597861 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:38:15.598859 [debug] [Thread-5 (]: finished collecting timing info
08:38:15.598859 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
drop view if exists "portfolio_website"."production"."daily_satellite_stats__dbt_backup" cascade
08:38:15.599850 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_details: Close
08:38:15.599850 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706656E00>]}
08:38:15.600848 [info ] [Thread-5 (]: 4 of 6 OK created view model production.satellite_details ...................... [[32mCREATE VIEW[0m in 0.90s]
08:38:15.601172 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_details
08:38:15.605183 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:38:15.606186 [debug] [Thread-1 (]: finished collecting timing info
08:38:15.606186 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: Close
08:38:15.607183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7066ED6F0>]}
08:38:15.607183 [info ] [Thread-1 (]: 6 of 6 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.90s]
08:38:15.607183 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.satellite_tracking
08:38:15.676225 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.08 seconds
08:38:15.678226 [debug] [Thread-3 (]: finished collecting timing info
08:38:15.678226 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: Close
08:38:15.678226 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38a7948-a28b-41f3-9e99-70f247aef72a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706728490>]}
08:38:15.679230 [info ] [Thread-3 (]: 5 of 6 OK created view model production.daily_satellite_stats .................. [[32mCREATE VIEW[0m in 0.98s]
08:38:15.680227 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.daily_satellite_stats
08:38:15.681228 [debug] [MainThread]: Acquiring new postgres connection "master"
08:38:15.681228 [debug] [MainThread]: Using postgres connection "master"
08:38:15.681228 [debug] [MainThread]: On master: BEGIN
08:38:15.681228 [debug] [MainThread]: Opening a new connection, currently in state closed
08:38:16.260476 [debug] [MainThread]: SQL status: BEGIN in 0.58 seconds
08:38:16.261478 [debug] [MainThread]: On master: COMMIT
08:38:16.261478 [debug] [MainThread]: Using postgres connection "master"
08:38:16.261478 [debug] [MainThread]: On master: COMMIT
08:38:16.334221 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:38:16.334221 [debug] [MainThread]: On master: Close
08:38:16.335245 [info ] [MainThread]: 
08:38:16.335245 [info ] [MainThread]: Finished running 6 view models in 5.04s.
08:38:16.336234 [debug] [MainThread]: Connection 'master' was properly closed.
08:38:16.336234 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:38:16.336234 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:38:16.336234 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
08:38:16.337241 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
08:38:16.337241 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
08:38:16.337241 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
08:38:16.337241 [debug] [MainThread]: Connection 'model.satellite_tracker.daily_satellite_stats' was properly closed.
08:38:16.337241 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_details' was properly closed.
08:38:16.341232 [info ] [MainThread]: 
08:38:16.342232 [info ] [MainThread]: [32mCompleted successfully[0m
08:38:16.342232 [info ] [MainThread]: 
08:38:16.342232 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
08:38:16.343232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7065AAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706714A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F706599F90>]}


============================== 2022-07-10 08:39:20.238442 | 3e51106d-cae1-4ecd-a7ac-a7b056db5845 ==============================
08:39:20.238442 [info ] [MainThread]: Running with dbt=1.1.1
08:39:20.238442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:39:20.238442 [debug] [MainThread]: Tracking: tracking
08:39:20.246443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A7A0CD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A796FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A797550>]}
08:39:20.283444 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
08:39:20.283444 [debug] [MainThread]: Partial parsing: added file: satellite_tracker://models\production\satellite_detail.sql
08:39:20.283444 [debug] [MainThread]: Partial parsing: deleted file: satellite_tracker://models\production\satellite_details.sql
08:39:20.290443 [debug] [MainThread]: 1699: static parser successfully parsed production\satellite_detail.sql
08:39:20.303442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A8FD8D0>]}
08:39:20.308442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A8B94B0>]}
08:39:20.308442 [info ] [MainThread]: Found 6 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:39:20.309444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A7A0CD0>]}
08:39:20.310445 [info ] [MainThread]: 
08:39:20.310445 [debug] [MainThread]: Acquiring new postgres connection "master"
08:39:20.311442 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:39:20.311442 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website"
08:39:20.317443 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:39:20.318446 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website"
08:39:20.318446 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:39:20.318446 [debug] [ThreadPool]: On list_portfolio_website: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website"} */

    select distinct nspname from pg_namespace
  
08:39:20.319446 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:39:20.319446 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:39:20.925742 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
08:39:20.926930 [debug] [ThreadPool]: On list_portfolio_website: Close
08:39:20.926930 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.61 seconds
08:39:20.927930 [debug] [ThreadPool]: On list_portfolio_website: Close
08:39:20.928931 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
08:39:20.929931 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
08:39:20.933160 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:39:20.934153 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:39:20.934153 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
08:39:20.935152 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
08:39:20.935152 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:39:20.935152 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:39:21.529567 [debug] [ThreadPool]: SQL status: BEGIN in 0.59 seconds
08:39:21.529567 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:39:21.530567 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
08:39:21.538566 [debug] [ThreadPool]: SQL status: BEGIN in 0.6 seconds
08:39:21.538566 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:39:21.538566 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
08:39:21.601566 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
08:39:21.603566 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
08:39:21.613566 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.07 seconds
08:39:21.614566 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
08:39:21.672697 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
08:39:21.686695 [debug] [ThreadPool]: On list_portfolio_website_production: Close
08:39:21.689696 [debug] [MainThread]: Using postgres connection "master"
08:39:21.689696 [debug] [MainThread]: On master: BEGIN
08:39:21.689696 [debug] [MainThread]: Opening a new connection, currently in state init
08:39:22.297876 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
08:39:22.297876 [debug] [MainThread]: Using postgres connection "master"
08:39:22.297876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:39:22.380102 [debug] [MainThread]: SQL status: SELECT 6 in 0.08 seconds
08:39:22.381104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A8B8F10>]}
08:39:22.381104 [debug] [MainThread]: On master: ROLLBACK
08:39:22.452857 [debug] [MainThread]: Using postgres connection "master"
08:39:22.452857 [debug] [MainThread]: On master: BEGIN
08:39:22.597899 [debug] [MainThread]: SQL status: BEGIN in 0.14 seconds
08:39:22.597899 [debug] [MainThread]: On master: COMMIT
08:39:22.598565 [debug] [MainThread]: Using postgres connection "master"
08:39:22.598565 [debug] [MainThread]: On master: COMMIT
08:39:22.671028 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:39:22.671028 [debug] [MainThread]: On master: Close
08:39:22.671028 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
08:39:22.672028 [info ] [MainThread]: 
08:39:22.676028 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
08:39:22.676028 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
08:39:22.677028 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
08:39:22.677028 [info ] [Thread-1 (]: 1 of 6 START view model staging.stg_satellite_detail_dm ........................ [RUN]
08:39:22.677028 [info ] [Thread-2 (]: 2 of 6 START view model staging.stg_satellite_position_ft ...................... [RUN]
08:39:22.678028 [info ] [Thread-3 (]: 3 of 6 START view model staging.stg_satellite_tle_ft ........................... [RUN]
08:39:22.678028 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:39:22.679030 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:39:22.679030 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:39:22.679030 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
08:39:22.679030 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
08:39:22.680028 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
08:39:22.680028 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
08:39:22.680028 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
08:39:22.680028 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
08:39:22.682028 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:39:22.685028 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:39:22.686027 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:39:22.687028 [debug] [Thread-1 (]: finished collecting timing info
08:39:22.687028 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
08:39:22.687028 [debug] [Thread-2 (]: finished collecting timing info
08:39:22.688030 [debug] [Thread-3 (]: finished collecting timing info
08:39:22.702029 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:39:22.703028 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
08:39:22.703028 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
08:39:22.705028 [debug] [Thread-2 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:39:22.705028 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:39:22.706031 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:39:22.707031 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: BEGIN
08:39:22.707031 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:39:22.707031 [debug] [Thread-1 (]: Opening a new connection, currently in state init
08:39:22.708030 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:39:22.708030 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: BEGIN
08:39:22.708030 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: BEGIN
08:39:22.708030 [debug] [Thread-2 (]: Opening a new connection, currently in state init
08:39:22.709028 [debug] [Thread-3 (]: Opening a new connection, currently in state init
08:39:23.283095 [debug] [Thread-2 (]: SQL status: BEGIN in 0.58 seconds
08:39:23.283095 [debug] [Thread-1 (]: SQL status: BEGIN in 0.58 seconds
08:39:23.283095 [debug] [Thread-3 (]: SQL status: BEGIN in 0.57 seconds
08:39:23.284094 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:39:23.284094 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:39:23.284094 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:39:23.285095 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" as (
    -- Set configuration settings


-- Set needed variables to calculate orbital velocity





-- Stage satellite position data from our raw schema
WITH staged_satellite_position_ft AS (
    SELECT
        LOWER(name) AS name,
        id,
        latitude,
        longitude,
        altitude,
        CASE
            WHEN velocity IS NULL AND units = 'miles'
                THEN 
    SQRT((6.674e-11 * 5972000000000000000000000) / (6371000 + (altitude * 1609))) * 2.237

            WHEN velocity IS NULL AND units != 'miles'
                THEN NULL
            ELSE velocity
        END AS velocity_mph,
        CASE
            WHEN visibility = 'daylight'
                THEN 'visible'
            ELSE visibility
        END AS visibility,
        TO_TIMESTAMP(timestamp) AS timestamp,
        daynum,
        solar_lat,
        solar_lon,
        units,
        source,
        NOT altitude = 0 AS still_in_orbit
    FROM raw.satellite_position_ft
)


SELECT
    *
FROM staged_satellite_position_ft
  );
08:39:23.285095 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */

  create view "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" as (
    -- Set configuration settings


WITH staged_satellite_detail_dm AS (
    SELECT
        satellite_id,
        LOWER(name) AS name,
        description,
        SPLIT_PART(operator, '[', 1) AS operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        SPLIT_PART(satellite_bus,'[', 1) AS satellite_bus,
        launch_mass_lbs,
        launch_date,
        SPLIT_PART(launch_site,'[', 1) AS launch_site,
        SPLIT_PART(reference_system,'[', 1) AS reference_system,
        SPLIT_PART(rocket,'[',1) AS rocket,
        website AS satellite_website,
        wikipedia_link
    FROM raw.satellite_detail_dm
)

SELECT
    *
FROM staged_satellite_detail_dm
  );
08:39:23.285095 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */

  create view "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" as (
    -- Set configuration settings


-- Stage satellite tle data from our raw schema
WITH staged_satellite_tle_ft AS (
    SELECT
        id,
        LOWER(name) AS name,
        TO_TIMESTAMP(requested_timestamp) AS timestamp,
        source,
        line1 AS line_1,
        line2 AS line_2
    FROM raw.satellite_tle_ft
)

SELECT
    *
FROM staged_satellite_tle_ft
  );
08:39:23.359514 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.07 seconds
08:39:23.359514 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.07 seconds
08:39:23.360514 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.07 seconds
08:39:23.364513 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:39:23.366515 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:39:23.367514 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:39:23.367514 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm" rename to "stg_satellite_detail_dm__dbt_backup"
08:39:23.368513 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft" rename to "stg_satellite_position_ft__dbt_backup"
08:39:23.368513 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft" rename to "stg_satellite_tle_ft__dbt_backup"
08:39:23.440592 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:23.440592 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:23.440592 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:23.442593 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:39:23.443592 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:39:23.445593 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:39:23.445593 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_position_ft__dbt_tmp" rename to "stg_satellite_position_ft"
08:39:23.445593 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
alter table "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_tmp" rename to "stg_satellite_tle_ft"
08:39:23.445593 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
alter table "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_tmp" rename to "stg_satellite_detail_dm"
08:39:23.516621 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:23.516621 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:23.516621 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:23.520621 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:39:23.521621 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:39:23.522621 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:39:23.522621 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:39:23.523621 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:39:23.523621 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:39:23.523621 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: COMMIT
08:39:23.523621 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: COMMIT
08:39:23.524621 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: COMMIT
08:39:23.595640 [debug] [Thread-2 (]: SQL status: COMMIT in 0.07 seconds
08:39:23.595640 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:39:23.595640 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
08:39:23.598643 [debug] [Thread-2 (]: Using postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:39:23.600640 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:39:23.601642 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:39:23.601642 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_position_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_position_ft__dbt_backup" cascade
08:39:23.601642 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_detail_dm"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_detail_dm__dbt_backup" cascade
08:39:23.602641 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.stg_satellite_tle_ft"} */
drop view if exists "portfolio_website"."staging"."stg_satellite_tle_ft__dbt_backup" cascade
08:39:23.674736 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
08:39:23.674736 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:39:23.674736 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.07 seconds
08:39:23.675747 [debug] [Thread-3 (]: finished collecting timing info
08:39:23.676747 [debug] [Thread-1 (]: finished collecting timing info
08:39:23.677749 [debug] [Thread-2 (]: finished collecting timing info
08:39:23.677749 [debug] [Thread-3 (]: On model.satellite_tracker.stg_satellite_tle_ft: Close
08:39:23.678748 [debug] [Thread-1 (]: On model.satellite_tracker.stg_satellite_detail_dm: Close
08:39:23.678748 [debug] [Thread-2 (]: On model.satellite_tracker.stg_satellite_position_ft: Close
08:39:23.678748 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A8AB6D0>]}
08:39:23.679748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A9C74F0>]}
08:39:23.679848 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A8BEA10>]}
08:39:23.679848 [info ] [Thread-3 (]: 3 of 6 OK created view model staging.stg_satellite_tle_ft ...................... [[32mCREATE VIEW[0m in 1.00s]
08:39:23.680860 [info ] [Thread-1 (]: 1 of 6 OK created view model staging.stg_satellite_detail_dm ................... [[32mCREATE VIEW[0m in 1.00s]
08:39:23.680860 [info ] [Thread-2 (]: 2 of 6 OK created view model staging.stg_satellite_position_ft ................. [[32mCREATE VIEW[0m in 1.00s]
08:39:23.681859 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
08:39:23.681859 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
08:39:23.682859 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_detail
08:39:23.682859 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
08:39:23.682859 [info ] [Thread-5 (]: 4 of 6 START view model production.satellite_detail ............................ [RUN]
08:39:23.683858 [debug] [Thread-3 (]: Began running node model.satellite_tracker.daily_satellite_stats
08:39:23.683858 [debug] [Thread-1 (]: Began running node model.satellite_tracker.satellite_tracking
08:39:23.683858 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_detail"
08:39:23.684858 [info ] [Thread-3 (]: 5 of 6 START view model production.daily_satellite_stats ....................... [RUN]
08:39:23.684858 [info ] [Thread-1 (]: 6 of 6 START view model production.satellite_tracking .......................... [RUN]
08:39:23.684858 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_detail
08:39:23.685858 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
08:39:23.685858 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
08:39:23.685858 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_detail
08:39:23.685858 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
08:39:23.686859 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.satellite_tracking
08:39:23.688861 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_detail"
08:39:23.688861 [debug] [Thread-3 (]: Compiling model.satellite_tracker.daily_satellite_stats
08:39:23.688861 [debug] [Thread-1 (]: Compiling model.satellite_tracker.satellite_tracking
08:39:23.690859 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
08:39:23.693859 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
08:39:23.693859 [debug] [Thread-5 (]: finished collecting timing info
08:39:23.694858 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_detail
08:39:23.694858 [debug] [Thread-3 (]: finished collecting timing info
08:39:23.696858 [debug] [Thread-5 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_detail"
08:39:23.696858 [debug] [Thread-1 (]: finished collecting timing info
08:39:23.696858 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.daily_satellite_stats
08:39:23.696858 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.satellite_tracking
08:39:23.698859 [debug] [Thread-3 (]: Writing runtime SQL for node "model.satellite_tracker.daily_satellite_stats"
08:39:23.698859 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_detail"
08:39:23.699859 [debug] [Thread-1 (]: Writing runtime SQL for node "model.satellite_tracker.satellite_tracking"
08:39:23.700858 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_detail: BEGIN
08:39:23.700858 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:39:23.700858 [debug] [Thread-5 (]: Opening a new connection, currently in state init
08:39:23.700858 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:39:23.701859 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: BEGIN
08:39:23.701859 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: BEGIN
08:39:23.701859 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
08:39:23.701859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
08:39:24.274033 [debug] [Thread-5 (]: SQL status: BEGIN in 0.57 seconds
08:39:24.274033 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_detail"
08:39:24.274033 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_detail: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_detail"} */

  create view "portfolio_website"."production"."satellite_detail__dbt_tmp" as (
    -- Set configuration settings


WITH satellite_details AS (
    SELECT
        satellite_id,
        name,
        description,
        operator,
        cospar_id,
        manufacturer,
        mission_duration,
        mission_type,
        spacecraft_type,
        satellite_bus,
        launch_mass_lbs,
        launch_date,
        AGE(launch_date) AS days_since_launch,
        launch_site,
        reference_system,
        rocket,
        satellite_website,
        wikipedia_link
    FROM "portfolio_website"."staging"."stg_satellite_detail_dm" AS sat_details
)

SELECT
    *
FROM satellite_details
  );
08:39:24.276044 [debug] [Thread-3 (]: SQL status: BEGIN in 0.57 seconds
08:39:24.277044 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:39:24.277044 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */

  create view "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" as (
    -- Set configuration settings


WITH daily_satellite_stats AS (
    SELECT
        DATE_TRUNC('day', timestamp) AS day,
        id AS satellite_id,
        AVG(velocity_mph) AS average_velocity_mph,
        AVG(altitude) AS average_altitude_miles
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS satellite_position
    GROUP BY id, DATE_TRUNC('day', timestamp)
)

SELECT
    *
FROM daily_satellite_stats
  );
08:39:24.292684 [debug] [Thread-1 (]: SQL status: BEGIN in 0.59 seconds
08:39:24.292684 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:39:24.292684 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */

  create view "portfolio_website"."production"."satellite_tracking__dbt_tmp" as (
    -- Set configuration settings


WITH satellites_to_track AS (
    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_position_ft" AS sat_position
    WHERE sat_position.still_in_orbit

    UNION

    SELECT
        DISTINCT id
    FROM "portfolio_website"."staging"."stg_satellite_tle_ft" AS satellite_tle
),

-- Get most recent record for satellite position
newest_satellite_position AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        sat_position.timestamp AS position_timestamp,
        sat_position.latitude,
        sat_position.longitude,
        sat_position.altitude
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_position_ft" AS sat_position
        ON satellites_to_track.id = sat_position.id
    ORDER BY satellites_to_track.id, sat_position.timestamp DESC
),

-- Get most recent record for satellite tle
newest_satellite_tle AS (
    SELECT
        DISTINCT ON (satellites_to_track.id)
        satellites_to_track.id,
        sat_tle.timestamp,
        sat_tle.timestamp AS tle_timestamp,
        sat_tle.line_1,
        sat_tle.line_2
    FROM satellites_to_track
    LEFT JOIN "portfolio_website"."staging"."stg_satellite_tle_ft" AS sat_tle
        ON satellites_to_track.id = sat_tle.id
    ORDER BY satellites_to_track.id, sat_tle.timestamp DESC
),

-- Build final query set
final AS (
    SELECT
        satellites_to_track.id,
        newest_satellite_position.position_timestamp,
        newest_satellite_position.latitude,
        newest_satellite_position.longitude,
        newest_satellite_position.altitude,
        newest_satellite_tle.tle_timestamp,
        newest_satellite_tle.line_1,
        newest_satellite_tle.line_2
    FROM satellites_to_track
    LEFT JOIN newest_satellite_position
        ON satellites_to_track.id = newest_satellite_position.id
    LEFT JOIN newest_satellite_tle
        ON satellites_to_track.id = newest_satellite_tle.id
)

SELECT
    *
FROM final
  );
08:39:24.345549 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.07 seconds
08:39:24.347537 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_detail"
08:39:24.347537 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_detail: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_detail"} */
alter table "portfolio_website"."production"."satellite_detail__dbt_tmp" rename to "satellite_detail"
08:39:24.347537 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.07 seconds
08:39:24.349537 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:39:24.349537 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
alter table "portfolio_website"."production"."daily_satellite_stats__dbt_tmp" rename to "daily_satellite_stats"
08:39:24.366550 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.07 seconds
08:39:24.368550 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:39:24.368550 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
alter table "portfolio_website"."production"."satellite_tracking__dbt_tmp" rename to "satellite_tracking"
08:39:24.417552 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:24.418576 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_detail: COMMIT
08:39:24.418576 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:24.418576 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_detail"
08:39:24.419576 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:39:24.419576 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_detail: COMMIT
08:39:24.419576 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:39:24.420575 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: COMMIT
08:39:24.441890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.07 seconds
08:39:24.442902 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:39:24.442902 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:39:24.442902 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: COMMIT
08:39:24.489067 [debug] [Thread-5 (]: SQL status: COMMIT in 0.07 seconds
08:39:24.490071 [debug] [Thread-5 (]: Using postgres connection "model.satellite_tracker.satellite_detail"
08:39:24.490071 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_detail: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_detail"} */
drop view if exists "portfolio_website"."production"."satellite_detail__dbt_backup" cascade
08:39:24.490071 [debug] [Thread-3 (]: SQL status: COMMIT in 0.07 seconds
08:39:24.492071 [debug] [Thread-3 (]: Using postgres connection "model.satellite_tracker.daily_satellite_stats"
08:39:24.492071 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.daily_satellite_stats"} */
drop view if exists "portfolio_website"."production"."daily_satellite_stats__dbt_backup" cascade
08:39:24.516263 [debug] [Thread-1 (]: SQL status: COMMIT in 0.07 seconds
08:39:24.517275 [debug] [Thread-1 (]: Using postgres connection "model.satellite_tracker.satellite_tracking"
08:39:24.517275 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "node_id": "model.satellite_tracker.satellite_tracking"} */
drop view if exists "portfolio_website"."production"."satellite_tracking__dbt_backup" cascade
08:39:24.560201 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.07 seconds
08:39:24.561212 [debug] [Thread-5 (]: finished collecting timing info
08:39:24.561212 [debug] [Thread-5 (]: On model.satellite_tracker.satellite_detail: Close
08:39:24.561212 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.07 seconds
08:39:24.561212 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A8B9F30>]}
08:39:24.562211 [debug] [Thread-3 (]: finished collecting timing info
08:39:24.563211 [info ] [Thread-5 (]: 4 of 6 OK created view model production.satellite_detail ....................... [[32mCREATE VIEW[0m in 0.88s]
08:39:24.563211 [debug] [Thread-3 (]: On model.satellite_tracker.daily_satellite_stats: Close
08:39:24.564211 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0AA3C5E0>]}
08:39:24.564211 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_detail
08:39:24.564211 [info ] [Thread-3 (]: 5 of 6 OK created view model production.daily_satellite_stats .................. [[32mCREATE VIEW[0m in 0.88s]
08:39:24.565211 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.daily_satellite_stats
08:39:24.589213 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.07 seconds
08:39:24.590212 [debug] [Thread-1 (]: finished collecting timing info
08:39:24.590212 [debug] [Thread-1 (]: On model.satellite_tracker.satellite_tracking: Close
08:39:24.591211 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e51106d-cae1-4ecd-a7ac-a7b056db5845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0A9FD690>]}
08:39:24.591211 [info ] [Thread-1 (]: 6 of 6 OK created view model production.satellite_tracking ..................... [[32mCREATE VIEW[0m in 0.91s]
08:39:24.592215 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.satellite_tracking
08:39:24.593213 [debug] [MainThread]: Acquiring new postgres connection "master"
08:39:24.593213 [debug] [MainThread]: Using postgres connection "master"
08:39:24.593213 [debug] [MainThread]: On master: BEGIN
08:39:24.593213 [debug] [MainThread]: Opening a new connection, currently in state closed
08:39:25.207356 [debug] [MainThread]: SQL status: BEGIN in 0.61 seconds
08:39:25.207356 [debug] [MainThread]: On master: COMMIT
08:39:25.207356 [debug] [MainThread]: Using postgres connection "master"
08:39:25.207356 [debug] [MainThread]: On master: COMMIT
08:39:25.279723 [debug] [MainThread]: SQL status: COMMIT in 0.07 seconds
08:39:25.279723 [debug] [MainThread]: On master: Close
08:39:25.279723 [info ] [MainThread]: 
08:39:25.280724 [info ] [MainThread]: Finished running 6 view models in 4.97s.
08:39:25.281724 [debug] [MainThread]: Connection 'master' was properly closed.
08:39:25.281724 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:39:25.281724 [debug] [MainThread]: Connection 'list_portfolio_website' was properly closed.
08:39:25.281724 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
08:39:25.281724 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
08:39:25.282724 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_tracking' was properly closed.
08:39:25.282724 [debug] [MainThread]: Connection 'model.satellite_tracker.stg_satellite_position_ft' was properly closed.
08:39:25.282724 [debug] [MainThread]: Connection 'model.satellite_tracker.daily_satellite_stats' was properly closed.
08:39:25.282724 [debug] [MainThread]: Connection 'model.satellite_tracker.satellite_detail' was properly closed.
08:39:25.286723 [info ] [MainThread]: 
08:39:25.286723 [info ] [MainThread]: [32mCompleted successfully[0m
08:39:25.287725 [info ] [MainThread]: 
08:39:25.287725 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
08:39:25.288724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0AA2AF20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0AA2AC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E0AA1D9F0>]}


============================== 2022-07-10 08:40:36.254849 | 35d41dcf-8a55-4a93-be0e-19315e14d88a ==============================
08:40:36.254849 [info ] [MainThread]: Running with dbt=1.1.1
08:40:36.255849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
08:40:36.255849 [debug] [MainThread]: Tracking: tracking
08:40:36.263851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158F80FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158F76FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158F771F0>]}
08:40:36.302849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:40:36.303849 [debug] [MainThread]: Partial parsing: updated file: satellite_tracker://models\production\daily_satellite_stats.sql
08:40:36.309849 [debug] [MainThread]: 1699: static parser successfully parsed production\daily_satellite_stats.sql
08:40:36.323849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35d41dcf-8a55-4a93-be0e-19315e14d88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A1590DD870>]}
08:40:36.328849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35d41dcf-8a55-4a93-be0e-19315e14d88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15909F190>]}
08:40:36.329849 [info ] [MainThread]: Found 6 models, 14 tests, 0 snapshots, 0 analyses, 169 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
08:40:36.329849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d41dcf-8a55-4a93-be0e-19315e14d88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15909C3A0>]}
08:40:36.330852 [info ] [MainThread]: 
08:40:36.331853 [debug] [MainThread]: Acquiring new postgres connection "master"
08:40:36.332851 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_production"
08:40:36.332851 [debug] [ThreadPool]: Acquiring new postgres connection "list_portfolio_website_staging"
08:40:36.338849 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:40:36.339850 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:40:36.339850 [debug] [ThreadPool]: On list_portfolio_website_production: BEGIN
08:40:36.339850 [debug] [ThreadPool]: On list_portfolio_website_staging: BEGIN
08:40:36.339850 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:40:36.340850 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:40:36.942767 [debug] [ThreadPool]: SQL status: BEGIN in 0.6 seconds
08:40:36.942767 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_production"
08:40:36.942767 [debug] [ThreadPool]: On list_portfolio_website_production: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_production"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'production'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'production'
  
08:40:36.957767 [debug] [ThreadPool]: SQL status: BEGIN in 0.62 seconds
08:40:36.957767 [debug] [ThreadPool]: Using postgres connection "list_portfolio_website_staging"
08:40:36.957767 [debug] [ThreadPool]: On list_portfolio_website_staging: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "list_portfolio_website_staging"} */
select
      'portfolio_website' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'staging'
    union all
    select
      'portfolio_website' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'staging'
  
08:40:37.019390 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.08 seconds
08:40:37.019390 [debug] [ThreadPool]: On list_portfolio_website_production: ROLLBACK
08:40:37.031486 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.07 seconds
08:40:37.032486 [debug] [ThreadPool]: On list_portfolio_website_staging: ROLLBACK
08:40:37.089566 [debug] [ThreadPool]: On list_portfolio_website_production: Close
08:40:37.103576 [debug] [ThreadPool]: On list_portfolio_website_staging: Close
08:40:37.106577 [debug] [MainThread]: Using postgres connection "master"
08:40:37.106577 [debug] [MainThread]: On master: BEGIN
08:40:37.106577 [debug] [MainThread]: Opening a new connection, currently in state init
08:40:37.693679 [debug] [MainThread]: SQL status: BEGIN in 0.59 seconds
08:40:37.693679 [debug] [MainThread]: Using postgres connection "master"
08:40:37.693679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
08:40:37.776453 [debug] [MainThread]: SQL status: SELECT 7 in 0.08 seconds
08:40:37.777458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35d41dcf-8a55-4a93-be0e-19315e14d88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A15909F340>]}
08:40:37.778457 [debug] [MainThread]: On master: ROLLBACK
08:40:37.854705 [debug] [MainThread]: On master: Close
08:40:37.854705 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
08:40:37.855707 [info ] [MainThread]: 
08:40:37.859705 [debug] [Thread-1 (]: Began running node model.satellite_tracker.stg_satellite_detail_dm
08:40:37.859705 [debug] [Thread-2 (]: Began running node model.satellite_tracker.stg_satellite_position_ft
08:40:37.859705 [debug] [Thread-3 (]: Began running node model.satellite_tracker.stg_satellite_tle_ft
08:40:37.860705 [debug] [Thread-1 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_detail_dm"
08:40:37.860705 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_position_ft"
08:40:37.860705 [debug] [Thread-3 (]: Acquiring new postgres connection "model.satellite_tracker.stg_satellite_tle_ft"
08:40:37.861707 [debug] [Thread-1 (]: Began compiling node model.satellite_tracker.stg_satellite_detail_dm
08:40:37.861707 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.stg_satellite_position_ft
08:40:37.861707 [debug] [Thread-3 (]: Began compiling node model.satellite_tracker.stg_satellite_tle_ft
08:40:37.861707 [debug] [Thread-1 (]: Compiling model.satellite_tracker.stg_satellite_detail_dm
08:40:37.861707 [debug] [Thread-2 (]: Compiling model.satellite_tracker.stg_satellite_position_ft
08:40:37.862708 [debug] [Thread-3 (]: Compiling model.satellite_tracker.stg_satellite_tle_ft
08:40:37.864705 [debug] [Thread-1 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_detail_dm"
08:40:37.867705 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_position_ft"
08:40:37.868705 [debug] [Thread-3 (]: Writing injected SQL for node "model.satellite_tracker.stg_satellite_tle_ft"
08:40:37.869706 [debug] [Thread-1 (]: finished collecting timing info
08:40:37.869706 [debug] [Thread-1 (]: Began executing node model.satellite_tracker.stg_satellite_detail_dm
08:40:37.869706 [debug] [Thread-2 (]: finished collecting timing info
08:40:37.869706 [debug] [Thread-1 (]: finished collecting timing info
08:40:37.870706 [debug] [Thread-3 (]: finished collecting timing info
08:40:37.870706 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.stg_satellite_position_ft
08:40:37.870706 [debug] [Thread-1 (]: Finished running node model.satellite_tracker.stg_satellite_detail_dm
08:40:37.871706 [debug] [Thread-3 (]: Began executing node model.satellite_tracker.stg_satellite_tle_ft
08:40:37.871706 [debug] [Thread-2 (]: finished collecting timing info
08:40:37.871706 [debug] [Thread-5 (]: Began running node model.satellite_tracker.satellite_detail
08:40:37.871706 [debug] [Thread-3 (]: finished collecting timing info
08:40:37.871706 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
08:40:37.872705 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
08:40:37.872705 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.stg_satellite_position_ft
08:40:37.872705 [debug] [Thread-5 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_detail"
08:40:37.873706 [debug] [Thread-3 (]: Finished running node model.satellite_tracker.stg_satellite_tle_ft
08:40:37.873706 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
08:40:37.873706 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
08:40:37.874706 [debug] [Thread-2 (]: Began running node model.satellite_tracker.daily_satellite_stats
08:40:37.874706 [debug] [Thread-5 (]: Began compiling node model.satellite_tracker.satellite_detail
08:40:37.874706 [debug] [Thread-3 (]: Began running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
08:40:37.874706 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
08:40:37.874706 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
08:40:37.875706 [debug] [Thread-2 (]: Acquiring new postgres connection "model.satellite_tracker.daily_satellite_stats"
08:40:37.875706 [debug] [Thread-5 (]: Compiling model.satellite_tracker.satellite_detail
08:40:37.875706 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
08:40:37.875706 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
08:40:37.876705 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
08:40:37.876705 [debug] [Thread-2 (]: Began compiling node model.satellite_tracker.daily_satellite_stats
08:40:37.878706 [debug] [Thread-5 (]: Writing injected SQL for node "model.satellite_tracker.satellite_detail"
08:40:37.878706 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
08:40:37.886706 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f"
08:40:37.889705 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70"
08:40:37.889705 [debug] [Thread-2 (]: Compiling model.satellite_tracker.daily_satellite_stats
08:40:37.890707 [debug] [Thread-3 (]: Compiling test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
08:40:37.890707 [debug] [Thread-5 (]: finished collecting timing info
08:40:37.892706 [debug] [Thread-2 (]: Writing injected SQL for node "model.satellite_tracker.daily_satellite_stats"
08:40:37.892706 [debug] [Thread-4 (]: finished collecting timing info
08:40:37.898706 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8"
08:40:37.898706 [debug] [Thread-1 (]: finished collecting timing info
08:40:37.898706 [debug] [Thread-5 (]: Began executing node model.satellite_tracker.satellite_detail
08:40:37.898706 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
08:40:37.899706 [debug] [Thread-2 (]: finished collecting timing info
08:40:37.899706 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
08:40:37.899706 [debug] [Thread-5 (]: finished collecting timing info
08:40:37.899706 [debug] [Thread-3 (]: finished collecting timing info
08:40:37.899706 [debug] [Thread-4 (]: finished collecting timing info
08:40:37.900706 [debug] [Thread-2 (]: Began executing node model.satellite_tracker.daily_satellite_stats
08:40:37.900706 [debug] [Thread-1 (]: finished collecting timing info
08:40:37.900706 [debug] [Thread-5 (]: Finished running node model.satellite_tracker.satellite_detail
08:40:37.901705 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
08:40:37.901705 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_name.727b84947f
08:40:37.901705 [debug] [Thread-2 (]: finished collecting timing info
08:40:37.902707 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_detail_dm_satellite_id.d6226baa70
08:40:37.902707 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
08:40:37.902707 [debug] [Thread-3 (]: finished collecting timing info
08:40:37.902707 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
08:40:37.903705 [debug] [Thread-2 (]: Finished running node model.satellite_tracker.daily_satellite_stats
08:40:37.903705 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
08:40:37.903705 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
08:40:37.904706 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.accepted_values_stg_satellite_position_ft_visibility__visible__eclipsed.ff2b9fbef8
08:40:37.904706 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
08:40:37.904706 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
08:40:37.905705 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
08:40:37.905705 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
08:40:37.905705 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
08:40:37.905705 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
08:40:37.906706 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
08:40:37.906706 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
08:40:37.906706 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
08:40:37.907708 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
08:40:37.907708 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
08:40:37.907708 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
08:40:37.907708 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
08:40:37.910706 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc"
08:40:37.910706 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
08:40:37.912708 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e"
08:40:37.912708 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
08:40:37.914709 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2"
08:40:37.915709 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
08:40:37.915709 [debug] [Thread-5 (]: finished collecting timing info
08:40:37.917708 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d"
08:40:37.917708 [debug] [Thread-4 (]: finished collecting timing info
08:40:37.919709 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c"
08:40:37.920708 [debug] [Thread-1 (]: finished collecting timing info
08:40:37.920708 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
08:40:37.920708 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
08:40:37.921706 [debug] [Thread-2 (]: finished collecting timing info
08:40:37.921706 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
08:40:37.921706 [debug] [Thread-3 (]: finished collecting timing info
08:40:37.921706 [debug] [Thread-5 (]: finished collecting timing info
08:40:37.921706 [debug] [Thread-4 (]: finished collecting timing info
08:40:37.922706 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
08:40:37.922706 [debug] [Thread-1 (]: finished collecting timing info
08:40:37.922706 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
08:40:37.923706 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_altitude.5c3af35ecc
08:40:37.923706 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_id.f24d0f6f5e
08:40:37.923706 [debug] [Thread-2 (]: finished collecting timing info
08:40:37.924705 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_latitude.058374d2e2
08:40:37.924705 [debug] [Thread-3 (]: finished collecting timing info
08:40:37.924705 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
08:40:37.924705 [debug] [Thread-4 (]: Began running node model.satellite_tracker.satellite_tracking
08:40:37.925704 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_longitude.916fe3718d
08:40:37.925704 [debug] [Thread-1 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
08:40:37.925704 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_name.0adc5fd78c
08:40:37.926704 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
08:40:37.926704 [debug] [Thread-4 (]: Acquiring new postgres connection "model.satellite_tracker.satellite_tracking"
08:40:37.926704 [debug] [Thread-2 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
08:40:37.927704 [debug] [Thread-1 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
08:40:37.927704 [debug] [Thread-3 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
08:40:37.927704 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
08:40:37.927704 [debug] [Thread-4 (]: Began compiling node model.satellite_tracker.satellite_tracking
08:40:37.928708 [debug] [Thread-2 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
08:40:37.928708 [debug] [Thread-1 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
08:40:37.928708 [debug] [Thread-3 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
08:40:37.928708 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
08:40:37.929707 [debug] [Thread-4 (]: Compiling model.satellite_tracker.satellite_tracking
08:40:37.929707 [debug] [Thread-2 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
08:40:37.929707 [debug] [Thread-1 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
08:40:37.929707 [debug] [Thread-3 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
08:40:37.931706 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797"
08:40:37.934708 [debug] [Thread-4 (]: Writing injected SQL for node "model.satellite_tracker.satellite_tracking"
08:40:37.934708 [debug] [Thread-2 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
08:40:37.936707 [debug] [Thread-1 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034"
08:40:37.936707 [debug] [Thread-3 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
08:40:37.937707 [debug] [Thread-5 (]: finished collecting timing info
08:40:37.939707 [debug] [Thread-2 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3"
08:40:37.939707 [debug] [Thread-4 (]: finished collecting timing info
08:40:37.943708 [debug] [Thread-3 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11"
08:40:37.943708 [debug] [Thread-1 (]: finished collecting timing info
08:40:37.943708 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
08:40:37.944706 [debug] [Thread-4 (]: Began executing node model.satellite_tracker.satellite_tracking
08:40:37.944706 [debug] [Thread-2 (]: finished collecting timing info
08:40:37.944706 [debug] [Thread-1 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
08:40:37.945705 [debug] [Thread-3 (]: finished collecting timing info
08:40:37.945705 [debug] [Thread-5 (]: finished collecting timing info
08:40:37.945705 [debug] [Thread-4 (]: finished collecting timing info
08:40:37.945705 [debug] [Thread-2 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
08:40:37.945705 [debug] [Thread-1 (]: finished collecting timing info
08:40:37.946706 [debug] [Thread-3 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
08:40:37.946706 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_position_ft_timestamp.7cd6e2e797
08:40:37.947708 [debug] [Thread-4 (]: Finished running node model.satellite_tracker.satellite_tracking
08:40:37.947708 [debug] [Thread-2 (]: finished collecting timing info
08:40:37.947708 [debug] [Thread-1 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034
08:40:37.947708 [debug] [Thread-3 (]: finished collecting timing info
08:40:37.948705 [debug] [Thread-5 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
08:40:37.948705 [debug] [Thread-4 (]: Began running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
08:40:37.948705 [debug] [Thread-2 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3
08:40:37.949706 [debug] [Thread-3 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11
08:40:37.949706 [debug] [Thread-5 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
08:40:37.950706 [debug] [Thread-4 (]: Acquiring new postgres connection "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
08:40:37.950706 [debug] [Thread-5 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
08:40:37.950706 [debug] [Thread-4 (]: Began compiling node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
08:40:37.951708 [debug] [Thread-5 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
08:40:37.951708 [debug] [Thread-4 (]: Compiling test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
08:40:37.953706 [debug] [Thread-5 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f"
08:40:37.955708 [debug] [Thread-4 (]: Writing injected SQL for node "test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9"
08:40:37.956707 [debug] [Thread-5 (]: finished collecting timing info
08:40:37.956707 [debug] [Thread-4 (]: finished collecting timing info
08:40:37.956707 [debug] [Thread-5 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
08:40:37.956707 [debug] [Thread-4 (]: Began executing node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
08:40:37.957705 [debug] [Thread-5 (]: finished collecting timing info
08:40:37.957705 [debug] [Thread-4 (]: finished collecting timing info
08:40:37.957705 [debug] [Thread-5 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f
08:40:37.958708 [debug] [Thread-4 (]: Finished running node test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9
08:40:37.959706 [debug] [MainThread]: Connection 'master' was properly closed.
08:40:37.959706 [debug] [MainThread]: Connection 'list_portfolio_website_production' was properly closed.
08:40:37.959706 [debug] [MainThread]: Connection 'list_portfolio_website_staging' was properly closed.
08:40:37.959706 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_id.9cac251034' was properly closed.
08:40:37.959706 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_1.b10a1382d3' was properly closed.
08:40:37.960851 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_line_2.68575c5f11' was properly closed.
08:40:37.960851 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_name.a79d9bc94f' was properly closed.
08:40:37.960851 [debug] [MainThread]: Connection 'test.satellite_tracker.not_null_stg_satellite_tle_ft_timestamp.51ae9abcd9' was properly closed.
08:40:37.964862 [info ] [MainThread]: Done.
08:40:37.966862 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
08:40:37.966862 [info ] [MainThread]: Building catalog
08:40:37.967862 [debug] [ThreadPool]: Acquiring new postgres connection "portfolio_website.information_schema"
08:40:37.971862 [debug] [ThreadPool]: Using postgres connection "portfolio_website.information_schema"
08:40:37.971862 [debug] [ThreadPool]: On portfolio_website.information_schema: BEGIN
08:40:37.972866 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:40:38.622388 [debug] [ThreadPool]: SQL status: BEGIN in 0.65 seconds
08:40:38.622388 [debug] [ThreadPool]: Using postgres connection "portfolio_website.information_schema"
08:40:38.623389 [debug] [ThreadPool]: On portfolio_website.information_schema: /* {"app": "dbt", "dbt_version": "1.1.1", "profile_name": "satellite_tracker", "target_name": "dev", "connection_name": "portfolio_website.information_schema"} */

    
    

    select
        'portfolio_website' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('staging') or upper(sch.nspname) = upper('production'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
08:40:38.706909 [debug] [ThreadPool]: SQL status: SELECT 67 in 0.08 seconds
08:40:38.712910 [debug] [ThreadPool]: On portfolio_website.information_schema: ROLLBACK
08:40:38.792133 [debug] [ThreadPool]: On portfolio_website.information_schema: Close
08:40:38.798145 [info ] [MainThread]: Catalog written to C:\Users\Matt\source\satellite_tracker\satellite_tracker\dbt\target\catalog.json
08:40:38.799144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158F80FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158FC00D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A158FC28F0>]}
08:40:39.134000 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
08:40:39.134000 [debug] [MainThread]: Connection 'portfolio_website.information_schema' was properly closed.


============================== 2022-07-10 08:40:44.172715 | 35bb2174-64d4-4c12-981a-893406c71f0c ==============================
08:40:44.172715 [info ] [MainThread]: Running with dbt=1.1.1
08:40:44.172715 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': 'C:\\Users\\Matt\\.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
08:40:44.173718 [debug] [MainThread]: Tracking: tracking
08:40:44.180716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D9C9A75E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D9C9A6FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029D9C9A71F0>]}
08:40:44.182716 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
08:40:44.182716 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
08:40:44.183716 [info ] [MainThread]: 
08:40:44.183716 [info ] [MainThread]: 
08:40:44.184715 [info ] [MainThread]: Press Ctrl+C to exit.
